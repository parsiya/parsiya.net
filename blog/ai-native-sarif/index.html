<!doctype html><html xmlns=http://www.w3.org/1999/xhtml xml:lang=en lang=en-us><head><meta charset=utf-8><meta name=viewport content="width=device-width,minimum-scale=1,maximum-scale=1"><link href=/css/fonts.css rel=stylesheet type=text/css><title>AI-Native SARIF</title><link rel=stylesheet href=/css/hugo-octopress.css><link rel=stylesheet href=/css/fork-awesome.min.css><link href=https://parsiya.net/favicon.png rel=icon><meta name=description content><meta name=keywords content="[Parsia Hakimian Parsiya infosec information security]"><meta name=author content="Parsia"><meta name=generator content="Hugo 0.152.2"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image:src content="https://parsiya.net/blog/ai-native-sarif/04.png"><meta name=twitter:title content="AI-Native SARIF"><meta name=twitter:description content='The "radical" idea to add prompts and code context directly into SARIF files for
AI triage.'><meta name=twitter:domain content="parsiya.net"><meta name=twitter:creator content="@CryptoGangsta"></head><body><header role=banner><hgroup><h1><a href=https://parsiya.net/>Hackerman's Hacking Tutorials</a></h1><h2>The knowledge of anything, since all things have causes, is not acquired or
complete unless it is known by its causes. - Avicenna</h2></hgroup></header><nav role=navigation><fieldset class=mobile-nav><select onchange="location=this.value"><option value>Navigate‚Ä¶</option><option value=https://parsiya.net/about/>¬ª About Me!</option><option value=https://parsiya.net/cheatsheet/>¬ª Cheat Sheet</option><option value=https://parsiya.io/>¬ª My Clone</option><option value=https://github.com/parsiya/parsiya.net>¬ª Source Repo</option><option value="https://queue.acm.org/detail.cfm?id=3197520">¬ª Manual Work is a Bug</option><option value="https://www.google.com/search?q=andrew+ridgeley">¬ª The Other Guy from Wham!</option></select></fieldset><ul class=main-navigation><li><a href=https://parsiya.net/about/ title="About Me!" target=_blank rel="noopener noreferrer">About Me!</a></li><li><a href=https://parsiya.net/cheatsheet/ title="Cheat Sheet" target=_blank rel="noopener noreferrer">Cheat Sheet</a></li><li><a href=https://parsiya.io/ title="My Clone" target=_blank rel="noopener noreferrer">My Clone</a></li><li><a href=https://github.com/parsiya/parsiya.net title="Source Repo" target=_blank rel="noopener noreferrer">Source Repo</a></li><li><a href="https://queue.acm.org/detail.cfm?id=3197520" title="Manual Work is a Bug" target=_blank rel="noopener noreferrer">Manual Work is a Bug</a></li><li><a href="https://www.google.com/search?q=andrew+ridgeley" title="The Other Guy from Wham!" target=_blank rel="noopener noreferrer">The Other Guy from Wham!</a></li></ul><ul class=subscription><a href=https://parsiya.net/index.xml target=_blank type=application/rss+xml title=RSS rel="noopener noreferrer"><i class="fa fa-rss-square fa-lg"></i></a></ul><form action=https://www.google.com/search method=get target=_blank rel="noopener noreferrer"><fieldset role=search><input class=search type=text name=q results=0 placeholder=Search>
<input type=hidden name=q value=site:https://parsiya.net/></fieldset></form></nav><div id=main><div id=content><div><article class=hentry role=article><header><p class=meta>Dec 11, 2025
- 9 minute read - <a class=label href=https://parsiya.net/categories/ai/>AI </a><a class=label href=https://parsiya.net/categories/static-analysis/>Static Analysis</a></p><h1 class=entry-title>AI-Native SARIF</h1></header><div class=entry-content><nav id=TableOfContents><ul><li><a href=#abstract>Abstract</a><ul><li><a href=#what-is-sarif>What is SARIF?</a></li></ul></li><li><a href=#what-should-i-add-to-the-sarif-file>What Should I Add to the SARIF File?</a><ul><li><a href=#rule-context>Rule Context</a></li><li><a href=#code-context>Code Context</a></li><li><a href=#the-feedback-loop>The Feedback Loop</a></li></ul></li><li><a href=#where-does-the-soda-data-go>Where Does the <del>Soda</del> Data Go?</a><ul><li><a href=#rule-context-1>Rule Context</a></li><li><a href=#code-context-1>Code Context</a></li></ul></li><li><a href=#when-do-i-modify-the-sarif-file>When Do I Modify the SARIF File?</a></li><li><a href=#what-does-the-data-come-from>What Does the Data Come From?</a></li><li><a href=#what-did-we-learn-here-today>What Did We Learn Here Today?</a></li></ul></nav><p>The "radical" idea to add prompts and code context directly into SARIF files for
AI triage.</p><p>Write the clickbait title and then immediately give away the whole thing in the
preview. Pick a struggle, gurrl!</p><p>Special thanks to <a href=https://www.linkedin.com/in/krishnachaitanyatelikicherla/ target=_blank rel="noreferrer noopener">Krishna</a> from Microsoft and <a href=https://www.linkedin.com/in/theoriginalenglishbreakfast/ target=_blank rel="noreferrer noopener">Lewis</a>
from Semgrep for reviewing the post and giving me feedback.</p><h1 id=abstract>Abstract
<a class=header-link href=#abstract><svg class="fill-current o-60 hover-accent-color-light" height="22" viewBox="0 0 24 24" width="22"><path d="M0 0h24v24H0z" fill="none"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h1><p>In
<a href=/blog/wtf-is-ai-native-sast/ title="WTF is ... - AI-Native SAST" rel=nofollow target=_blank>WTF is ... - AI-Native SAST</a>
I proposed four phases of AI-Native SAST in increasing complexity:</p><ol><li>Prompt + Code</li><li>Prompt + Agent</li><li>Tailored Prompt + SAST Result</li><li>Agent + Code Graph + SAST MCP</li></ol><p>The last two methods work on the results of SAST tooling. AI needs code, static
analysis results, tailored prompt, and context to be effective. Keeping track of
these and mashing them all together is an added layer of unnecessary headache.
In this blog I will explore how a SARIF file can act as the single source of
truth for AI triage.</p><h2 id=what-is-sarif>What is SARIF?
<a class=header-link href=#what-is-sarif><svg class="fill-current o-60 hover-accent-color-light" height="22" viewBox="0 0 24 24" width="22"><path d="M0 0h24v24H0z" fill="none"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h2><p>SARIF is <a href=https://docs.oasis-open.org/sarif/sarif/v2.1.0/errata01/os/sarif-v2.1.0-errata01-os-complete.html target=_blank rel="noreferrer noopener">Static Analysis Results Interchange Format</a>. It's a format
for storing static analysis results, oh wait, the name actually tells us what it
does. It's a JSON file with a specific schema. Your static analysis tool should
be able to output the results in this format, if not, call your vendor!</p><p>I am not going to propose modifying the SARIF format. Run-on blogs are more my
thing than corporate whitepapers. So I will try to find opportunities without
breaking the current specification.</p><h1 id=what-should-i-add-to-the-sarif-file>What Should I Add to the SARIF File?
<a class=header-link href=#what-should-i-add-to-the-sarif-file><svg class="fill-current o-60 hover-accent-color-light" height="22" viewBox="0 0 24 24" width="22"><path d="M0 0h24v24H0z" fill="none"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h1><p>While I want this blog to concentrate on the <em>how</em> rather than the <em>what</em>, I
will still expand a little on the
<a href=/blog/wtf-is-ai-native-sast/#tailored-prompt--sast-result title="Tailored Prompt + SAST Result section" rel=nofollow target=_blank>Tailored Prompt + SAST Result section</a>
section of the previous blog. I propose AI triage needs this info in the SARIF
file:</p><ol><li>Rule context. Generated for each static analysis rule.<ol><li>Tailored prompt.</li><li>Good and bad usage/code.</li></ol></li><li>Code context. Generated for each individual finding.<ol><li>Code snippet.</li><li>Code metadata.</li></ol></li></ol><p>Let's use a hypothetical static analysis rule for SSRF in C#. Usually, I start
by looking for <code>HttpClient.GetAsync</code> and then figure out if the input can be
influenced by users. Here's a <a href=https://github.com/semgrep/semgrep-rules/blob/develop/csharp/lang/security/ssrf/http-client.yaml target=_blank rel="noreferrer noopener">Semgrep rule for it</a>.</p><p>And I know many of you will just fixate on the contents so I will preemptively
state this is just an example and your bike-shedding will fall on deaf ears.
Save it for the promotion committee.</p><h2 id=rule-context>Rule Context
<a class=header-link href=#rule-context><svg class="fill-current o-60 hover-accent-color-light" height="22" viewBox="0 0 24 24" width="22"><path d="M0 0h24v24H0z" fill="none"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h2><p>This is the context that explains the rule and helps AI triage the result
correctly.</p><p>For our SSRF example, <em>the tailored prompt</em> explains what SSRF is, how
<code>HttpClient.GetAsync</code> works, and why it might be vulnerable to SSRF if user
input can influence the URI.</p><p><em>Good and bad code patterns</em> can be liberated from your SAST tests. Show AI
examples of true and false positives.</p><span class=caption-wrapper><img class=caption src=02.webp title="You do know you're using this meme format incorrectly, right?" alt="You do know you're using this meme format incorrectly, right?">
<span class=caption-text>You do know you're using this meme format incorrectly, right?</span></span><h2 id=code-context>Code Context
<a class=header-link href=#code-context><svg class="fill-current o-60 hover-accent-color-light" height="22" viewBox="0 0 24 24" width="22"><path d="M0 0h24v24H0z" fill="none"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h2><p><em>Code context</em> is based on the matched code and generated independently of the
rules.</p><p>Should the actual code be in the file? "Don't put the code in the file, Parsia!"
said my manager. But the results of static analysis ARE also sensitive info.
More importantly, they are a direct result of static analysis so access to the
files likely includes access to code anyway.</p><p>But OK, be careful putting sensitive info in the magic file. Alas, yet another
piece of red tape holding civilization back!</p><span class=caption-wrapper><img class=caption src=01.webp title="Contrary to popular belief I actually value feedback (don't tell them)." alt="Contrary to popular belief I actually value feedback (don't tell them).">
<span class=caption-text>Contrary to popular belief I actually value feedback (don't tell them).</span></span><p><em>Code metadata</em> is the extra information about the matched code and its
surrounding context. You should use a combination of static analysis and AI
here. For example, static analysis identifies all API routes based on
decorators/keywords and AI summarizes them.</p><p>At a minimum, I need the AI generated description of the surrounding function
block<sup id=fnref:1><a href=#fn:1 class=footnote-ref role=doc-noteref>1</a></sup>. I could also include more context about the code's functionality
(for example, this is an API route that retrieves user's info from another
microservice).</p><h2 id=the-feedback-loop>The Feedback Loop
<a class=header-link href=#the-feedback-loop><svg class="fill-current o-60 hover-accent-color-light" height="22" viewBox="0 0 24 24" width="22"><path d="M0 0h24v24H0z" fill="none"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h2><p>You should refine the aforementioned data as time goes by. While it is tempting
to add the false positives to per-rule context, your first line of defense is
tweaking your SAST rule to filter these out. That is not always possible so
some false positives will eventually end up in the context.</p><p>A function that was misidentified as an API route should refine the system
(prompt + SAST as we discussed above) that generates the <em>code metadata</em>. It
will most likely work result in a modified prompt.</p><p>But enough about the data, I want to focus on the actual format here.</p><h1 id=where-does-the-soda-data-go>Where Does the <del>Soda</del> Data Go?<sup id=fnref:2><a href=#fn:2 class=footnote-ref role=doc-noteref>2</a></sup>
<a class=header-link href=#where-does-the-soda-data-go><svg class="fill-current o-60 hover-accent-color-light" height="22" viewBox="0 0 24 24" width="22"><path d="M0 0h24v24H0z" fill="none"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h1><p>I needed to analyze the SARIF structure to find suitable locations for this
info. I've written a good chunk of code for processing SARIF output in
<a href=https://github.com/parsiya/semgrep_go target=_blank rel="noreferrer noopener">Go</a> and <a href=https://github.com/parsiya/semgrep-rs target=_blank rel="noreferrer noopener">Rust</a> and even did some
<a href=/blog/semgrep-fun/ title="fun Semgrep experiments" rel=nofollow target=_blank>fun Semgrep experiments</a>.
This was a chance to look at other parts of the format.</p><h2 id=rule-context-1>Rule Context
<a class=header-link href=#rule-context-1><svg class="fill-current o-60 hover-accent-color-light" height="22" viewBox="0 0 24 24" width="22"><path d="M0 0h24v24H0z" fill="none"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h2><p>The <code>runs > tool > rules</code> section is perfect for the rule context. It has a list
of all rules executed by the tool. According to section
<a href=https://docs.oasis-open.org/sarif/sarif/v2.1.0/errata01/os/sarif-v2.1.0-errata01-os-complete.html#_Toc141790806 target=_blank rel="noreferrer noopener">3.19.23 rules property</a> of the specification, it can have one or
more <a href=https://docs.oasis-open.org/sarif/sarif/v2.1.0/errata01/os/sarif-v2.1.0-errata01-os-complete.html#_Toc141791086 target=_blank rel="noreferrer noopener">reportingDescriptors</a>.</p><p>I will be using an example from running
<a href=https://github.com/0xdea/semgrep-rules target=_blank rel="noreferrer noopener">Marco Ivaldi's (0xdea) Semgrep rules</a> against OWASP Juice Shop.
I've removed some parts to make things easier to read. I will look at the
<a href=https://github.com/0xdea/semgrep-rules/blob/main/rules/c/command-injection.yaml target=_blank rel="noreferrer noopener">c.command-injection rule</a>.</p><div class=highlight><pre tabindex=0 style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-json data-lang=json><span style=display:flex><span>{
</span></span><span style=display:flex><span>  <span style=color:#268bd2>&#34;runs&#34;</span>: [
</span></span><span style=display:flex><span>    {
</span></span><span style=display:flex><span>      <span style=color:#268bd2>&#34;tool&#34;</span>: {
</span></span><span style=display:flex><span>        <span style=color:#268bd2>&#34;driver&#34;</span>: {
</span></span><span style=display:flex><span>          <span style=color:#268bd2>&#34;rules&#34;</span>: [
</span></span><span style=display:flex><span>            {
</span></span><span style=display:flex><span>              <span style=color:#268bd2>&#34;fullDescription&#34;</span>: {
</span></span><span style=display:flex><span>                <span style=color:#268bd2>&#34;text&#34;</span>: <span style=color:#2aa198>&#34;The program invokes a potentially dangerous function ...&#34;</span>
</span></span><span style=display:flex><span>              },
</span></span><span style=display:flex><span>              <span style=color:#268bd2>&#34;help&#34;</span>: {
</span></span><span style=display:flex><span>                <span style=color:#268bd2>&#34;markdown&#34;</span>: <span style=color:#2aa198>&#34;The program invokes ...&#34;</span>,
</span></span><span style=display:flex><span>                <span style=color:#268bd2>&#34;text&#34;</span>: <span style=color:#2aa198>&#34;The program invokes ...&#34;</span>
</span></span><span style=display:flex><span>              },
</span></span><span style=display:flex><span>              <span style=color:#268bd2>&#34;id&#34;</span>: <span style=color:#2aa198>&#34;semgrep-rules.c.raptor-command-injection&#34;</span>,
</span></span><span style=display:flex><span>              <span style=color:#268bd2>&#34;name&#34;</span>: <span style=color:#2aa198>&#34;semgrep-rules.c.raptor-command-injection&#34;</span>,
</span></span><span style=display:flex><span>              <span style=color:#268bd2>&#34;properties&#34;</span>: {
</span></span><span style=display:flex><span>                <span style=color:#268bd2>&#34;precision&#34;</span>: <span style=color:#2aa198>&#34;very-high&#34;</span>,
</span></span><span style=display:flex><span>                <span style=color:#268bd2>&#34;tags&#34;</span>: [
</span></span><span style=display:flex><span>                  <span style=color:#2aa198>&#34;HIGH CONFIDENCE&#34;</span>
</span></span><span style=display:flex><span>                ]
</span></span><span style=display:flex><span>              },
</span></span><span style=display:flex><span>              <span style=color:#268bd2>&#34;shortDescription&#34;</span>: {
</span></span><span style=display:flex><span>                <span style=color:#268bd2>&#34;text&#34;</span>: <span style=color:#2aa198>&#34;Semgrep Finding: semgrep-rules.c.raptor-command-injection&#34;</span>
</span></span><span style=display:flex><span>              }
</span></span><span style=display:flex><span>            }
</span></span><span style=display:flex><span>            <span style=color:#586e75>// removed
</span></span></span></code></pre></div><p>The <code>help</code> property is tempting. It's a
<a href=https://docs.oasis-open.org/sarif/sarif/v2.1.0/errata01/os/sarif-v2.1.0-errata01-os-complete.html#_Toc141790723 target=_blank rel="noreferrer noopener">3.12 multiformatMessageString object</a> with two keys: <code>text</code> and
<code>markdown</code>. Semgrep populates the <code>text</code> portion with the rule message and the
markdown section has the rule message + the references (maybe more?). This is
not a good choice, because it will be overwritten by Semgrep and probably other
tools.</p><p>I decided to use <a href=https://docs.oasis-open.org/sarif/sarif/v2.1.0/errata01/os/sarif-v2.1.0-errata01-os-complete.html#_Toc141790698 target=_blank rel="noreferrer noopener">3.8 Property Bags</a> instead. The format defines them
as "an unordered set of properties with arbitrary names." More importantly, they
can be part of any tag:</p><blockquote><p>every object defined in this document MAY contain a property named properties
whose value is a property bag. This allows SARIF producers to include
information about each object that is not explicitly specified in the SARIF
format.</p></blockquote><p>We will use camelCase keys to remain compliant with the specification:</p><blockquote><p>The components of the property names SHOULD be camelCase strings ...</p></blockquote><p>Semgrep has populated the property bag in our example with some data. I will add
the <em>rule context</em> there.</p><div class=highlight><pre tabindex=0 style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-json data-lang=json><span style=display:flex><span>{
</span></span><span style=display:flex><span>  <span style=color:#268bd2>&#34;runs&#34;</span>: [
</span></span><span style=display:flex><span>    {
</span></span><span style=display:flex><span>      <span style=color:#268bd2>&#34;tool&#34;</span>: {
</span></span><span style=display:flex><span>        <span style=color:#268bd2>&#34;driver&#34;</span>: {
</span></span><span style=display:flex><span>          <span style=color:#268bd2>&#34;rules&#34;</span>: [
</span></span><span style=display:flex><span>            {
</span></span><span style=display:flex><span>              <span style=color:#586e75>// removed
</span></span></span><span style=display:flex><span><span style=color:#586e75></span>              <span style=color:#268bd2>&#34;id&#34;</span>: <span style=color:#2aa198>&#34;semgrep-rules.c.raptor-command-injection&#34;</span>,
</span></span><span style=display:flex><span>              <span style=color:#268bd2>&#34;name&#34;</span>: <span style=color:#2aa198>&#34;semgrep-rules.c.raptor-command-injection&#34;</span>,
</span></span><span style=display:flex><span>              <span style=color:#268bd2>&#34;properties&#34;</span>: {
</span></span><span style=display:flex><span>                <span style=color:#268bd2>&#34;aiPrompt&#34;</span>: <span style=color:#2aa198>&#34;...&#34;</span>, <span style=color:#586e75>// ZZZ: triagePrompt?
</span></span></span><span style=display:flex><span><span style=color:#586e75></span>                <span style=color:#268bd2>&#34;codeContext&#34;</span>: <span style=color:#2aa198>&#34;...&#34;</span>, <span style=color:#586e75>// ZZZ: need better name
</span></span></span><span style=display:flex><span><span style=color:#586e75></span>              },
</span></span><span style=display:flex><span>            }
</span></span><span style=display:flex><span>            <span style=color:#586e75>// removed
</span></span></span></code></pre></div><h2 id=code-context-1>Code Context
<a class=header-link href=#code-context-1><svg class="fill-current o-60 hover-accent-color-light" height="22" viewBox="0 0 24 24" width="22"><path d="M0 0h24v24H0z" fill="none"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h2><p>The code context should be part of each finding. The findings are
<a href=https://docs.oasis-open.org/sarif/sarif/v2.1.0/errata01/os/sarif-v2.1.0-errata01-os-complete.html#_Toc141790888 target=_blank rel="noreferrer noopener">3.27 result objects</a> and look like:</p><div class=highlight><pre tabindex=0 style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-json data-lang=json><span style=display:flex><span>{
</span></span><span style=display:flex><span>  <span style=color:#268bd2>&#34;runs&#34;</span>: [
</span></span><span style=display:flex><span>    {
</span></span><span style=display:flex><span>      <span style=color:#268bd2>&#34;results&#34;</span>: [
</span></span><span style=display:flex><span>        {
</span></span><span style=display:flex><span>          <span style=color:#268bd2>&#34;locations&#34;</span>: [
</span></span><span style=display:flex><span>            {
</span></span><span style=display:flex><span>              <span style=color:#268bd2>&#34;physicalLocation&#34;</span>: {
</span></span><span style=display:flex><span>                <span style=color:#268bd2>&#34;artifactLocation&#34;</span>: {
</span></span><span style=display:flex><span>                  <span style=color:#268bd2>&#34;uri&#34;</span>: <span style=color:#2aa198>&#34;juice-shop/.eslintrc.js&#34;</span>,
</span></span><span style=display:flex><span>                  <span style=color:#268bd2>&#34;uriBaseId&#34;</span>: <span style=color:#2aa198>&#34;%SRCROOT%&#34;</span>
</span></span><span style=display:flex><span>                },
</span></span><span style=display:flex><span>                <span style=color:#268bd2>&#34;region&#34;</span>: {
</span></span><span style=display:flex><span>                  <span style=color:#268bd2>&#34;endColumn&#34;</span>: <span style=color:#2aa198>17</span>,
</span></span><span style=display:flex><span>                  <span style=color:#268bd2>&#34;endLine&#34;</span>: <span style=color:#2aa198>37</span>,
</span></span><span style=display:flex><span>                  <span style=color:#268bd2>&#34;snippet&#34;</span>: {
</span></span><span style=display:flex><span>                    <span style=color:#268bd2>&#34;text&#34;</span>: <span style=color:#2aa198>&#34;// FIXME warnings below this line need to ...&#34;</span>
</span></span><span style=display:flex><span>                  },
</span></span><span style=display:flex><span>                  <span style=color:#268bd2>&#34;startColumn&#34;</span>: <span style=color:#2aa198>12</span>,
</span></span><span style=display:flex><span>                  <span style=color:#268bd2>&#34;startLine&#34;</span>: <span style=color:#2aa198>37</span>
</span></span><span style=display:flex><span>                }
</span></span><span style=display:flex><span>              }
</span></span><span style=display:flex><span>            }
</span></span><span style=display:flex><span>          ],
</span></span><span style=display:flex><span>          <span style=color:#268bd2>&#34;message&#34;</span>: {
</span></span><span style=display:flex><span>            <span style=color:#268bd2>&#34;text&#34;</span>: <span style=color:#2aa198>&#34;The code contains comments ...&#34;</span>
</span></span><span style=display:flex><span>          },
</span></span><span style=display:flex><span>          <span style=color:#268bd2>&#34;properties&#34;</span>: {},
</span></span><span style=display:flex><span>          <span style=color:#268bd2>&#34;ruleId&#34;</span>: <span style=color:#2aa198>&#34;semgrep-rules.generic.raptor-bad-words&#34;</span>
</span></span><span style=display:flex><span>        },
</span></span><span style=display:flex><span>        <span style=color:#586e75>// removed
</span></span></span></code></pre></div><p>Note the <code>snippet > text</code> key with the value of the captured code. So much for
not having sensitive info in the SARIF file üòú.</p><p>This object also supports a property bag that we can reuse:</p><div class=highlight><pre tabindex=0 style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-json data-lang=json><span style=display:flex><span>{
</span></span><span style=display:flex><span>  <span style=color:#268bd2>&#34;runs&#34;</span>: [
</span></span><span style=display:flex><span>    {
</span></span><span style=display:flex><span>      <span style=color:#268bd2>&#34;results&#34;</span>: [
</span></span><span style=display:flex><span>        {
</span></span><span style=display:flex><span>          <span style=color:#586e75>// removed
</span></span></span><span style=display:flex><span><span style=color:#586e75></span>          <span style=color:#268bd2>&#34;properties&#34;</span>: {
</span></span><span style=display:flex><span>            <span style=color:#268bd2>&#34;code&#34;</span>: <span style=color:#2aa198>&#34;_gasp_&#34;</span>,
</span></span><span style=display:flex><span>            <span style=color:#268bd2>&#34;codeMetadata&#34;</span>: <span style=color:#2aa198>&#34;...&#34;</span>
</span></span><span style=display:flex><span>          },
</span></span><span style=display:flex><span>          <span style=color:#268bd2>&#34;ruleId&#34;</span>: <span style=color:#2aa198>&#34;semgrep-rules.generic.raptor-bad-words&#34;</span>
</span></span><span style=display:flex><span>        },
</span></span><span style=display:flex><span>        <span style=color:#586e75>// removed
</span></span></span></code></pre></div><h1 id=when-do-i-modify-the-sarif-file>When Do I Modify the SARIF File?
<a class=header-link href=#when-do-i-modify-the-sarif-file><svg class="fill-current o-60 hover-accent-color-light" height="22" viewBox="0 0 24 24" width="22"><path d="M0 0h24v24H0z" fill="none"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h1><p>Ideally static analysis tools should do it. I've modified my toy static analysis
tool to generate these new SARIF files. A unique feature according to this chart.</p><span class=caption-wrapper><img class=caption src=04.webp title="Accepting funding at 1 billion valuation!" alt="Accepting funding at 1 billion valuation!">
<span class=caption-text>Accepting funding at 1 billion valuation!</span></span><p>It's easy to process rule context data. Create the prompt and the code samples
for each rule (I use Semgrep tests) and store them by rule ID in a database.
Then use the rule ID in the SARIF file to retrieve them.</p><p><em>Code context</em> matching sounds much harder but it's not. Store the code context by
"function" or "file" along with the code address (file path and function offset)
in the database. Use the location and file path of each finding to match which
file and function contain the match. To make things easier, especially in the
beginning of your AI journey, don't worry about functions. Just generate and
pass the code and context of the entire file to AI and let it do the heavy
lifting.</p><p>The implementation is pretty simple. I wrote it by hand and without LLMs. It
didn't even need library support. I encourage you to do the same to exercise
your coding muscles. It's just parsing JSON and adding data to the <code>properties</code>
key of specific items.</p><p>Just as I was finalizing the blog, LinkedIn published an article about their
<a href=https://www.linkedin.com/blog/engineering/security/modernizing-linkedins-static-application-security-testing-capabilities target=_blank rel="noreferrer noopener">SAST pipeline</a>. They mention a "SARIF enrichment" step.</p><blockquote><p>We enrich SARIF alerts with additional metadata and remediation information
specific to LinkedIn‚Äôs environment.</p></blockquote><p>This is inline with my idea. I like the name "SARIF enrichment."</p><h1 id=what-does-the-data-come-from>What Does the Data Come From?
<a class=header-link href=#what-does-the-data-come-from><svg class="fill-current o-60 hover-accent-color-light" height="22" viewBox="0 0 24 24" width="22"><path d="M0 0h24v24H0z" fill="none"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h1><p>That is the million dollar question. The secret sauce or better yet, the
so-called "Potter's Puff." What's that? It's my transliteration of the Persian
idiom ŸÅŸàÿ™ ⁄©Ÿàÿ≤Ÿá‚Äå ⁄Øÿ±€å.</p><p>In ancient times an apprentice studied under a master potter. The apprentice
left the master after thinking they had learned it all. But their pottery came
out ruined with muddy colors. Turns out dust would accumulate on the pottery so
the master would blow on each piece before firing it in the kiln.</p><span class=caption-wrapper><img class=caption src=03.webp title="No, not like that!" alt="No, not like that!">
<span class=caption-text>No, not like that!</span></span><blockquote><p>Tired: Secret sauce. Pedestrian and overused. Probably LLM generated.<br>Wired: Potter's Puff. Unique and exquisite. 100% organic.</p></blockquote><p>So no one is going to give away the magic. Least of all me, I am very expensive
financially and emotionally, just ask my boss. Jokes aside, I am still
experimenting here. Static analysis is not my main job and I do this on the side
so I cannot compete with actual companies. Still I've made some progress like
reusing Semgrep tests and I have some fun ideas for automagically generating
tailored prompts, too.</p><h1 id=what-did-we-learn-here-today>What Did We Learn Here Today?
<a class=header-link href=#what-did-we-learn-here-today><svg class="fill-current o-60 hover-accent-color-light" height="22" viewBox="0 0 24 24" width="22"><path d="M0 0h24v24H0z" fill="none"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h1><p>The article suggests including the data needed for AI triage in the SARIF file.
I proposed adding two types of data: per rule and per finding. I identified
practical locations in the SARIF format for them. I also discussed some ways to
generate this data, but my experiments are still ongoing. And last but not
least, we learned a new idiom to differentiate our writing from AI slop.</p><p>I am very curious to connect with others in this field and learn what they are
doing and finally, whether this is a path worth pursuing. Please reach out, you
know where to find me.</p><div class=footnotes role=doc-endnotes><hr><ol><li id=fn:1><p>Everything is <del>computer</del> function!&#160;<a href=#fnref:1 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:2><p><a href=https://www.reddit.com/r/WhereDidTheSodaGo target=_blank rel="noreferrer noopener">https://www.reddit.com/r/WhereDidTheSodaGo</a>&#160;<a href=#fnref:2 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li></ol></div></div><footer><p class=meta><span class="byline author vcard">Posted by <span class=fn>Parsia</span></span><time>Dec 11, 2025</time></span></p><p class=meta><a class="basic-alignment left" href=https://parsiya.net/blog/wtf-is-ai-native-sast/ title="WTF is ... - AI-Native SAST?">WTF is ... - AI-Native SAST?</a></p></footer></article></div><aside class="sidebar thirds"><section class="first odd"><h1>Who am I?</h1><p><p>I am Parsia, a security engineer at Microsoft.</p><p>I write about application security, cryptography, static analysis, and
(of course) videogames.</p><p>Click on <a href=/about/>About Me!</a> to know more. Contact me via any of these ways.</p></p></section><ul class=sidebar-nav><li class=sidebar-nav-item><a target=_blank rel="me noopener noreferrer" href=https://infosec.exchange/@parsiya title=https://infosec.exchange/@parsiya><i class="fa fa-mastodon fa-3x"></i></a>
<a target=_blank rel="noopener noreferrer" href=https://github.com/parsiya/ title=https://github.com/parsiya/><i class="fa fa-github fa-3x"></i></a>
<a target=_blank rel="noopener noreferrer" href=https://twitter.com/cryptogangsta/ title=https://twitter.com/cryptogangsta/><i class="fa fa-twitter fa-3x"></i></a>
<a target=_blank rel="noopener noreferrer" href=https://www.linkedin.com/in/parsiya title=https://www.linkedin.com/in/parsiya><i class="fa fa-linkedin fa-3x"></i></a></li></ul><section class=odd><h1>Collections</h1><li><a href=https://parsiya.net/categories/thick-client-proxying/ title="Thick Client Proxying">Thick Client Proxying</a></li><li><a href=https://parsiya.net/categories/writeup/ title=CTFs/Writeups>CTFs/Writeups</a></li><li><a href=https://parsiya.net/categories/attack-surface-analysis/ title="Attack Surface Analysis">Attack Surface Analysis</a></li><li><a href=https://parsiya.net/categories/static-analysis/ title="Static Analysis">Static Analysis</a></li><li><a href=https://parsiya.net/categories/bug-bounty/ title="Bug Bounty">Bug Bounty</a></li><li><a href=https://parsiya.net/categories/blockchain/ title="Blockchain (lol)">Blockchain (lol)</a></li><li><a href=https://parsiya.net/categories/crypto/ title=Crypto(graphy)>Crypto(graphy)</a></li><li><a href=https://parsiya.net/categories/burp-extension/ title="Burp Extension Development">Burp Extension Development</a></li><li><a href=https://parsiya.net/categories/automation/ title=Automation>Automation</a></li><li><a href=https://parsiya.net/categories/reverse-engineering/ title="Reverse Engineering">Reverse Engineering</a></li><li><a href=https://parsiya.net/categories/winappdbg/ title="WinAppDbg (use Frida instead)">WinAppDbg (use Frida instead)</a></li><li><a href=https://awsome.pw title='AWSome.pw - S3 bucket squatting - my very "legit" branded vulnerability'>AWSome.pw - S3 bucket squatting - my very "legit" branded vulnerability</a></li></section></aside></div></div><footer role=contentinfo><p>Copyright &copy; 2025 Parsia - <a href=https://parsiya.net/license/>License</a> -
<span class=credit>Powered by <a target=_blank href=https://gohugo.io rel="noopener noreferrer">Hugo</a> and <a target=_blank href=https://github.com/parsiya/hugo-octopress/ rel="noopener noreferrer">Hugo-Octopress</a> theme.</p></footer></body></html>