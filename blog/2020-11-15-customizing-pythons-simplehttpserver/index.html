<!doctype html><html xmlns=http://www.w3.org/1999/xhtml xml:lang=en lang=en-us><head><meta charset=utf-8><meta name=viewport content="width=device-width,minimum-scale=1,maximum-scale=1"><link href=/css/fonts.css rel=stylesheet type=text/css><title>Customizing Python's SimpleHTTPServer</title><link rel=stylesheet href=/css/hugo-octopress.css><link rel=stylesheet href=/css/fork-awesome.min.css><link href=https://parsiya.net/favicon.png rel=icon><meta name=description content><meta name=keywords content="[Parsia Hakimian Parsiya infosec information security]"><meta name=author content="Parsia"><meta name=generator content="Hugo 0.155.3"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image:src content="https://parsiya.net/blog/2020-11-15-customizing-pythons-simplehttpserver/04.png"><meta name=twitter:title content="Customizing Python's SimpleHTTPServer"><meta name=twitter:description content="The other day I customized the Python built-in SimpleHTTPServer with some
routes. I did not find a lot of info about it (most use it to serve files). This
is how I did some basic customization."><meta name=twitter:domain content="parsiya.net"><meta name=twitter:creator content="@CryptoGangsta"></head><body><header role=banner><hgroup><h1><a href=https://parsiya.net/>Hackerman's Hacking Tutorials</a></h1><h2>The knowledge of anything, since all things have causes, is not acquired or
complete unless it is known by its causes. - Avicenna</h2></hgroup></header><nav role=navigation><fieldset class=mobile-nav><select onchange="location=this.value"><option value>Navigate…</option><option value=https://parsiya.net/about/>» About Me!</option><option value=https://parsiya.net/cheatsheet/>» Cheat Sheet</option><option value=https://parsiya.io/>» My Clone</option><option value=https://github.com/parsiya/parsiya.net>» Source Repo</option><option value="https://queue.acm.org/detail.cfm?id=3197520">» Manual Work is a Bug</option><option value="https://www.google.com/search?q=andrew+ridgeley">» The Other Guy from Wham!</option></select></fieldset><ul class=main-navigation><li><a href=https://parsiya.net/about/ title="About Me!" target=_blank rel="noopener noreferrer">About Me!</a></li><li><a href=https://parsiya.net/cheatsheet/ title="Cheat Sheet" target=_blank rel="noopener noreferrer">Cheat Sheet</a></li><li><a href=https://parsiya.io/ title="My Clone" target=_blank rel="noopener noreferrer">My Clone</a></li><li><a href=https://github.com/parsiya/parsiya.net title="Source Repo" target=_blank rel="noopener noreferrer">Source Repo</a></li><li><a href="https://queue.acm.org/detail.cfm?id=3197520" title="Manual Work is a Bug" target=_blank rel="noopener noreferrer">Manual Work is a Bug</a></li><li><a href="https://www.google.com/search?q=andrew+ridgeley" title="The Other Guy from Wham!" target=_blank rel="noopener noreferrer">The Other Guy from Wham!</a></li></ul><ul class=subscription><a href=https://parsiya.net/index.xml target=_blank type=application/rss+xml title=RSS rel="noopener noreferrer"><i class="fa fa-rss-square fa-lg"></i></a></ul><form action=https://www.google.com/search method=get target=_blank rel="noopener noreferrer"><fieldset role=search><input class=search type=text name=q results=0 placeholder=Search>
<input type=hidden name=q value=site:https://parsiya.net/></fieldset></form></nav><div id=main><div id=content><div><article class=hentry role=article><header><p class=meta>Nov 15, 2020
- 3 minute read - <a class=label href=https://parsiya.net/categories/python/>python</a></p><h1 class=entry-title>Customizing Python's SimpleHTTPServer</h1></header><div class=entry-content><nav id=TableOfContents><ul><li><a href=#how-to-serve-files>How to Serve Files</a></li><li><a href=#custom-get-responses>Custom GET Responses</a></li><li><a href=#custom-response-headers>Custom Response Headers</a></li><li><a href=#read-request-path-and-query-strings>Read Request Path and Query Strings</a></li><li><a href=#read-request-headers>Read Request Headers</a></li><li><a href=#reading-the-body-of-post-requests>Reading The Body of POST Requests</a></li><li><a href=#server-over-tls>Server Over TLS</a></li></ul></nav><p>The other day I customized the Python built-in SimpleHTTPServer with some
routes. I did not find a lot of info about it (most use it to serve files). This
is how I did some basic customization.</p><p>This is for Python 3.8.6 (which what I have in my testing VM) but it should work
on Python 3.9 (and probably the same for Python 2).</p><p>Code is at
<a href=https://github.com/parsiya/Parsia-Code/tree/master/python-simplehttpserver target=_blank rel="noreferrer noopener">https://github.com/parsiya/Parsia-Code/tree/master/python-simplehttpserver</a>.</p><h1 id=how-to-serve-files>How to Serve Files
<a class=header-link href=#how-to-serve-files><svg class="fill-current o-60 hover-accent-color-light" height="22" viewBox="0 0 24 24" width="22"><path d="M0 0h24v24H0z" fill="none"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h1><p><code>python -m http.server 1234 --bind 127.0.0.1</code>.</p><h1 id=custom-get-responses>Custom GET Responses
<a class=header-link href=#custom-get-responses><svg class="fill-current o-60 hover-accent-color-light" height="22" viewBox="0 0 24 24" width="22"><path d="M0 0h24v24H0z" fill="none"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h1><p>But I needed to customize the path. Let's start with a simple implementation. We
need to create our own <a href=https://docs.python.org/3.8/library/http.server.html target=_blank rel="noreferrer noopener">BaseHTTPRequestHandler</a>.</p><div class=highlight><pre tabindex=0 style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#719e07>from</span> http.server <span style=color:#719e07>import</span> HTTPServer, BaseHTTPRequestHandler
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#719e07>class</span> <span style=color:#268bd2>MyHandler</span>(BaseHTTPRequestHandler):
</span></span><span style=display:flex><span>    <span style=color:#719e07>def</span> <span style=color:#268bd2>do_GET</span>(<span style=color:#268bd2>self</span>):
</span></span><span style=display:flex><span>        <span style=color:#719e07>pass</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>httpd <span style=color:#719e07>=</span> HTTPServer((<span style=color:#2aa198>&#39;localhost&#39;</span>, <span style=color:#2aa198>10000</span>), MyHandler)
</span></span><span style=display:flex><span>httpd<span style=color:#719e07>.</span>serve_forever()
</span></span></code></pre></div><p>To respond to GET requests we need to add code to <code>do_GET</code>. Let's say we want to
return a 200 response that says <code>It works!</code>.</p><div class=highlight><pre tabindex=0 style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#586e75># 01.py</span>
</span></span><span style=display:flex><span><span style=color:#719e07>def</span> <span style=color:#268bd2>do_GET</span>(<span style=color:#268bd2>self</span>):
</span></span><span style=display:flex><span>    <span style=color:#586e75># send 200 response</span>
</span></span><span style=display:flex><span>    <span style=color:#268bd2>self</span><span style=color:#719e07>.</span>send_response(<span style=color:#2aa198>200</span>)
</span></span><span style=display:flex><span>    <span style=color:#586e75># send response headers</span>
</span></span><span style=display:flex><span>    <span style=color:#268bd2>self</span><span style=color:#719e07>.</span>end_headers()
</span></span><span style=display:flex><span>    <span style=color:#586e75># send the body of the response</span>
</span></span><span style=display:flex><span>    <span style=color:#268bd2>self</span><span style=color:#719e07>.</span>wfile<span style=color:#719e07>.</span>write(<span style=color:#b58900>bytes</span>(<span style=color:#2aa198>&#34;It Works!&#34;</span>, <span style=color:#2aa198>&#34;utf-8&#34;</span>))
</span></span></code></pre></div><span class=caption-wrapper><img class=caption src=01.png title=01.py alt=01.py>
<span class=caption-text>01.py</span></span><h1 id=custom-response-headers>Custom Response Headers
<a class=header-link href=#custom-response-headers><svg class="fill-current o-60 hover-accent-color-light" height="22" viewBox="0 0 24 24" width="22"><path d="M0 0h24v24H0z" fill="none"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h1><p>Note the server adds some default headers. To modify these we can use
<a href=https://docs.python.org/3.8/library/http.server.html#http.server.BaseHTTPRequestHandler.send_header target=_blank rel="noreferrer noopener">send_header</a> before calling <a href=https://docs.python.org/3.8/library/http.server.html#http.server.BaseHTTPRequestHandler.end_headers target=_blank rel="noreferrer noopener">end_headers</a>. This is
very useful for adding the <code>Content-Type</code> header.</p><div class=highlight><pre tabindex=0 style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#586e75># 02.py</span>
</span></span><span style=display:flex><span><span style=color:#719e07>def</span> <span style=color:#268bd2>do_GET</span>(<span style=color:#268bd2>self</span>):
</span></span><span style=display:flex><span>    <span style=color:#586e75># send 200 response</span>
</span></span><span style=display:flex><span>    <span style=color:#268bd2>self</span><span style=color:#719e07>.</span>send_response(<span style=color:#2aa198>200</span>)
</span></span><span style=display:flex><span>    <span style=color:#586e75># add our own custom header</span>
</span></span><span style=display:flex><span>    <span style=color:#268bd2>self</span><span style=color:#719e07>.</span>send_header(<span style=color:#2aa198>&#34;myheader&#34;</span>, <span style=color:#2aa198>&#34;myvalue&#34;</span>)
</span></span><span style=display:flex><span>    <span style=color:#586e75># send response headers</span>
</span></span><span style=display:flex><span>    <span style=color:#268bd2>self</span><span style=color:#719e07>.</span>end_headers()
</span></span><span style=display:flex><span>    <span style=color:#586e75># send the body of the response</span>
</span></span><span style=display:flex><span>    <span style=color:#268bd2>self</span><span style=color:#719e07>.</span>wfile<span style=color:#719e07>.</span>write(<span style=color:#b58900>bytes</span>(<span style=color:#2aa198>&#34;It Works!&#34;</span>, <span style=color:#2aa198>&#34;utf-8&#34;</span>))
</span></span></code></pre></div><span class=caption-wrapper><img class=caption src=02.png title=02.py alt=02.py>
<span class=caption-text>02.py</span></span><p>To override a header we cannot use <code>send_header</code> because it will just add it as
a new header to the response. Based on the documentation it seems like the
<code>Date</code> and <code>Server</code> response headers cannot be changed :(.</p><h1 id=read-request-path-and-query-strings>Read Request Path and Query Strings
<a class=header-link href=#read-request-path-and-query-strings><svg class="fill-current o-60 hover-accent-color-light" height="22" viewBox="0 0 24 24" width="22"><path d="M0 0h24v24H0z" fill="none"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h1><p>The complete path and query strings are in the <code>self.path</code> object inside
<code>do_GET</code> and similar methods. First we need to parse it with
<a href=https://docs.python.org/3/library/urllib.parse.html#urllib.parse.urlparse target=_blank rel="noreferrer noopener">urllib.parse.urlparse</a>. Then we can get the query string and path
from the parsed object's fields <code>query</code> and <code>path</code>, respectively.</p><div class=highlight><pre tabindex=0 style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-py data-lang=py><span style=display:flex><span><span style=color:#719e07>from</span> urllib.parse <span style=color:#719e07>import</span> urlparse
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#719e07>def</span> <span style=color:#268bd2>do_GET</span>(<span style=color:#268bd2>self</span>):
</span></span><span style=display:flex><span>    <span style=color:#586e75># first we need to parse it</span>
</span></span><span style=display:flex><span>    parsed <span style=color:#719e07>=</span> urlparse(<span style=color:#268bd2>self</span><span style=color:#719e07>.</span>path)
</span></span><span style=display:flex><span>    <span style=color:#586e75># get the query string</span>
</span></span><span style=display:flex><span>    query_string <span style=color:#719e07>=</span> parsed<span style=color:#719e07>.</span>query
</span></span><span style=display:flex><span>    <span style=color:#586e75># get the request path, this new path does not have the query string</span>
</span></span><span style=display:flex><span>    path <span style=color:#719e07>=</span> parsed<span style=color:#719e07>.</span>path
</span></span></code></pre></div><h1 id=read-request-headers>Read Request Headers
<a class=header-link href=#read-request-headers><svg class="fill-current o-60 hover-accent-color-light" height="22" viewBox="0 0 24 24" width="22"><path d="M0 0h24v24H0z" fill="none"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h1><p>I needed to read the incoming request headers. These are stored in the
<a href=https://docs.python.org/3.8/library/http.server.html#http.server.BaseHTTPRequestHandler.headers target=_blank rel="noreferrer noopener">headers</a> object. It is of type <code>http.client.HTTPMessage</code> which is a
subclass of <a href=https://docs.python.org/3/library/email.compat32-message.html#email.message.Message target=_blank rel="noreferrer noopener">email.message.Message</a>.</p><p>We can get the first value of a header by name with <code>headers.get("header name")</code>
. To get all values for a specific header (because headers can be repeated) use
<code>headers.get_all("header name")</code>.</p><div class=highlight><pre tabindex=0 style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#586e75># 03.py</span>
</span></span><span style=display:flex><span><span style=color:#719e07>def</span> <span style=color:#268bd2>do_GET</span>(<span style=color:#268bd2>self</span>):
</span></span><span style=display:flex><span>    <span style=color:#586e75># get the value of the &#34;Authorization&#34; header and echo it.</span>
</span></span><span style=display:flex><span>    authz <span style=color:#719e07>=</span> <span style=color:#268bd2>self</span><span style=color:#719e07>.</span>headers<span style=color:#719e07>.</span>get(<span style=color:#2aa198>&#34;authorization&#34;</span>)
</span></span><span style=display:flex><span>    <span style=color:#586e75># send 200 response</span>
</span></span><span style=display:flex><span>    <span style=color:#268bd2>self</span><span style=color:#719e07>.</span>send_response(<span style=color:#2aa198>200</span>)
</span></span><span style=display:flex><span>    <span style=color:#586e75># send response headers</span>
</span></span><span style=display:flex><span>    <span style=color:#268bd2>self</span><span style=color:#719e07>.</span>end_headers()
</span></span><span style=display:flex><span>    <span style=color:#586e75># send the body of the response</span>
</span></span><span style=display:flex><span>    <span style=color:#268bd2>self</span><span style=color:#719e07>.</span>wfile<span style=color:#719e07>.</span>write(<span style=color:#b58900>bytes</span>(authz, <span style=color:#2aa198>&#34;utf-8&#34;</span>))
</span></span></code></pre></div><p>Note: Header names are not case-sensitive in HTTP (or in this module).</p><span class=caption-wrapper><img class=caption src=03.png title=03.py alt=03.py>
<span class=caption-text>03.py</span></span><h1 id=reading-the-body-of-post-requests>Reading The Body of POST Requests
<a class=header-link href=#reading-the-body-of-post-requests><svg class="fill-current o-60 hover-accent-color-light" height="22" viewBox="0 0 24 24" width="22"><path d="M0 0h24v24H0z" fill="none"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h1><p>To handle POST requests we need to implement <code>do_POST</code> (surprise). To read the
body of the POST request we:</p><ol><li>Read the <code>Content-Length</code> header in the incoming request.</li><li>Read that many bytes from <code>self.rfile</code>.<ol><li>I could not find a way to read "all bytes" in <code>rfile</code>. I had to rely on
the <code>Content-Length</code> header.</li></ol></li></ol><figure class=code><figcaption><span>Reading the body</span></figcaption><div class=codewrapper><div class=highlight><div style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#495050"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#495050"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#495050"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#495050"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#495050"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#495050"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#495050"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#495050"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#495050"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#495050">10
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#719e07>def</span> <span style=color:#268bd2>do_POST</span>(<span style=color:#268bd2>self</span>):
</span></span><span style=display:flex><span>    <span style=color:#586e75># read the content-length header</span>
</span></span><span style=display:flex><span>    content_length <span style=color:#719e07>=</span> <span style=color:#b58900>int</span>(<span style=color:#268bd2>self</span><span style=color:#719e07>.</span>headers<span style=color:#719e07>.</span>get(<span style=color:#2aa198>&#34;Content-Length&#34;</span>))
</span></span><span style=display:flex><span>    <span style=color:#586e75># read that many bytes from the body of the request</span>
</span></span><span style=display:flex><span>    body <span style=color:#719e07>=</span> <span style=color:#268bd2>self</span><span style=color:#719e07>.</span>rfile<span style=color:#719e07>.</span>read(content_length)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#268bd2>self</span><span style=color:#719e07>.</span>send_response(<span style=color:#2aa198>200</span>)
</span></span><span style=display:flex><span>    <span style=color:#268bd2>self</span><span style=color:#719e07>.</span>end_headers()
</span></span><span style=display:flex><span>    <span style=color:#586e75># echo the body in the response</span>
</span></span><span style=display:flex><span>    <span style=color:#268bd2>self</span><span style=color:#719e07>.</span>wfile<span style=color:#719e07>.</span>write(body)</span></span></code></pre></td></tr></table></div></div></div></figure><span class=caption-wrapper><img class=caption src=04.png title=04.py alt=04.py>
<span class=caption-text>04.py</span></span><h1 id=server-over-tls>Server Over TLS
<a class=header-link href=#server-over-tls><svg class="fill-current o-60 hover-accent-color-light" height="22" viewBox="0 0 24 24" width="22"><path d="M0 0h24v24H0z" fill="none"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h1><p>First, you need to create a private key and certificate in <code>pem</code> format. To
create a self-signed certificate/key in one line with OpenSSL:</p><pre tabindex=0><code>openssl req -newkey rsa:2048 -nodes -keyout key.pem -x509 -days 365 -out certificate.pem
</code></pre><p>Then modify the last lines of the original script to:</p><div class=highlight><pre tabindex=0 style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-python data-lang=python><span style=display:flex><span>httpd <span style=color:#719e07>=</span> HTTPServer((<span style=color:#2aa198>&#39;localhost&#39;</span>, <span style=color:#2aa198>443</span>), MyHandler)
</span></span><span style=display:flex><span>httpd<span style=color:#719e07>.</span>socket <span style=color:#719e07>=</span> ssl<span style=color:#719e07>.</span>wrap_socket(httpd<span style=color:#719e07>.</span>socket, server_side<span style=color:#719e07>=</span><span style=color:#cb4b16>True</span>, certfile<span style=color:#719e07>=</span><span style=color:#2aa198>&#34;certificate.pem&#34;</span>, keyfile<span style=color:#719e07>=</span><span style=color:#2aa198>&#34;key.pem&#34;</span>)
</span></span><span style=display:flex><span>httpd<span style=color:#719e07>.</span>serve_forever()
</span></span></code></pre></div></div><footer><p class=meta><span class="byline author vcard">Posted by <span class=fn>Parsia</span></span><time>Nov 15, 2020</time></span></p><p class=meta><a class="basic-alignment left" href=https://parsiya.net/blog/2020-11-01-the-same-origin-policy-gone-wild/ title="The Same-Origin Policy Gone Wild">The Same-Origin Policy Gone Wild</a>
<a class="basic-alignment right" href=https://parsiya.net/blog/2021-01-01-the-15000-playstation-bounty/ title="The $15000 PlayStation Bounty">The $15000 PlayStation Bounty</a></p></footer></article></div><aside class="sidebar thirds"><section class="first odd"><h1>Who am I?</h1><p><p>I am Parsia, a security engineer at Microsoft.</p><p>I write about application security, cryptography, static analysis, and
(of course) videogames.</p><p>Click on <a href=/about/>About Me!</a> to know more. Contact me via any of these ways.</p></p></section><ul class=sidebar-nav><li class=sidebar-nav-item><a target=_blank rel="me noopener noreferrer" href=https://infosec.exchange/@parsiya title=https://infosec.exchange/@parsiya><i class="fa fa-mastodon fa-3x"></i></a>
<a target=_blank rel="noopener noreferrer" href=https://github.com/parsiya/ title=https://github.com/parsiya/><i class="fa fa-github fa-3x"></i></a>
<a target=_blank rel="noopener noreferrer" href=https://twitter.com/cryptogangsta/ title=https://twitter.com/cryptogangsta/><i class="fa fa-twitter fa-3x"></i></a>
<a target=_blank rel="noopener noreferrer" href=https://www.linkedin.com/in/parsiya title=https://www.linkedin.com/in/parsiya><i class="fa fa-linkedin fa-3x"></i></a></li></ul><section class=odd><h1>Collections</h1><li><a href=https://parsiya.net/categories/thick-client-proxying/ title="Thick Client Proxying">Thick Client Proxying</a></li><li><a href=https://parsiya.net/categories/writeup/ title=CTFs/Writeups>CTFs/Writeups</a></li><li><a href=https://parsiya.net/categories/attack-surface-analysis/ title="Attack Surface Analysis">Attack Surface Analysis</a></li><li><a href=https://parsiya.net/categories/static-analysis/ title="Static Analysis">Static Analysis</a></li><li><a href=https://parsiya.net/categories/bug-bounty/ title="Bug Bounty">Bug Bounty</a></li><li><a href=https://parsiya.net/categories/blockchain/ title="Blockchain (lol)">Blockchain (lol)</a></li><li><a href=https://parsiya.net/categories/crypto/ title=Crypto(graphy)>Crypto(graphy)</a></li><li><a href=https://parsiya.net/categories/burp-extension/ title="Burp Extension Development">Burp Extension Development</a></li><li><a href=https://parsiya.net/categories/automation/ title=Automation>Automation</a></li><li><a href=https://parsiya.net/categories/reverse-engineering/ title="Reverse Engineering">Reverse Engineering</a></li><li><a href=https://parsiya.net/categories/winappdbg/ title="WinAppDbg (use Frida instead)">WinAppDbg (use Frida instead)</a></li><li><a href=https://awsome.pw title='AWSome.pw - S3 bucket squatting - my very "legit" branded vulnerability'>AWSome.pw - S3 bucket squatting - my very "legit" branded vulnerability</a></li></section></aside></div></div><footer role=contentinfo><p>Copyright &copy; 2026 Parsia - <a href=https://parsiya.net/license/>License</a> -
<span class=credit>Powered by <a target=_blank href=https://gohugo.io rel="noopener noreferrer">Hugo</a> and <a target=_blank href=https://github.com/parsiya/hugo-octopress/ rel="noopener noreferrer">Hugo-Octopress</a> theme.</p></footer></body></html>