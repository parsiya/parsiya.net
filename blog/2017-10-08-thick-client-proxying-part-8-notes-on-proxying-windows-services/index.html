<!doctype html><html xmlns=http://www.w3.org/1999/xhtml xml:lang=en lang=en-us><head><meta charset=utf-8><meta name=viewport content="width=device-width,minimum-scale=1,maximum-scale=1"><link href=/css/fonts.css rel=stylesheet type=text/css><title>Thick Client Proxying - Part 8 - Notes on Proxying Windows Services</title><link rel=stylesheet href=/css/hugo-octopress.css><link rel=stylesheet href=/css/fork-awesome.min.css><link href=https://parsiya.net/favicon.png rel=icon><meta name=description content><meta name=keywords content="[Parsia Hakimian Parsiya infosec information security]"><meta name=author content="Parsia"><meta name=generator content="Hugo 0.119.0"><meta name=twitter:card content="summary"><meta name=twitter:title content="Thick Client Proxying - Part 8 - Notes on Proxying Windows Services"><meta name=twitter:description content="These are my notes about proxying Windows services. Being run from a different account (usually LocalSystem).
Proxy settings are usually configured per user and are not applicable to Windows services.
If you have to proxy a Windows service, here are some of the things you can try (and hope they work).
There are also some issues when using netsh to set WinHTTP proxies for 32-bit applications on Windows 7 64-bit."><meta name=twitter:domain content="parsiya.net"><meta name=twitter:creator content="@CryptoGangsta"></head><body><header role=banner><hgroup><h1><a href=https://parsiya.net/>Hackerman's Hacking Tutorials</a></h1><h2>The knowledge of anything, since all things have causes, is not acquired or
complete unless it is known by its causes. - Avicenna</h2></hgroup></header><nav role=navigation><fieldset class=mobile-nav><select onchange="location=this.value"><option value>Navigate…</option><option value=https://parsiya.net/about/>» About Me!</option><option value=https://parsiya.net/cheatsheet/>» Cheat Sheet</option><option value=https://parsiya.io/>» My Clone</option><option value=https://github.com/parsiya/parsiya.net>» Source Repo</option><option value="https://queue.acm.org/detail.cfm?id=3197520">» Manual Work is a Bug</option><option value="https://www.google.com/search?q=andrew+ridgeley">» The Other Guy from Wham!</option></select></fieldset><ul class=main-navigation><li><a href=https://parsiya.net/about/ title="About Me!" target=_blank rel="noopener noreferrer">About Me!</a></li><li><a href=https://parsiya.net/cheatsheet/ title="Cheat Sheet" target=_blank rel="noopener noreferrer">Cheat Sheet</a></li><li><a href=https://parsiya.io/ title="My Clone" target=_blank rel="noopener noreferrer">My Clone</a></li><li><a href=https://github.com/parsiya/parsiya.net title="Source Repo" target=_blank rel="noopener noreferrer">Source Repo</a></li><li><a href="https://queue.acm.org/detail.cfm?id=3197520" title="Manual Work is a Bug" target=_blank rel="noopener noreferrer">Manual Work is a Bug</a></li><li><a href="https://www.google.com/search?q=andrew+ridgeley" title="The Other Guy from Wham!" target=_blank rel="noopener noreferrer">The Other Guy from Wham!</a></li></ul><ul class=subscription><a href=https://parsiya.net/index.xml target=_blank type=application/rss+xml title=RSS rel="noopener noreferrer"><i class="fa fa-rss-square fa-lg"></i></a></ul><form action=https://www.google.com/search method=get target=_blank rel="noopener noreferrer"><fieldset role=search><input class=search type=text name=q results=0 placeholder=Search>
<input type=hidden name=q value=site:https://parsiya.net/></fieldset></form></nav><div id=main><div id=content><div><article class=hentry role=article><header><p class=meta>Oct 8, 2017
- 4 minute read
- <a href=https://parsiya.net/blog/2017-10-08-thick-client-proxying-part-8-notes-on-proxying-windows-services/#disqus_thread>Comments</a>
- <a class=label href=https://parsiya.net/categories/thick-client-proxying/>Thick Client Proxying </a><a class=label href=https://parsiya.net/categories/windows-service/>Windows Service</a></p><h1 class=entry-title>Thick Client Proxying - Part 8 - Notes on Proxying Windows Services</h1></header><div class=entry-content><p>These are my notes about proxying Windows services. Being run from a different account (usually LocalSystem).</p><p>Proxy settings are usually configured per user and are not applicable to Windows services.</p><p>If you have to proxy a Windows service, here are some of the things you can try (and hope they work).</p><p>There are also some issues when using <code>netsh</code> to set WinHTTP proxies for 32-bit applications on Windows 7 64-bit.</p><ul><li><a href=#some-background-knowledge>Some Background Knowledge</a></li><li><a href=#traditional-techniques-or-try-these-anyways>Traditional Techniques or "Try These Anyways"</a><ul><li><a href=#wininet-or-internet-explorer-proxy-settings>WinINET or Internet Explorer Proxy Settings</a></li><li><a href=#winhttp-proxy-settings>WinHTTP Proxy Settings</a><ul><li><a href=#netsh-winhttp-for-32-bit-processes-on-windows-7-64-bit>netsh winhttp for 32-bit Processes on Windows 7 64-bit</a></li></ul></li><li><a href=#run-the-service-executable-manually>Run the Service Executable Manually</a></li><li><a href=#disable-per-user-wininet-proxy-settings>Disable Per-User WinINET Proxy Settings</a></li><li><a href=#net-config-file>.NET Config File</a></li><li><a href=#net-framework-machine-configuration-file>.NET Framework Machine Configuration File</a></li></ul></li></ul><p><a name=some-background-knowledge></a></p><h1 id=some-background-knowledge>Some Background Knowledge
<a class=header-link href=#some-background-knowledge><svg class="fill-current o-60 hover-accent-color-light" height="22" viewBox="0 0 24 24" width="22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="none"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h1><ul><li><a href=https://blogs.msdn.microsoft.com/ieinternals/2013/10/11/understanding-web-proxy-configuration/ target=_blank rel="noreferrer noopener">Understanding Web Proxy Configuration - MSDN</a>. This is a pretty useful read for Windows proxying. If you have to choose between this blog and that article, choose the MSDN article.</li><li><a href=https://parsiya.net/blog/2016-07-28-thick-client-proxying-part-6-how-https-proxies-work/ title="Thick Client Proxying - Part 6: How HTTPs Proxies Work">Part 6 - How HTTP(s) Proxies Work</a></li></ul><p><a name=traditional-techniques-or-try-these-anyways></a></p><h1 id=traditional-techniques-or-try-these-anyways>Traditional Techniques or "Try These Anyways"
<a class=header-link href=#traditional-techniques-or-try-these-anyways><svg class="fill-current o-60 hover-accent-color-light" height="22" viewBox="0 0 24 24" width="22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="none"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h1><p>These are things that usually work for most Windows applications.</p><p><a name=wininet-or-internet-explorer-proxy-settings></a></p><h2 id=wininet-or-internet-explorer-proxy-settings>WinINET or Internet Explorer Proxy Settings
<a class=header-link href=#wininet-or-internet-explorer-proxy-settings><svg class="fill-current o-60 hover-accent-color-light" height="22" viewBox="0 0 24 24" width="22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="none"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h2><p>Usually called the Internet Explorer proxy settings. These usually work for most <a href=https://parsiya.net/blog/2016-07-28-thick-client-proxying-part-6-how-https-proxies-work/#5-proxy-aware-clients title="What are Proxy-Aware Clients">proxy-aware</a> applications.</p><p>Shortcut <code>control inetcpl.cpl,,4</code>.</p><p><a name=winhttp-proxy-settings></a></p><h2 id=winhttp-proxy-settings>WinHTTP Proxy Settings
<a class=header-link href=#winhttp-proxy-settings><svg class="fill-current o-60 hover-accent-color-light" height="22" viewBox="0 0 24 24" width="22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="none"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h2><p>WinHTTP is generally the proxy for Windows services. You can either set specific proxies or tell it to import IE proxy settings (see above).</p><p>Run in admin command prompt:</p><ul><li>Use IE: <code>netsh winhttp import proxy source=ie</code>. Note: You need to set WinINET settings <strong>before</strong> this command. This command uses a snapshot of IE settings and imports them. If you change IE settings after, it will not get updated and you have to run it again.</li><li>Set proxy: <code>netsh winhttp set proxy proxy-server="http=localhost:8080;https=localhost:8443" bypass-list="*.whatever.com;localhost"</code>.</li><li>Reset proxy: <code>netsh winhttp reset proxy</code>.</li></ul><p>More info: <a href="https://technet.microsoft.com/en-us/library/cc731131%28v=ws.10%29.aspx#BKMK_5" target=_blank rel="noreferrer noopener">MSDN - Netsh Commands for Windows Hypertext Transfer Protocol (WINHTTP)</a></p><p>Location in registry:</p><ul><li><p>64-bit (note the line-broken "Internet Settings"):</p><ul><li><p><code>HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Internet Settings\Connections\WinHttpSetting</code></p><ul><li>You will see something like this:</li></ul><div class=highlight><pre tabindex=0 style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span><span style=color:#2aa198>0000</span>  <span style=color:#2aa198>28</span> <span style=color:#2aa198>00</span> <span style=color:#2aa198>00</span> <span style=color:#2aa198>00</span> <span style=color:#2aa198>00</span> <span style=color:#2aa198>00</span> <span style=color:#2aa198>00</span> <span style=color:#2aa198>00</span> <span style=color:#2aa198>03</span> <span style=color:#2aa198>00</span> <span style=color:#2aa198>00</span> <span style=color:#2aa198>00</span> <span style=color:#2aa198>28</span> <span style=color:#2aa198>00</span> <span style=color:#2aa198>00</span> <span style=color:#2aa198>00</span>  |(...........(...|
</span></span><span style=display:flex><span><span style=color:#2aa198>0010</span>  <span style=color:#2aa198>68</span> <span style=color:#2aa198>74</span> <span style=color:#2aa198>74</span> <span style=color:#2aa198>70</span> <span style=color:#2aa198>3d</span> 6c <span style=color:#2aa198>6f</span> <span style=color:#2aa198>63</span> <span style=color:#2aa198>61</span> 6c <span style=color:#2aa198>68</span> <span style=color:#2aa198>6f</span> <span style=color:#2aa198>73</span> <span style=color:#2aa198>74</span> 3a <span style=color:#2aa198>38</span>  |http=localhost:<span style=color:#2aa198>8</span>|
</span></span><span style=display:flex><span><span style=color:#2aa198>0020</span>  <span style=color:#2aa198>30</span> <span style=color:#2aa198>38</span> <span style=color:#2aa198>30</span> 3b <span style=color:#2aa198>68</span> <span style=color:#2aa198>74</span> <span style=color:#2aa198>74</span> <span style=color:#2aa198>70</span> <span style=color:#2aa198>73</span> <span style=color:#2aa198>3d</span> 6c <span style=color:#2aa198>6f</span> <span style=color:#2aa198>63</span> <span style=color:#2aa198>61</span> 6c <span style=color:#2aa198>68</span>  |<span style=color:#2aa198>080</span>;https=localh|
</span></span><span style=display:flex><span><span style=color:#2aa198>0030</span>  <span style=color:#2aa198>6f</span> <span style=color:#2aa198>73</span> <span style=color:#2aa198>74</span> 3a <span style=color:#2aa198>38</span> <span style=color:#2aa198>34</span> <span style=color:#2aa198>34</span> <span style=color:#2aa198>33</span> <span style=color:#2aa198>18</span> <span style=color:#2aa198>00</span> <span style=color:#2aa198>00</span> <span style=color:#2aa198>00</span> 2a 2e <span style=color:#2aa198>77</span> <span style=color:#2aa198>68</span>  |ost:<span style=color:#2aa198>8443</span>....*.wh|
</span></span><span style=display:flex><span><span style=color:#2aa198>0040</span>  <span style=color:#2aa198>61</span> <span style=color:#2aa198>74</span> <span style=color:#2aa198>65</span> <span style=color:#2aa198>76</span> <span style=color:#2aa198>65</span> <span style=color:#2aa198>72</span> 2e <span style=color:#2aa198>63</span> <span style=color:#2aa198>6f</span> <span style=color:#2aa198>6d</span> 3b 6c <span style=color:#2aa198>6f</span> <span style=color:#2aa198>63</span> <span style=color:#2aa198>61</span> 6c  |atever.com;local|
</span></span><span style=display:flex><span><span style=color:#2aa198>0050</span>  <span style=color:#2aa198>68</span> <span style=color:#2aa198>6f</span> <span style=color:#2aa198>73</span> <span style=color:#2aa198>74</span>                                      |host|
</span></span></code></pre></div></li><li><p><code>HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Internet Settings\WinHttp</code></p></li></ul></li><li><p>32-bit:</p><ul><li><code>HKLM\SOFTWARE\Wow6432Node\Microsoft\Windows\CurrentVersion\Internet Settings\Connections\WinHttpSettings</code></li><li><code>HKLM\SOFTWARE\Wow6432Node\Microsoft\Windows\CurrentVersion\Internet Settings\WinHttp</code></li></ul></li></ul><p><a name=netsh-winhttp-for-32-bit-processes-on-windows-7-64-bit></a></p><h3 id=netsh-winhttp-for-32-bit-processes-on-windows-7-64-bit>netsh winhttp for 32-bit Processes on Windows 7 64-bit
<a class=header-link href=#netsh-winhttp-for-32-bit-processes-on-windows-7-64-bit><svg class="fill-current o-60 hover-accent-color-light" height="22" viewBox="0 0 24 24" width="22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="none"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h3><p>Due to the way 32-bit emulation works, they have their own registry and "system32":</p><ul><li>registry hive: <code>hive\Software\Wow6432Node</code>. E.g. <code>HKCU\Software\Wow6432Node\Microsoft\Windows</code></li><li>system32: <code>%WINDIR%\SysWOW64</code>. E.g. <code>C:\windows\SysWOW64</code></li></ul><p>On Windows 7, when you use <code>netsh</code> to write WinHTTP proxy settings, only the 64-bit registry keys are changed. For 32-bit apps you need to explicitly run <code>%WINDIR%\SysWOW64\netsh.exe</code>.</p><div class=highlight><pre tabindex=0 style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span><span style=color:#586e75># change winhttp proxy setting</span>
</span></span><span style=display:flex><span>C:\&gt;netsh winhttp import proxy source=ie
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Current WinHTTP proxy settings:
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    Proxy Server(s) :  localhost:<span style=color:#2aa198>8100</span>
</span></span><span style=display:flex><span>    Bypass List     :  (none)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#586e75># not modified for 32-bit applications</span>
</span></span><span style=display:flex><span>C:\&gt;c:\Windows\SysWOW64\netsh.exe winhttp show proxy
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Current WinHTTP proxy settings:
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    Direct access (no proxy server).
</span></span></code></pre></div><p>Presumably this has been fixed for later versions of Windows, but double-check to be sure.</p><p><a name=run-the-service-executable-manually></a></p><h2 id=run-the-service-executable-manually>Run the Service Executable Manually
<a class=header-link href=#run-the-service-executable-manually><svg class="fill-current o-60 hover-accent-color-light" height="22" viewBox="0 0 24 24" width="22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="none"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h2><p>This might help bring it under your "jurisdiction" and thus your proxy settings will apply. By default each user has their own proxy settings.</p><p>You can use <a href=https://docs.microsoft.com/en-us/sysinternals/downloads/process-explorer target=_blank rel="noreferrer noopener">Process Explorer</a> or <a href=https://docs.microsoft.com/en-us/sysinternals/downloads/procmon target=_blank rel="noreferrer noopener">Process Monitor</a> or other tools to discover the parameters to run the service (if any).</p><p><a name=disable-per-user-wininet-proxy-settings></a></p><h2 id=disable-per-user-wininet-proxy-settings>Disable Per-User WinINET Proxy Settings
<a class=header-link href=#disable-per-user-wininet-proxy-settings><svg class="fill-current o-60 hover-accent-color-light" height="22" viewBox="0 0 24 24" width="22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="none"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h2><p>By default they are per-user, you set the following registry key to <code>0</code>:</p><ul><li><code>HKLM\SOFTWARE\Policies\Microsoft\Windows\CurrentVersion\Internet Settings\ProxySettingsPerUser</code></li></ul><p><strong>But after this change you will need admin access to modify proxy settings.</strong></p><p><a name=net-config-file></a></p><h2 id=net-config-file>.NET Config File
<a class=header-link href=#net-config-file><svg class="fill-current o-60 hover-accent-color-light" height="22" viewBox="0 0 24 24" width="22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="none"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h2><p>See detailed info in <a href=https://parsiya.net/blog/2017-10-07-thick-client-proxying-part-7-proxying-.net-applications-via-config-file/ title="Thick Client Proxying">part 7</a></p><p>.NET applications can read settings from config files. This is an XML file named <code>applicationName.exe.config</code>.</p><p>Add these settings (<code>configuration</code> is already present in existing config files):</p><div class=highlight><pre tabindex=0 style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=display:flex><span><span style=color:#268bd2>&lt;configuration&gt;</span> 
</span></span><span style=display:flex><span>  <span style=color:#268bd2>&lt;system.net&gt;</span>  
</span></span><span style=display:flex><span>    <span style=color:#268bd2>&lt;defaultProxy&gt;</span>  
</span></span><span style=display:flex><span>      <span style=color:#268bd2>&lt;proxy</span>  
</span></span><span style=display:flex><span>        usesystemdefault=<span style=color:#2aa198>&#34;true&#34;</span>   // use IE proxy settings
</span></span><span style=display:flex><span>        proxyaddress=<span style=color:#2aa198>&#34;http://192.168.1.10:3128&#34;</span>  // remember to keep &#34;http://&#34; here
</span></span><span style=display:flex><span>        bypassonlocal=<span style=color:#2aa198>&#34;true&#34;</span>  
</span></span><span style=display:flex><span>      <span style=color:#268bd2>/&gt;</span>  
</span></span><span style=display:flex><span>      <span style=color:#268bd2>&lt;bypasslist&gt;</span>  
</span></span><span style=display:flex><span>        <span style=color:#268bd2>&lt;add</span> address=<span style=color:#2aa198>&#34;[a-z]+\.contoso\.com&#34;</span> <span style=color:#268bd2>/&gt;</span>  
</span></span><span style=display:flex><span>      <span style=color:#268bd2>&lt;/bypasslist&gt;</span>  
</span></span><span style=display:flex><span>    <span style=color:#268bd2>&lt;/defaultProxy&gt;</span>  
</span></span><span style=display:flex><span>  <span style=color:#268bd2>&lt;/system.net&gt;</span>  
</span></span><span style=display:flex><span><span style=color:#268bd2>&lt;/configuration&gt;</span>  
</span></span></code></pre></div><p>Note <code>usesystemdefault</code> and <code>proxyaddress</code> are mutually exclusive.</p><ul><li>Keep <code>http://</code> in <code>proxy address</code> even if you are using an HTTPS proxy like Burp, it will proxy TLS.</li><li>Often <code>usesystemdefault</code> does not work because your user and the user running the service are different and have their own proxy settings. Running the service binary manually may help.</li></ul><p>Use tools like <a href=https://docs.microsoft.com/en-us/sysinternals/downloads/procmon target=_blank rel="noreferrer noopener">process monitor</a> to detect if the application is looking for this or any other config file.</p><p><a name=net-framework-machine-configuration-file></a></p><h2 id=net-framework-machine-configuration-file>.NET Framework Machine Configuration File
<a class=header-link href=#net-framework-machine-configuration-file><svg class="fill-current o-60 hover-accent-color-light" height="22" viewBox="0 0 24 24" width="22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="none"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h2><p>You can use a similar config file for the entire machine. Meaning any application running via that .NET framework will use those settings.</p><p>Location is <code>%WINDIR%\Microsoft.NET\Framework|Framework64\[version]\Config\machine.config</code>.</p><p>Note that you need to change the config for both 32 and 64-bit frameworks (Framework|Framework64) and each version (e.g. 2, 3 or 4) separately.</p><p>For example for 64-bit .NET Framework 4.x (anything 4.x is under 4):</p><ul><li><code>C:\Windows\Microsoft.NET\Framework64\v4.0.30319\Config</code></li></ul><p>To learn more about the config file (which is really recommended) see file <code>machine.config.comments</code> in the same location. It has comments and examples.</p></div><footer><p class=meta><span class="byline author vcard">Posted by <span class=fn>Parsia</span></span>
<time>Oct 8, 2017</time>
<span class=categories>Tags:
<a class=category href=https://parsiya.net/tags/wininet>wininet</a> <a class=category href=https://parsiya.net/tags/winhttp>winhttp</a> <a class=category href=https://parsiya.net/tags/netsh>netsh</a></span></p><p class=meta><a class="basic-alignment left" href=https://parsiya.net/blog/2017-10-07-thick-client-proxying-part-7-proxying-.net-applications-via-config-file/ title="Thick Client Proxying - Part 7 - Proxying .NET Applications via Config File">Thick Client Proxying - Part 7 - Proxying .NET Applications via Config File</a>
<a class="basic-alignment right" href=https://parsiya.net/blog/2017-10-23-run-line-vs.-cmd-vs.-powershell/ title="Run Line vs. cmd vs. PowerShell">Run Line vs. cmd vs. PowerShell</a></p><div id=disqus_thread></div><script type=application/javascript>window.disqus_config=function(){},function(){if(["localhost","127.0.0.1"].indexOf(window.location.hostname)!=-1){document.getElementById("disqus_thread").innerHTML="Disqus comments not available by default when the website is previewed locally.";return}var t=document,e=t.createElement("script");e.async=!0,e.src="//parsiya.disqus.com/embed.js",e.setAttribute("data-timestamp",+new Date),(t.head||t.body).appendChild(e)}()</script><noscript>Please enable JavaScript to view the <a href=https://disqus.com/?ref_noscript>comments powered by Disqus.</a></noscript><a href=https://disqus.com class=dsq-brlink>comments powered by <span class=logo-disqus>Disqus</span></a></footer></article></div><aside class="sidebar thirds"><section class="first odd"><h1>Who am I?</h1><p><p>I am Parsia, an application security engineer.</p><p>I write about application security, cryptography, static analysis, and
(of course) videogames.</p><p>Click on <a href=/about/>About Me!</a> to know more.</p></p></section><ul class=sidebar-nav><li class=sidebar-nav-item><a target=_blank rel="me noopener noreferrer" href=https://infosec.exchange/@parsiya title=https://infosec.exchange/@parsiya><i class="fa fa-mastodon fa-3x"></i></a>
<a target=_blank rel="noopener noreferrer" href=https://github.com/parsiya/ title=https://github.com/parsiya/><i class="fa fa-github fa-3x"></i></a>
<a target=_blank rel="noopener noreferrer" href=https://twitter.com/cryptogangsta/ title=https://twitter.com/cryptogangsta/><i class="fa fa-twitter fa-3x"></i></a>
<a target=_blank rel="noopener noreferrer" href=https://www.linkedin.com/in/parsiya title=https://www.linkedin.com/in/parsiya><i class="fa fa-linkedin fa-3x"></i></a></li></ul><section class=odd><h1>Collections</h1><li><a href=https://parsiya.net/categories/thick-client-proxying/ title="Thick Client Proxying">Thick Client Proxying</a></li><li><a href=https://parsiya.net/categories/writeup/ title=CTFs/Writeups>CTFs/Writeups</a></li><li><a href=https://parsiya.net/categories/attack-surface-analysis/ title="Attack Surface Analysis">Attack Surface Analysis</a></li><li><a href=https://parsiya.net/categories/semgrep/ title=Semgrep>Semgrep</a></li><li><a href=https://parsiya.net/categories/bug-bounty/ title="Bug Bounty">Bug Bounty</a></li><li><a href=https://parsiya.net/categories/blockchain/ title="Blockchain (lol)">Blockchain (lol)</a></li><li><a href=https://parsiya.net/categories/crypto/ title=Crypto(graphy)>Crypto(graphy)</a></li><li><a href=https://parsiya.net/categories/burp-extension/ title="Burp Extension Development">Burp Extension Development</a></li><li><a href=https://parsiya.net/categories/automation/ title=Automation>Automation</a></li><li><a href=https://parsiya.net/categories/reverse-engineering/ title="Reverse Engineering">Reverse Engineering</a></li><li><a href=https://parsiya.net/categories/winappdbg/ title="WinAppDbg (use Frida instead)">WinAppDbg (use Frida instead)</a></li><li><a href=https://awsome.pw title='AWSome.pw - S3 bucket squatting - my very "legit" branded vulnerability'>AWSome.pw - S3 bucket squatting - my very "legit" branded vulnerability</a></li></section></aside></div></div><footer role=contentinfo><p>Copyright &copy; 2023 Parsia - <a href=https://parsiya.net/license/>License</a> -
<span class=credit>Powered by <a target=_blank href=https://gohugo.io rel="noopener noreferrer">Hugo</a> and <a target=_blank href=https://github.com/parsiya/hugo-octopress/ rel="noopener noreferrer">Hugo-Octopress</a> theme.</p></footer></body></html>