<!doctype html><html xmlns=http://www.w3.org/1999/xhtml xml:lang=en lang=en-us><head><meta charset=utf-8><meta name=viewport content="width=device-width,minimum-scale=1,maximum-scale=1"><link href=/css/fonts.css rel=stylesheet type=text/css><title>Pasting Shellcode in GDB using Python</title><link rel=stylesheet href=/css/hugo-octopress.css><link rel=stylesheet href=/css/fork-awesome.min.css><link href=https://parsiya.net/favicon.png rel=icon><meta name=description content><meta name=keywords content="[Parsia Hakimian Parsiya infosec information security]"><meta name=author content="Parsia"><meta name=generator content="Hugo 0.148.1"><meta name=twitter:card content="summary"><meta name=twitter:title content="Pasting Shellcode in GDB using Python"><meta name=twitter:description content='A few days ago I was trying to write an exploit for a buffer overflow with GDB. This was a console application and pasting shellcode would mess with it.
There are a few options:

Writing shellcode to a file and then using it as input for GDB.

# you can also include GDB commands like setting up breakpoints (e.g. b * 0xDEADBEEF)
# remember to include a new line after each command
$ python -c &#39;print "b * 0xDEADBEEF" + "\n" + "\x41"*1000 + "\n"&#39; > input

# $ perl -e for perl

# start debugging with GDB
# -q (quiet mode): no text at startup
$ gdb executable1 -q
(gdb) run < input
After this you can manually debug in GDB.'><meta name=twitter:domain content="parsiya.net"><meta name=twitter:creator content="@CryptoGangsta"></head><body><header role=banner><hgroup><h1><a href=https://parsiya.net/>Hackerman's Hacking Tutorials</a></h1><h2>The knowledge of anything, since all things have causes, is not acquired or
complete unless it is known by its causes. - Avicenna</h2></hgroup></header><nav role=navigation><fieldset class=mobile-nav><select onchange="location=this.value"><option value>Navigate…</option><option value=https://parsiya.net/about/>» About Me!</option><option value=https://parsiya.net/cheatsheet/>» Cheat Sheet</option><option value=https://parsiya.io/>» My Clone</option><option value=https://github.com/parsiya/parsiya.net>» Source Repo</option><option value="https://queue.acm.org/detail.cfm?id=3197520">» Manual Work is a Bug</option><option value="https://www.google.com/search?q=andrew+ridgeley">» The Other Guy from Wham!</option></select></fieldset><ul class=main-navigation><li><a href=https://parsiya.net/about/ title="About Me!" target=_blank rel="noopener noreferrer">About Me!</a></li><li><a href=https://parsiya.net/cheatsheet/ title="Cheat Sheet" target=_blank rel="noopener noreferrer">Cheat Sheet</a></li><li><a href=https://parsiya.io/ title="My Clone" target=_blank rel="noopener noreferrer">My Clone</a></li><li><a href=https://github.com/parsiya/parsiya.net title="Source Repo" target=_blank rel="noopener noreferrer">Source Repo</a></li><li><a href="https://queue.acm.org/detail.cfm?id=3197520" title="Manual Work is a Bug" target=_blank rel="noopener noreferrer">Manual Work is a Bug</a></li><li><a href="https://www.google.com/search?q=andrew+ridgeley" title="The Other Guy from Wham!" target=_blank rel="noopener noreferrer">The Other Guy from Wham!</a></li></ul><ul class=subscription><a href=https://parsiya.net/index.xml target=_blank type=application/rss+xml title=RSS rel="noopener noreferrer"><i class="fa fa-rss-square fa-lg"></i></a></ul><form action=https://www.google.com/search method=get target=_blank rel="noopener noreferrer"><fieldset role=search><input class=search type=text name=q results=0 placeholder=Search>
<input type=hidden name=q value=site:https://parsiya.net/></fieldset></form></nav><div id=main><div id=content><div><article class=hentry role=article><header><p class=meta>May 25, 2014
- 2 minute read
- <a class=label href=https://parsiya.net/categories/python/>Python</a></p><h1 class=entry-title>Pasting Shellcode in GDB using Python</h1></header><div class=entry-content><p>A few days ago I was trying to write an exploit for a buffer overflow with GDB. This was a console application and pasting shellcode would mess with it.</p><p>There are a few options:</p><ul><li>Writing shellcode to a file and then using it as input for GDB.</li></ul><div class=highlight><pre tabindex=0 style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#586e75># you can also include GDB commands like setting up breakpoints (e.g. b * 0xDEADBEEF)</span>
</span></span><span style=display:flex><span><span style=color:#586e75># remember to include a new line after each command</span>
</span></span><span style=display:flex><span>$ python <span style=color:#719e07>-</span>c <span style=color:#2aa198>&#39;print &#34;b * 0xDEADBEEF&#34; + &#34;</span><span style=color:#cb4b16>\n</span><span style=color:#2aa198>&#34; + &#34;</span><span style=color:#cb4b16>\x41</span><span style=color:#2aa198>&#34;*1000 + &#34;</span><span style=color:#cb4b16>\n</span><span style=color:#2aa198>&#34;&#39;</span> <span style=color:#719e07>&gt;</span> <span style=color:#b58900>input</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#586e75># $ perl -e for perl</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#586e75># start debugging with GDB</span>
</span></span><span style=display:flex><span><span style=color:#586e75># -q (quiet mode): no text at startup</span>
</span></span><span style=display:flex><span>$ gdb executable1 <span style=color:#719e07>-</span>q
</span></span><span style=display:flex><span>(gdb) run <span style=color:#719e07>&lt;</span> <span style=color:#b58900>input</span>
</span></span></code></pre></div><p>After this you can manually debug in GDB.</p><ul><li>Writing a Python script for interactive debugging
When I wrote this, I thought it was a clever idea but then someone told me I could have written a GDB script. However, I have already written this snippet so here it goes.</li></ul><div class=highlight><pre tabindex=0 style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#586e75>#!/usr/bin/python</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#719e07>from</span> subprocess <span style=color:#719e07>import</span> Popen , PIPE
</span></span><span style=display:flex><span><span style=color:#719e07>from</span> time <span style=color:#719e07>import</span> sleep
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#586e75># shellcode</span>
</span></span><span style=display:flex><span>shellcode <span style=color:#719e07>=</span> <span style=color:#2aa198>&#34;</span><span style=color:#cb4b16>\x41</span><span style=color:#2aa198>&#34;</span> <span style=color:#719e07>*</span> <span style=color:#2aa198>1000</span> <span style=color:#719e07>+</span> <span style=color:#2aa198>&#34;</span><span style=color:#cb4b16>\n</span><span style=color:#2aa198>&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#586e75># opens gdb with parameter executable</span>
</span></span><span style=display:flex><span><span style=color:#586e75># you can also manage stdout and stderr here</span>
</span></span><span style=display:flex><span>proc <span style=color:#719e07>=</span> Popen( [<span style=color:#2aa198>&#39;gdb&#39;</span> , <span style=color:#2aa198>&#39;executable&#39;</span>] , bufsize<span style=color:#719e07>=</span><span style=color:#2aa198>1</span> ,stdin<span style=color:#719e07>=</span>PIPE )
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#586e75># sample breakpoint</span>
</span></span><span style=display:flex><span><span style=color:#586e75># notice the new line after each command</span>
</span></span><span style=display:flex><span>proc<span style=color:#719e07>.</span>stdin<span style=color:#719e07>.</span>write(<span style=color:#2aa198>&#39;b *DEADBEEF</span><span style=color:#cb4b16>\n</span><span style=color:#2aa198>&#39;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#586e75># half a second of sleep after each command</span>
</span></span><span style=display:flex><span>sleep(<span style=color:#2aa198>0.5</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#586e75># r or run to start debugging the program with GDB</span>
</span></span><span style=display:flex><span>proc<span style=color:#719e07>.</span>stdin<span style=color:#719e07>.</span>write(<span style=color:#2aa198>&#39;r</span><span style=color:#cb4b16>\n</span><span style=color:#2aa198>&#39;</span>)
</span></span><span style=display:flex><span>sleep(<span style=color:#2aa198>0.5</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#586e75># any other commands go here</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#586e75># this is a loop, will get every command and pass it to GDB</span>
</span></span><span style=display:flex><span><span style=color:#586e75># &#34;leave&#34; == quit GDB and terminate process</span>
</span></span><span style=display:flex><span><span style=color:#586e75># &#34;dump&#34;  == paste shellcode</span>
</span></span><span style=display:flex><span><span style=color:#719e07>while</span> <span style=color:#cb4b16>True</span>:
</span></span><span style=display:flex><span>    mycommand <span style=color:#719e07>=</span> raw_input()
</span></span><span style=display:flex><span>    <span style=color:#719e07>if</span> (mycommand <span style=color:#719e07>==</span> <span style=color:#2aa198>&#34;leave&#34;</span>):
</span></span><span style=display:flex><span>        <span style=color:#586e75># quit gdb</span>
</span></span><span style=display:flex><span>        proc<span style=color:#719e07>.</span>stdin<span style=color:#719e07>.</span>write(<span style=color:#2aa198>&#34;quit</span><span style=color:#cb4b16>\n</span><span style=color:#2aa198>&#34;</span>)
</span></span><span style=display:flex><span>        <span style=color:#719e07>break</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#586e75># paste shellcode</span>
</span></span><span style=display:flex><span>    <span style=color:#719e07>if</span> (mycommand <span style=color:#719e07>==</span> <span style=color:#2aa198>&#34;dump&#34;</span>):
</span></span><span style=display:flex><span>        proc<span style=color:#719e07>.</span>stdin<span style=color:#719e07>.</span>write(shellcode)
</span></span><span style=display:flex><span>    <span style=color:#586e75># more custom commands go here</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#586e75># not a custom command? send it as-is</span>
</span></span><span style=display:flex><span>    <span style=color:#719e07>else</span>:
</span></span><span style=display:flex><span>        mycommand <span style=color:#719e07>=</span> mycommand <span style=color:#719e07>+</span> <span style=color:#2aa198>&#39;</span><span style=color:#cb4b16>\n</span><span style=color:#2aa198>&#39;</span>
</span></span><span style=display:flex><span>        proc<span style=color:#719e07>.</span>stdin<span style=color:#719e07>.</span>write(mycommand)
</span></span><span style=display:flex><span>        sleep(<span style=color:#2aa198>0.5</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#586e75># close our pipe</span>
</span></span><span style=display:flex><span>proc<span style=color:#719e07>.</span>stdin<span style=color:#719e07>.</span>close()
</span></span></code></pre></div><p>I think that this code can be modified and become a very simple fuzzer. We have control over stdin and can read stdout and stderr. Change input, record output, rinse and repeat.</p><p><code>subprocess</code> is a very powerful module. For example to normally run an application with an argument we can write <code>subprocess.call(['gdb','executable']) .</code></p><p>but let's say we want to run executable with input (containing shellcode):</p><div class=highlight><pre tabindex=0 style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#719e07>import</span> subprocess
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>shellcode <span style=color:#719e07>=</span> <span style=color:#2aa198>&#34;</span><span style=color:#cb4b16>\x41</span><span style=color:#2aa198>&#34;</span> <span style=color:#719e07>*</span> <span style=color:#2aa198>100</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>subprocess<span style=color:#719e07>.</span>call( [<span style=color:#2aa198>&#39;gdb&#39;</span> , <span style=color:#2aa198>&#39;executable&#39;</span>] , shellcode)
</span></span></code></pre></div></div><footer><p class=meta><span class="byline author vcard">Posted by <span class=fn>Parsia</span></span><time>May 25, 2014</time>
<span class=categories>Tags:<a class=category href=https://parsiya.net/tags/python>Python</a> <a class=category href=https://parsiya.net/tags/shellcode>Shellcode</a> <a class=category href=https://parsiya.net/tags/interactive-debugging>Interactive Debugging</a></span></p><p class=meta><a class="basic-alignment left" href=https://parsiya.net/blog/2014-04-22-amazon-s3-and-css/ title="Amazon S3 and CSS">Amazon S3 and CSS</a>
<a class="basic-alignment right" href=https://parsiya.net/blog/2014-06-25-piping-ssl/tls-traffic-from-soapui-to-burp/ title="Piping SSL/TLS Traffic from SoapUI to Burp">Piping SSL/TLS Traffic from SoapUI to Burp</a></p></footer></article></div><aside class="sidebar thirds"><section class="first odd"><h1>Who am I?</h1><p><p>I am Parsia, a security engineer at Microsoft.</p><p>I write about application security, cryptography, static analysis, and
(of course) videogames.</p><p>Click on <a href=/about/>About Me!</a> to know more. Contact me via any of these ways.</p></p></section><ul class=sidebar-nav><li class=sidebar-nav-item><a target=_blank rel="me noopener noreferrer" href=https://infosec.exchange/@parsiya title=https://infosec.exchange/@parsiya><i class="fa fa-mastodon fa-3x"></i></a>
<a target=_blank rel="noopener noreferrer" href=https://github.com/parsiya/ title=https://github.com/parsiya/><i class="fa fa-github fa-3x"></i></a>
<a target=_blank rel="noopener noreferrer" href=https://twitter.com/cryptogangsta/ title=https://twitter.com/cryptogangsta/><i class="fa fa-twitter fa-3x"></i></a>
<a target=_blank rel="noopener noreferrer" href=https://www.linkedin.com/in/parsiya title=https://www.linkedin.com/in/parsiya><i class="fa fa-linkedin fa-3x"></i></a></li></ul><section class=odd><h1>Collections</h1><li><a href=https://parsiya.net/categories/thick-client-proxying/ title="Thick Client Proxying">Thick Client Proxying</a></li><li><a href=https://parsiya.net/categories/writeup/ title=CTFs/Writeups>CTFs/Writeups</a></li><li><a href=https://parsiya.net/categories/attack-surface-analysis/ title="Attack Surface Analysis">Attack Surface Analysis</a></li><li><a href=https://parsiya.net/categories/static-analysis/ title="Static Analysis">Static Analysis</a></li><li><a href=https://parsiya.net/categories/bug-bounty/ title="Bug Bounty">Bug Bounty</a></li><li><a href=https://parsiya.net/categories/blockchain/ title="Blockchain (lol)">Blockchain (lol)</a></li><li><a href=https://parsiya.net/categories/crypto/ title=Crypto(graphy)>Crypto(graphy)</a></li><li><a href=https://parsiya.net/categories/burp-extension/ title="Burp Extension Development">Burp Extension Development</a></li><li><a href=https://parsiya.net/categories/automation/ title=Automation>Automation</a></li><li><a href=https://parsiya.net/categories/reverse-engineering/ title="Reverse Engineering">Reverse Engineering</a></li><li><a href=https://parsiya.net/categories/winappdbg/ title="WinAppDbg (use Frida instead)">WinAppDbg (use Frida instead)</a></li><li><a href=https://awsome.pw title='AWSome.pw - S3 bucket squatting - my very "legit" branded vulnerability'>AWSome.pw - S3 bucket squatting - my very "legit" branded vulnerability</a></li></section></aside></div></div><footer role=contentinfo><p>Copyright &copy; 2025 Parsia - <a href=https://parsiya.net/license/>License</a> -
<span class=credit>Powered by <a target=_blank href=https://gohugo.io rel="noopener noreferrer">Hugo</a> and <a target=_blank href=https://github.com/parsiya/hugo-octopress/ rel="noopener noreferrer">Hugo-Octopress</a> theme.</p></footer></body></html>