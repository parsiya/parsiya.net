<!doctype html><html xmlns=http://www.w3.org/1999/xhtml xml:lang=en lang=en-us>
<head>
<meta charset=utf-8>
<meta name=viewport content="width=device-width,minimum-scale=1,maximum-scale=1">
<link href=/css/fonts.css rel=stylesheet type=text/css>
<title>ContextIS xmas CTF Writeup</title>
<link rel=stylesheet href=/css/hugo-octopress.css>
<link rel=stylesheet href=/css/fork-awesome.min.css>
<link href=https://parsiya.net/favicon.png rel=icon>
<meta name=description content>
<meta name=keywords content="[Parsia Hakimian Parsiya infosec information security]">
<meta name=author content="Parsia">
<meta name=generator content="Hugo 0.92.2">
<meta name=twitter:card content="summary_large_image">
<meta name=twitter:image:src content="https://parsiya.net/blog/2018-06-05-contextis-xmas-ctf-writeup/.png">
<meta name=twitter:title content="ContextIS xmas CTF Writeup">
<meta name=twitter:description content="In January 2018, Context Information Security had a CTF. Here are my write-ups for some of them and write-ups for some I did not figure out. But that's CTF for you. If you manage to walk down the path of designer, you will be fine. Otherwise, you will have a bad time.
But enough complaining, let's see what happens.">
<meta name=twitter:domain content="parsiya.net">
<meta name=twitter:creator content="@CryptoGangsta">
</head>
<body>
<header role=banner>
<hgroup>
<h1><a href=https://parsiya.net/>Hackerman's Hacking Tutorials</a></h1>
<h2>The knowledge of anything, since all things have causes, is not acquired or
complete unless it is known by its causes. - Avicenna</h2>
</hgroup></header>
<nav role=navigation>
<fieldset class=mobile-nav>
<select onchange="location=this.value"><option value>Navigate…</option><option value=https://parsiya.net/about/>» About Me!</option><option value=https://parsiya.net/cheatsheet/>» Cheat Sheet</option><option value=https://parsiya.io/>» My Clone</option><option value=https://github.com/parsiya/parsiya.net>» Source Repo</option><option value="https://queue.acm.org/detail.cfm?id=3197520">» Manual Work is a Bug</option><option value="https://www.google.com/search?q=andrew+ridgeley">» The Other Guy from Wham!</option></select>
</fieldset>
<ul class=main-navigation>
<li><a href=https://parsiya.net/about/ title="About Me!" target=_blank rel="noopener noreferrer">About Me!</a></li>
<li><a href=https://parsiya.net/cheatsheet/ title="Cheat Sheet" target=_blank rel="noopener noreferrer">Cheat Sheet</a></li>
<li><a href=https://parsiya.io/ title="My Clone" target=_blank rel="noopener noreferrer">My Clone</a></li>
<li><a href=https://github.com/parsiya/parsiya.net title="Source Repo" target=_blank rel="noopener noreferrer">Source Repo</a></li>
<li><a href="https://queue.acm.org/detail.cfm?id=3197520" title="Manual Work is a Bug" target=_blank rel="noopener noreferrer">Manual Work is a Bug</a></li>
<li><a href="https://www.google.com/search?q=andrew+ridgeley" title="The Other Guy from Wham!" target=_blank rel="noopener noreferrer">The Other Guy from Wham!</a></li>
</ul>
<ul class=subscription>
<a href=https://parsiya.net/index.xml target=_blank type=application/rss+xml title=RSS rel="noopener noreferrer"><i class="fa fa-rss-square fa-lg"></i></a>
</ul>
<form action=https://www.google.com/search method=get target=_blank rel="noopener noreferrer">
<fieldset role=search>
<input class=search type=text name=q results=0 placeholder=Search>
<input type=hidden name=q value=site:https://parsiya.net/>
</fieldset>
</form>
</nav>
<div id=main>
<div id=content>
<div>
<article class=hentry role=article>
<header>
<p class=meta>Jun 5, 2018
- 6 minute read
- <a href=https://parsiya.net/blog/2018-06-05-contextis-xmas-ctf-writeup/#disqus_thread>Comments</a>
- <a class=label href=https://parsiya.net/categories/writeup/>Writeup </a><a class=label href=https://parsiya.net/categories/reverse-engineering/>Reverse Engineering </a><a class=label href=https://parsiya.net/categories/crypto/>Crypto </a>
</p>
<h1 class=entry-title>
ContextIS xmas CTF Writeup
</h1>
</header>
<div class=entry-content>
<nav id=TableOfContents>
<ul>
<li><a href=#challenge-1>Challenge 1</a></li>
<li><a href=#challenge-2>Challenge 2</a></li>
<li><a href=#challenge-3>Challenge 3</a>
<ul>
<li><a href=#a-closer-look-at-wave-files>A Closer Look at Wave Files</a></li>
</ul>
</li>
<li><a href=#challenge-4---mips-me-not>Challenge 4 - MIPS Me Not</a>
<ul>
<li><a href=#mips-assembly-primer>MIPS Assembly Primer</a>
<ul>
<li><a href=#load-and-store>Load and Store</a></li>
<li><a href=#other-instructions>Other instructions</a></li>
<li><a href=#holy-32-registers-batman>Holy 32 registers Batman!</a></li>
<li><a href=#function-calls>Function calls</a></li>
</ul>
</li>
<li><a href=#but-what-does-the-program-do>But what does the program do?</a></li>
<li><a href=#encrypt_pw>encrypt_pw</a></li>
<li><a href=#unk_400b14>unk_400B14</a></li>
</ul>
</li>
</ul>
</nav>
<p>In January 2018, <a href=https://www.contextis.com/ target=_blank rel="noreferrer noopener">Context Information Security</a> had a CTF. Here are my write-ups for some of them and write-ups for some I did not figure out. But that's CTF for you. If you manage to walk down the path of designer, you will be fine. Otherwise, you will have a bad time.</p>
<p>But enough complaining, let's see what happens.</p>
<h1 id=challenge-1>Challenge 1
<a class=header-link href=#challenge-1><svg class="fill-current o-60 hover-accent-color-light" height="22" viewBox="0 0 24 24" width="22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="none"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a>
</h1><p>A code and a picture of "Charles Wheatstone." Seems like he invented the electric telegraph along with William Cooke.</p>
<p>Wheatstone also invented the playfair cipher. Then the code must be in playfair cipher.</p>
<p>Ciphertext:</p>
<pre tabindex=0><code>RSOEBLNZAYNDQOXCNVQBUGIMDRAEGIMIQMKNKIIGZTKNQYHGBKLBPGQXKGFQTNQONEOUNUN
MMZKGLAYFPYRBDRAEGIGQUHUGBRQZYQRVBILAYFPYRBAQNLGVGTNMMZKGXNGNPDQMNUIKAQ
PCNDTOFHMIYPNMBGDEPALH{QMGKRIIMSEKPCNUBTITQC}V
</code></pre><p>We drop into a random playfair breaker we found on the internet</p>
<p><a href=http://bionsgadgets.appspot.com/ww_forms/playfair_ph_web_worker3.html target=_blank rel="noreferrer noopener">http://bionsgadgets.appspot.com/ww_forms/playfair_ph_web_worker3.html</a></p>
<p>And voila!</p>
<pre tabindex=0><code>congratulationsyouhavedecipheredthesecretmessagecharleswheatstoneinventedthe
playfaircipherhoweveritwaslordplayfairwhopromotedtheuseofithencewhyitisnamed
afterhimflagthehiddenkeyiswindsorx
</code></pre><p>"congratulations you have deciphered the secret message charles wheatstone invented the playfair cipher however it was lord playfair who promoted the use of it hence why it is named after him</p>
<p><strong>flag the hidden key is windsorx</strong>."</p>
<h1 id=challenge-2>Challenge 2
<a class=header-link href=#challenge-2><svg class="fill-current o-60 hover-accent-color-light" height="22" viewBox="0 0 24 24" width="22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="none"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a>
</h1><p>Second one seems to be a pcap. It's actually a pcapng file, so before using <code>gopacket/pcap</code> we need to convert it to pcap.</p>
<p>Inside the pcap there are a bunch of ping requests and replies with payloads.</p>
<p>Wrote a golang program using gopacket and pcap to get the payloads. Some are duplicates.</p>
<p>Each payload starts with <code>$$START$$</code> and contains base64 encoded data. We get them all and decode them and get a lot of random text. Search for <code>flag{.*}</code> and we get the flag.</p>
<p><strong>flag{ICMP_Tunn3ling_15_c00l}</strong></p>
<h1 id=challenge-3>Challenge 3
<a class=header-link href=#challenge-3><svg class="fill-current o-60 hover-accent-color-light" height="22" viewBox="0 0 24 24" width="22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="none"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a>
</h1><p>Stego in the wav file. I have never done one before but then again I do not have a CTF team.</p>
<p>I started reading this:</p>
<ul>
<li><a href=https://ethackal.github.io/2015/10/05/derbycon-ctf-wav-steganography/ target=_blank rel="noreferrer noopener">https://ethackal.github.io/2015/10/05/derbycon-ctf-wav-steganography/</a></li>
</ul>
<p>I chose this Golang library for reading wave files:</p>
<ul>
<li><a href=https://github.com/youpy/go-wav target=_blank rel="noreferrer noopener">https://github.com/youpy/go-wav</a></li>
</ul>
<p>Let's see if it supports reading the LSBs.</p>
<p>I wrote code that reads the LSBs and nothing came out.</p>
<p>There's nothing in hex.</p>
<p>Looking at the wav file in Audacity we can also see the waves.</p>
<p>If negative wave is 0 and positive is 1, we get 12*8 bits:</p>
<pre tabindex=0><code>01101001
01011001
01101001
01010110
01101001
10011010
01101001
01100101
01101001
10101010
01101010
01011001
</code></pre><p>Using this filter in <a href=https://gchq.github.io/CyberChef/ target=_blank rel="noreferrer noopener">CyberChef</a>:</p>
<pre tabindex=0><code>Fork('\\n','\\n',false)
From_Base(2)
To_Base(16)
From_Hex('Space')
</code></pre><p>We get</p>
<pre tabindex=0><code>69 59 69 56 69 9a 69 65 69 aa 6a 59

i Y i V i . i e i ª j Y
</code></pre><p>Which doesn't help.</p>
<h2 id=a-closer-look-at-wave-files>A Closer Look at Wave Files
<a class=header-link href=#a-closer-look-at-wave-files><svg class="fill-current o-60 hover-accent-color-light" height="22" viewBox="0 0 24 24" width="22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="none"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a>
</h2><p>Wave files are pretty easy to figure out. Here's the header for <code>13.wav</code> file.</p>
<pre tabindex=0><code>00000000  52 49 46 46 74 40 01 00 57 41 56 45 66 6d 74 20  |RIFFt@..WAVEfmt |
00000010  10 00 00 00 01 00 01 00 e8 03 00 00 e8 03 00 00  |........è...è...|
00000020  01 00 08 00 64 61 74 61 50 40 01 00   |....dataP@......|
</code></pre><p>The specification is pretty easy to find:</p>
<ul>
<li><a href=http://soundfile.sapp.org/doc/WaveFormat/ target=_blank rel="noreferrer noopener">http://soundfile.sapp.org/doc/WaveFormat/</a></li>
<li><a href=https://www.codeproject.com/Articles/6960/Steganography-VIII-Hiding-Data-in-Wave-Audio-Files target=_blank rel="noreferrer noopener">https://www.codeproject.com/Articles/6960/Steganography-VIII-Hiding-Data-in-Wave-Audio-Files</a></li>
</ul>
<p>The links do a much better job of what I can do. So I will just show follow them. Everything is big endian unless indicated with LE (Little Endian):</p>
<ul>
<li><code>52 49 46 46</code> - ChunkID - Signature - RIFF</li>
<li><code>74 40 01 00</code> - ChunkSize- Size of rest of the file (e.g. filesize + 8 bytes) - LE - 82036</li>
<li><code>57 41 56 45</code> - Format (WAVE)</li>
</ul>
<p>Wave format has two parts, <code>fmt</code> and <code>data</code>:</p>
<p><code>fmt</code>:</p>
<ul>
<li><code>66 6d 74 20</code>: Subchunk1ID - <code>fmt </code> (note space in the end to align things)</li>
<li><code>10 00 00 00</code>: Subchunk1size - LE - 16 - size of the rest of the subchunk</li>
<li><code>01 00</code>: AudioFormat - LE - 01 - PCM</li>
<li><code>01 00</code>: NumChannels - LE - number of channels - 01 means mono</li>
<li><code>e8 03 00 00</code>: SampleRate - LE - 1000</li>
<li><code>e8 03 00 00</code>: ByteRate == SampleRate * NumChannels * BitsPerSample/8 - LE - 1000 (1000<em>1</em>8/8)</li>
<li><code>01 00</code>: BlockAlign == NumChannels * BitsPerSample/8 - LE - 1</li>
<li><code>08 00</code>: BitsPerSample - LE - 8</li>
</ul>
<p><code>data</code>:</p>
<ul>
<li><code>64 61 74 61</code>: Subchunk2ID - <code>data</code></li>
<li><code>50 40 01 00</code>: Subchunk2Size - size of data chunk - LE - 82000</li>
<li><code>80 80 80 80 ...</code>: The rest is data (82000) bytes.</li>
</ul>
<p><strong>Rage quit!</strong></p>
<h1 id=challenge-4---mips-me-not>Challenge 4 - MIPS Me Not
<a class=header-link href=#challenge-4---mips-me-not><svg class="fill-current o-60 hover-accent-color-light" height="22" viewBox="0 0 24 24" width="22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="none"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a>
</h1><p>A MIPS ELF executable. I don't have a device or VM that runs this, will drop it in IDA.</p>
<p>Seems to be a simple "enter password" and then do a compare challenge.</p>
<h2 id=mips-assembly-primer>MIPS Assembly Primer
<a class=header-link href=#mips-assembly-primer><svg class="fill-current o-60 hover-accent-color-light" height="22" viewBox="0 0 24 24" width="22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="none"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a>
</h2><p>I don't know MIPS assembly but I know enough to be able to follow this program (and of course the program is simple).</p>
<p>This is good: <a href=http://logos.cs.uic.edu/366/notes/mips%20quick%20tutorial.htm target=_blank rel="noreferrer noopener">http://logos.cs.uic.edu/366/notes/mips%20quick%20tutorial.htm</a></p>
<h3 id=load-and-store>Load and Store
<a class=header-link href=#load-and-store><svg class="fill-current o-60 hover-accent-color-light" height="22" viewBox="0 0 24 24" width="22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="none"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a>
</h3><p>Load and store are two different instructions. Only they can access memory.</p>
<p><strong>Load:</strong></p>
<ul>
<li><code>lw register, memory</code> == <code>mov dword (4 bytes) register, memory</code></li>
<li><code>lb</code> same as above but one byte</li>
</ul>
<p><strong>Store:</strong></p>
<ul>
<li><code>sw register, memory</code> == <code>mov dword (4 bytes) memory, register</code></li>
<li><code>sb</code> same as bove but one byte</li>
</ul>
<h3 id=other-instructions>Other instructions
<a class=header-link href=#other-instructions><svg class="fill-current o-60 hover-accent-color-light" height="22" viewBox="0 0 24 24" width="22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="none"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a>
</h3><p>All other instructions use registers.</p>
<ul>
<li><code>addu $t1,$t6,$t7 # $t1 = $t6 + $t7; add as unsigned integers</code></li>
<li><code>XORI -- Bitwise exclusive or immediate</code></li>
<li><code>seb</code> - sign extend byte. Convert something to byte while preserving sign.</li>
</ul>
<h3 id=holy-32-registers-batman>Holy 32 registers Batman!
<a class=header-link href=#holy-32-registers-batman><svg class="fill-current o-60 hover-accent-color-light" height="22" viewBox="0 0 24 24" width="22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="none"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a>
</h3><ul>
<li><code>$zero</code> register always contains zero</li>
</ul>
<h3 id=function-calls>Function calls
<a class=header-link href=#function-calls><svg class="fill-current o-60 hover-accent-color-light" height="22" viewBox="0 0 24 24" width="22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="none"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a>
</h3><p>Source:</p>
<ul>
<li><a href=https://courses.cs.washington.edu/courses/cse378/09wi/lectures/lec05.pdf target=_blank rel="noreferrer noopener">https://courses.cs.washington.edu/courses/cse378/09wi/lectures/lec05.pdf</a></li>
</ul>
<p>Excerpt:</p>
<ul>
<li>"MIPS uses the jump-and-link instruction <code>jal</code> to call functions."</li>
<li>Return address is saved to <code>$ra</code> instead of stack.</li>
<li>To return <code>jr $ra</code>.</li>
<li>First 4 function arguments go in <code>$a0 - $a3</code> == x86/x64 fastcall.</li>
<li>Return values in <code>$v0 - $v1</code>.</li>
</ul>
<h2 id=but-what-does-the-program-do>But what does the program do?
<a class=header-link href=#but-what-does-the-program-do><svg class="fill-current o-60 hover-accent-color-light" height="22" viewBox="0 0 24 24" width="22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="none"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a>
</h2><ol>
<li><code>puts "] Plain and simple MIPS Challange ["</code> (typo is intended?)</li>
<li><code>printf "Please enter the passphrase:"</code></li>
<li><code>fget</code> 14 (0x0D) chars of user input</li>
<li><code>printf</code> user input</li>
<li><code>encrypt_pw</code> user input</li>
<li><code>memcmp</code> first 9 chars of encrypted user input and <code>unk_400B14</code></li>
<li>Profit</li>
</ol>
<h2 id=encrypt_pw>encrypt_pw
<a class=header-link href=#encrypt_pw><svg class="fill-current o-60 hover-accent-color-light" height="22" viewBox="0 0 24 24" width="22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="none"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a>
</h2><div class=highlight><pre tabindex=0 style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-nasm data-lang=nasm><span style=color:#268bd2>var_10</span> = <span style=color:#2aa198>0</span> <span style=color:#719e07>//</span> <span style=color:#cb4b16>$</span><span style=color:#268bd2>zero</span>

loc_400860:
    <span style=color:#268bd2>check</span> <span style=color:#268bd2>if</span> <span style=color:#268bd2>var_10</span> == <span style=color:#2aa198>0x0D</span> (<span style=color:#2aa198>14</span>) <span style=color:#719e07>//</span> <span style=color:#268bd2>see</span> <span style=color:#268bd2>step</span> <span style=color:#2aa198>3</span> <span style=color:#268bd2>above</span>
    <span style=color:#268bd2>if</span> <span style=color:#268bd2>so</span>, <span style=color:#268bd2>return</span> (<span style=color:#268bd2>jr</span> <span style=color:#cb4b16>$</span><span style=color:#268bd2>ra</span>)
    <span style=color:#268bd2>if</span> <span style=color:#268bd2>not</span> <span style=color:#268bd2>jmp</span> <span style=color:#268bd2>loc_40082C</span>

loc_40082C:
    <span style=color:#268bd2>v0</span> = <span style=color:#268bd2>var_10</span>
    <span style=color:#268bd2>v1</span> = <span style=color:#268bd2>input</span> <span style=color:#719e07>//</span> <span style=color:#2aa198>4</span> <span style=color:#dc322f>byte</span><span style=color:#268bd2>s</span> <span style=color:#268bd2>at</span> <span style=color:#268bd2>a</span> <span style=color:#268bd2>time</span> <span style=color:#268bd2>but</span> <span style=color:#268bd2>because</span> <span style=color:#268bd2>we</span> <span style=color:#268bd2>are</span> <span style=color:#268bd2>adding</span> <span style=color:#268bd2>one</span> <span style=color:#dc322f>byte</span> <span style=color:#268bd2>to</span> <span style=color:#268bd2>it</span>,
               // <span style=color:#268bd2>it</span> <span style=color:#268bd2>only</span> <span style=color:#268bd2>messes</span> <span style=color:#268bd2>with</span> <span style=color:#268bd2>the</span> <span style=color:#268bd2>input</span> <span style=color:#268bd2>one</span> <span style=color:#dc322f>byte</span> <span style=color:#268bd2>at</span> <span style=color:#268bd2>a</span> <span style=color:#268bd2>time</span> (<span style=color:#268bd2>hint</span>: <span style=color:#268bd2>counter</span>)
    <span style=color:#268bd2>v0</span> = <span style=color:#268bd2>v0</span> <span style=color:#719e07>+</span> <span style=color:#268bd2>v1</span> (<span style=color:#268bd2>unsigned</span>)

    <span style=color:#268bd2>v1</span> = <span style=color:#268bd2>var_10</span>
    <span style=color:#268bd2>a0</span> = <span style=color:#268bd2>input</span>
    <span style=color:#268bd2>v1</span> = <span style=color:#268bd2>a0</span> <span style=color:#719e07>+</span> <span style=color:#268bd2>v1</span> (<span style=color:#268bd2>unsigned</span>)
    <span style=color:#268bd2>v1</span> = <span style=color:#268bd2>v1</span>[<span style=color:#2aa198>0</span>] <span style=color:#719e07>//</span> <span style=color:#268bd2>we</span> <span style=color:#268bd2>are</span> <span style=color:#268bd2>effectively</span> <span style=color:#268bd2>doing</span> <span style=color:#268bd2>load</span> <span style=color:#dc322f>byte</span> <span style=color:#268bd2>at</span> <span style=color:#268bd2>index</span> <span style=color:#2aa198>0</span> <span style=color:#268bd2>of</span> [<span style=color:#268bd2>v1</span>]
    <span style=color:#268bd2>v1</span> = <span style=color:#268bd2>v1</span> <span style=color:#268bd2>xor</span> <span style=color:#2aa198>0x42</span>
    <span style=color:#268bd2>seb</span> <span style=color:#268bd2>v1</span> <span style=color:#719e07>//</span> <span style=color:#268bd2>has</span> <span style=color:#268bd2>no</span> <span style=color:#268bd2>effect</span>
    <span style=color:#268bd2>v1</span> = [<span style=color:#268bd2>v1</span>]
    <span style=color:#268bd2>var10</span> <span style=color:#719e07>++</span>
</code></pre></div><p>If I have to make a guess. This is what happens:</p>
<div class=highlight><pre tabindex=0 style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-Go data-lang=Go><span style=color:#719e07>for</span> i <span style=color:#719e07>:=</span> <span style=color:#2aa198>0</span> ; i &lt; <span style=color:#2aa198>0x0D</span> ; i <span style=color:#719e07>++</span> {
    v1[i] <span style=color:#719e07>:=</span> inp[i] xor <span style=color:#2aa198>0x42</span>
}
</code></pre></div><p>And then compared with <code>unk_400B14</code>.</p>
<h2 id=unk_400b14>unk_400B14
<a class=header-link href=#unk_400b14><svg class="fill-current o-60 hover-accent-color-light" height="22" viewBox="0 0 24 24" width="22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="none"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a>
</h2><p>Encrypted</p>
<p><code>2D 3B 0B 2A 23 36 27 0F 0B 12 11</code></p>
<p>We can do the XOR in CyberChef because I am lazy:</p>
<p><a href="https://gchq.github.io/CyberChef/#recipe=From_Hex%28%27Space%27%29XOR%28%7B%27option%27:%27Hex%27,%27string%27:%2742%27%7D,%27Standard%27,false%29&input=MkQgM0IgMEIgMkEgMjMgMzYgMjcgMEYgMEIgMTIgMTE" target=_blank rel="noreferrer noopener">https://gchq.github.io/CyberChef/#recipe=From_Hex('Space')XOR(%7B'option':'Hex','string':'42'%7D,'Standard',false)&input=MkQgM0IgMEIgMkEgMjMgMzYgMjcgMEYgMEIgMTIgMTE</a></p>
<p><strong>flag: oyIhateMIPS</strong></p>
<p><strong>Note:</strong> It turns out flag is actually <code>BoyIhateMIPS</code> (I mean <code>oy</code> also makes sense :D). I did not get the <code>B</code> because while looking at the hardcoded data in the file, I ignored it leading <code>0x00</code> byte. <code>0x00 XOR 0x42 == 0x42</code> or <code>B</code>.</p>
</div>
<footer>
<p class=meta>
<span class="byline author vcard">Posted by <span class=fn>Parsia</span></span>
<time>Jun 5, 2018</time>
</span>
</p>
<p class=meta>
<a class="basic-alignment left" href=https://parsiya.net/blog/2018-05-26-on-username-enumeration/ title="On Username Enumeration">On Username Enumeration</a>
<a class="basic-alignment right" href=https://parsiya.net/blog/2018-07-04-istanbul-tips-and-tricks/ title="Istanbul Tips and Tricks">Istanbul Tips and Tricks</a>
</p>
<div id=disqus_thread></div>
<script type=application/javascript>var disqus_config=function(){};(function(){if(["localhost","127.0.0.1"].indexOf(window.location.hostname)!=-1){document.getElementById('disqus_thread').innerHTML='Disqus comments not available by default when the website is previewed locally.';return}var b=document,a=b.createElement('script');a.async=!0,a.src='//parsiya.disqus.com/embed.js',a.setAttribute('data-timestamp',+new Date),(b.head||b.body).appendChild(a)})()</script>
<noscript>Please enable JavaScript to view the <a href=https://disqus.com/?ref_noscript>comments powered by Disqus.</a></noscript>
<a href=https://disqus.com class=dsq-brlink>comments powered by <span class=logo-disqus>Disqus</span></a>
</footer>
</article>
</div>
<aside class="sidebar thirds">
<section class="first odd">
<h1>Who am I?</h1>
<p>
<p>I am Parsia, a senior security engineer at <a href=https://www.ea.com/security>Electronic Arts</a>.</p>
<p>I write about application security, reverse engineering,
Go, cryptography, and (obviously) videogames.</p>
<p>Click on <a href=/about/>About Me!</a> to know more.</p>
</p>
</section>
<ul class=sidebar-nav>
<li class=sidebar-nav-item>
<a target=_blank rel="noopener noreferrer" href=https://github.com/parsiya/ title=https://github.com/parsiya/><i class="fa fa-github fa-3x"></i></a>
<a target=_blank rel="noopener noreferrer" href=https://twitter.com/cryptogangsta/ title=https://twitter.com/cryptogangsta/><i class="fa fa-twitter fa-3x"></i></a>
<a target=_blank rel="noopener noreferrer" href=https://keybase.io/parsiya/ title=https://keybase.io/parsiya/><i class="fa fa-keybase fa-3x"></i></a>
<a target=_blank rel="noopener noreferrer" href=https://www.linkedin.com/in/parsiya title=https://www.linkedin.com/in/parsiya><i class="fa fa-linkedin fa-3x"></i></a>
</li>
</ul>
<section class=odd>
<h1>Collections</h1>
<li>
<a href=https://parsiya.net/categories/thick-client-proxying/ title="Thick Client Proxying">Thick Client Proxying</a>
</li>
<li>
<a href=https://parsiya.net/categories/writeup/ title=CTFs/Writeups>CTFs/Writeups</a>
</li>
<li>
<a href=https://parsiya.net/categories/attack-surface-analysis/ title="Attack Surface Analysis">Attack Surface Analysis</a>
</li>
<li>
<a href=https://parsiya.net/categories/bug-bounty/ title="Bug Bounty">Bug Bounty</a>
</li>
<li>
<a href=https://parsiya.net/categories/go/ title=Go/Golang>Go/Golang</a>
</li>
<li>
<a href=https://parsiya.net/categories/blockchain/ title=Blockchain>Blockchain</a>
</li>
<li>
<a href=https://parsiya.net/categories/burp-extension/ title="Burp Extension Development">Burp Extension Development</a>
</li>
<li>
<a href=https://parsiya.net/categories/automation/ title=Automation>Automation</a>
</li>
<li>
<a href=https://parsiya.net/categories/reverse-engineering/ title="Reverse Engineering">Reverse Engineering</a>
</li>
<li>
<a href=https://parsiya.net/categories/crypto/ title=Crypto(graphy)>Crypto(graphy)</a>
</li>
<li>
<a href=https://parsiya.net/categories/winappdbg/ title=WinAppDbg>WinAppDbg</a>
</li>
<li>
<a href=https://awsome.pw title="AWSome.pw - S3 bucket squatting - my very legit branded vulnerability">AWSome.pw - S3 bucket squatting - my very legit branded vulnerability</a>
</li>
</section>
</aside>
</div>
</div>
<footer role=contentinfo>
<p>Copyright &copy; 2022 Parsia - <a href=https://parsiya.net/license/>License</a> -
<span class=credit>Powered by <a target=_blank href=https://gohugo.io rel="noopener noreferrer">Hugo</a> and <a target=_blank href=https://github.com/parsiya/hugo-octopress/ rel="noopener noreferrer">Hugo-Octopress</a> theme.
</p>
</footer>
</body>
</html>