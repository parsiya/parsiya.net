<!doctype html><html xmlns=http://www.w3.org/1999/xhtml xml:lang=en lang=en-us><head><meta charset=utf-8><meta name=viewport content="width=device-width,minimum-scale=1,maximum-scale=1"><link href=/css/fonts.css rel=stylesheet type=text/css><title>Thick Client Proxying - Part 3: Burp Options and Extender</title><link rel=stylesheet href=/css/hugo-octopress.css><link rel=stylesheet href=/css/fork-awesome.min.css><link href=https://parsiya.net/favicon.png rel=icon><meta name=description content><meta name=keywords content="[Parsia Hakimian Parsiya infosec information security]"><meta name=author content="Parsia"><meta name=generator content="Hugo 0.149.0"><meta name=twitter:card content="summary"><meta name=twitter:title content="Thick Client Proxying - Part 3: Burp Options and Extender"><meta name=twitter:description content="Previous parts:

Burp Tips and Tricks for Non-Webapp Testing - Part 1: Interception and Proxy Listeners
Burp Tips and Tricks for Non-Webapp Testing - Part 2: History, Intruder, Scanner and More

Almost there, I will get through Options and Extender in this part and we will actually start doing stuff moving forward."><meta name=twitter:domain content="parsiya.net"><meta name=twitter:creator content="@CryptoGangsta"></head><body><header role=banner><hgroup><h1><a href=https://parsiya.net/>Hackerman's Hacking Tutorials</a></h1><h2>The knowledge of anything, since all things have causes, is not acquired or
complete unless it is known by its causes. - Avicenna</h2></hgroup></header><nav role=navigation><fieldset class=mobile-nav><select onchange="location=this.value"><option value>Navigate…</option><option value=https://parsiya.net/about/>» About Me!</option><option value=https://parsiya.net/cheatsheet/>» Cheat Sheet</option><option value=https://parsiya.io/>» My Clone</option><option value=https://github.com/parsiya/parsiya.net>» Source Repo</option><option value="https://queue.acm.org/detail.cfm?id=3197520">» Manual Work is a Bug</option><option value="https://www.google.com/search?q=andrew+ridgeley">» The Other Guy from Wham!</option></select></fieldset><ul class=main-navigation><li><a href=https://parsiya.net/about/ title="About Me!" target=_blank rel="noopener noreferrer">About Me!</a></li><li><a href=https://parsiya.net/cheatsheet/ title="Cheat Sheet" target=_blank rel="noopener noreferrer">Cheat Sheet</a></li><li><a href=https://parsiya.io/ title="My Clone" target=_blank rel="noopener noreferrer">My Clone</a></li><li><a href=https://github.com/parsiya/parsiya.net title="Source Repo" target=_blank rel="noopener noreferrer">Source Repo</a></li><li><a href="https://queue.acm.org/detail.cfm?id=3197520" title="Manual Work is a Bug" target=_blank rel="noopener noreferrer">Manual Work is a Bug</a></li><li><a href="https://www.google.com/search?q=andrew+ridgeley" title="The Other Guy from Wham!" target=_blank rel="noopener noreferrer">The Other Guy from Wham!</a></li></ul><ul class=subscription><a href=https://parsiya.net/index.xml target=_blank type=application/rss+xml title=RSS rel="noopener noreferrer"><i class="fa fa-rss-square fa-lg"></i></a></ul><form action=https://www.google.com/search method=get target=_blank rel="noopener noreferrer"><fieldset role=search><input class=search type=text name=q results=0 placeholder=Search>
<input type=hidden name=q value=site:https://parsiya.net/></fieldset></form></nav><div id=main><div id=content><div><article class=hentry role=article><header><p class=meta>Apr 2, 2016
- 11 minute read - <a class=label href=https://parsiya.net/categories/burp/>Burp </a><a class=label href=https://parsiya.net/categories/thick-client-proxying/>Thick Client Proxying</a></p><h1 class=entry-title>Thick Client Proxying - Part 3: Burp Options and Extender</h1></header><div class=entry-content><nav id=TableOfContents><ul><li><a href=#1-options>1. Options</a><ul><li><a href=#11-connections>1.1 Connections</a><ul><li><a href=#111-platform-authentication>1.1.1 Platform Authentication</a></li><li><a href=#112-upstream-proxy-servers---socks-proxy>1.1.2 Upstream Proxy Servers - SOCKS Proxy</a></li><li><a href=#113-timeouts>1.1.3 Timeouts</a></li><li><a href=#114-hostname-resolution>1.1.4 Hostname Resolution</a></li><li><a href=#115-out-of-scope-requests>1.1.5 Out-of-Scope Requests</a></li></ul></li><li><a href=#12-http>1.2 HTTP</a><ul><li><a href=#121-streaming-responses>1.2.1 Streaming Responses</a></li></ul></li><li><a href=#13-ssl>1.3 SSL</a><ul><li><a href=#131-ssl-negotiation>1.3.1 SSL Negotiation</a></li><li><a href=#132-client-ssl-certificates>1.3.2 Client SSL Certificates</a></li></ul></li><li><a href=#14-session>1.4 Session</a></li><li><a href=#15-display>1.5 Display</a></li><li><a href=#16-misc>1.6 Misc</a><ul><li><a href=#161-burp-collaborator-server>1.6.1 Burp Collaborator Server</a></li></ul></li></ul></li><li><a href=#2-alerts>2. Alerts</a></li><li><a href=#3-extender>3. Extender</a><ul><li><a href=#31-extensions>3.1 Extensions</a></li><li><a href=#32-bapp-store>3.2 BApp Store</a></li><li><a href=#33-apis>3.3 APIs</a></li><li><a href=#34-options>3.4 Options</a></li></ul></li><li><a href=#4-where-do-we-go-from-here>4. Where do We Go from Here?</a></li></ul></nav><p>Previous parts:</p><ul><li><a href=https://parsiya.net/blog/2016-03-27-thick-client-proxying-part-1-burp-interception-and-proxy-listeners/ title="Burp Tips and Tricks for Non-Webapp Testing - Part 1: Interception and Proxy Listeners">Burp Tips and Tricks for Non-Webapp Testing - Part 1: Interception and Proxy Listeners</a></li><li><a href=https://parsiya.net/blog/2016-03-29-thick-client-proxying-part-2-burp-history-intruder-scanner-and-more/ title="Burp Tips and Tricks for Non-Webapp Testing - Part 2: History, Intruder, Scanner and More">Burp Tips and Tricks for Non-Webapp Testing - Part 2: History, Intruder, Scanner and More</a></li></ul><p>Almost there, I will get through <code>Options</code> and <code>Extender</code> in this part and we will actually start doing stuff moving forward.</p><h1 id=1-options>1. Options
<a class=header-link href=#1-options><svg class="fill-current o-60 hover-accent-color-light" height="22" viewBox="0 0 24 24" width="22"><path d="M0 0h24v24H0z" fill="none"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h1><p>The place to configure Burp and make tricky apps work with it.</p><h2 id=11-connections>1.1 Connections
<a class=header-link href=#11-connections><svg class="fill-current o-60 hover-accent-color-light" height="22" viewBox="0 0 24 24" width="22"><path d="M0 0h24v24H0z" fill="none"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h2><h3 id=111-platform-authentication>1.1.1 Platform Authentication
<a class=header-link href=#111-platform-authentication><svg class="fill-current o-60 hover-accent-color-light" height="22" viewBox="0 0 24 24" width="22"><path d="M0 0h24v24H0z" fill="none"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h3><p>If the application needs to do special forms of authentication such as <code>NTLM</code> or <code>Basic</code> you can configure it here. If you are doing authentication in the browser then you probably do not need to do it here and will see the headers in Burp but adding them here means you do not have to enter them every time you login to the application. For thick clients this is usually helpful if you need to access the environment using some sort of platform authentication first.</p><p>Sometimes one of your tools does not support thse settings or has problems with it. I have had this problem when using Appscan with some weird websites (although Appscan supports platform authentication). You can pipe your other tool (Appscan supports such a setting) to Burp and then let Burp do the work. I would not suggest it for any tool like Appscan which generates a lot of traffic but "needs must when <del>the devil drives</del> you have to use Appscan." If the authentication fails, the error messages will appear in the <code>Alerts</code> tab.</p><span class=caption-wrapper><img class=caption src=/images/2016/burp-tips-3/01.PNG title="Platform authentication options" alt="Platform authentication options">
<span class=caption-text>Platform authentication options</span></span><p>Enable the <code>Prompt for credentials on platform authentication failure</code> to pass the prompt to browser on authentication failure.</p><h3 id=112-upstream-proxy-servers---socks-proxy>1.1.2 Upstream Proxy Servers - SOCKS Proxy
<a class=header-link href=#112-upstream-proxy-servers---socks-proxy><svg class="fill-current o-60 hover-accent-color-light" height="22" viewBox="0 0 24 24" width="22"><path d="M0 0h24v24H0z" fill="none"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h3><p>I have talked a lot about using Burp as part of a proxy chain. This is where we can configure where the requests are forwarded from Burp. It's also useful for using Burp in environments with corporate proxy servers. Usually these proxy servers are automatically configured. These settings can usually be accessed in Internet Explorer's proxy settings at <code>Tools (menu) > Internet Options (menu item)> Connections (tab) > LAN settings (button)</code>. Often there is a <code>proxy auto-config</code> or <code>pac</code> file configured via the <code>Use automatic configuration script</code> setting. Retrieve the pac file and view it in a text editor. The proxy address:port should be there.</p><span class=caption-wrapper><img class=caption src=/images/2016/burp-tips-3/02.PNG title="Upstream Proxy Servers" alt="Upstream Proxy Servers">
<span class=caption-text>Upstream Proxy Servers</span></span><p>Using a SOCKS proxy is similar. According to the fine print, this will override the previous proxy settings. Personally I have never had to configure a SOCKS proxy for Burp.</p><h3 id=113-timeouts>1.1.3 Timeouts
<a class=header-link href=#113-timeouts><svg class="fill-current o-60 hover-accent-color-light" height="22" viewBox="0 0 24 24" width="22"><path d="M0 0h24v24H0z" fill="none"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h3><p>Use it for slow servers. We usually test on UAT, QA or whatever-environment-the-client-can-spare which are slow. If you are dealing with a slow server, increase the timeouts here. If Burp is part of a proxy chain, definitely increase the timeouts to compensate for delays.</p><span class=caption-wrapper><img class=caption src=/images/2016/burp-tips-3/03.PNG title="Timeout settings" alt="Timeout settings">
<span class=caption-text>Timeout settings</span></span><h3 id=114-hostname-resolution>1.1.4 Hostname Resolution
<a class=header-link href=#114-hostname-resolution><svg class="fill-current o-60 hover-accent-color-light" height="22" viewBox="0 0 24 24" width="22"><path d="M0 0h24v24H0z" fill="none"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h3><p>I have talked about it briefly in <a href=https://parsiya.net/blog/2016-03-27-thick-client-proxying-part-1-burp-interception-and-proxy-listeners/#2-2-request-handling title="Request Handling">Part 1: Request Handling</a>. The application talks to multiple endpoints but doesn't support proxy settings. We redirect application's traffic to Burp using other means (e.g. Windows hosts file or other OS level mechanisms). Now Burp needs to know where to forward the traffic otherwise it will go into a infinite loop and send the traffic back to itself again.</p><p>We cannot use the <code>Request Handling</code> functionality because it only supports one endpoint. Instead we will leave it empty and add the endpoints and their associated IP address here in <code>Hostname Resolution</code>. For example <code>server.com</code> and <code>10.11.12.13</code>. If the endpoint is behind load balancers, CDNs or is on shared hosting like an Amazon S3 bucket then things get a bit more complicated. In this case, run <code>Wireshark</code> or <code>Netmon</code> and capture application's traffic without a proxy. Discover the IP address that the HTTP requests are sent to. Use the discovered IP with the hostname in this section and the <code>host</code> header will do its magic (OK, there are more technical ways to do this but this is the easiest in my opinion).</p><h3 id=115-out-of-scope-requests>1.1.5 Out-of-Scope Requests
<a class=header-link href=#115-out-of-scope-requests><svg class="fill-current o-60 hover-accent-color-light" height="22" viewBox="0 0 24 24" width="22"><path d="M0 0h24v24H0z" fill="none"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h3><p>We can instruct Burp to drop all requests if they are not in scope. This can work in our favor if we have set-up the scope properly and reduces traffic/noise. There is one big catch, if the application is connecting to some other endpoints apart from the ones we are testing (and thus have added to scope), it may stop working. If you are setting up Burp for an inexperienced person and don't want them to hit production, you can designate it here. Apart from that I cannot think of a lot of uses and I have never used this functionality.</p><h2 id=12-http>1.2 HTTP
<a class=header-link href=#12-http><svg class="fill-current o-60 hover-accent-color-light" height="22" viewBox="0 0 24 24" width="22"><path d="M0 0h24v24H0z" fill="none"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h2><p><code>Redirections</code> and <code>Status 100 Responses</code> are straightforward so I will skip them.</p><h3 id=121-streaming-responses>1.2.1 Streaming Responses
<a class=header-link href=#121-streaming-responses><svg class="fill-current o-60 hover-accent-color-light" height="22" viewBox="0 0 24 24" width="22"><path d="M0 0h24v24H0z" fill="none"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h3><p>This is an underrated functionality especially for non-webapp testing. To understand when we must use this functionality, let's step back and look at how proxies work. I have written about it in some detail (with examples) in <a href=https://parsiya.net/blog/2015-10-19-proxying-hipchat-part-3-ssl-added-and-removed-here/#2-how-does-a-proxy-work title="Proxying Hipchat Part 3: SSL Added and Removed Here - 2. How does a Proxy Work?">Hipchat Part 3 - 2. How does a Proxy Work?</a>.</p><p>In short, the following happens (these are copied from the link above):</p><span class=caption-wrapper><img class=caption src=/images/2016/burp-tips-3/04.PNG title="GET http://downloads.hipchat.com/blog_info.html" alt="GET http://downloads.hipchat.com/blog_info.html">
<span class=caption-text>GET http://downloads.hipchat.com/blog_info.html</span></span><ol><li>Hipchat creates a TCP connection to Burp.</li><li>Hipchat sends the GET request to Burp.</li><li>Burp creates a TCP connection to Server.</li><li>Burp sends the GET request to Server.</li><li>Server send the web page to Burp.</li><li>Burp closes the TCP connection to Server.</li><li>Burp sends the web page to Hipchat.</li><li>Burp closes the TCP connection to Hipchat.</li></ol><p>Note that this figure is different for HTTPS requests.</p><p>Now assume <code>http://downloads.hipchat.com/blog_info.html</code> is a large file (like a 100MB update), and the application requests this file. The application treats this file as a stream and displays a progress bar depending on how much data is downloaded.</p><p>If we proxy this request, Burp will request this file in step four. Burp will not send this data to the application until the download has finished (meaning step five has not been completed). This means the application is waiting for this file for a while and may just discard it and re-send the request or just timeout and freeze. If we add <code>http://downloads.hipchat.com/blog_info.html</code> to the <code>Streaming Responses</code> section, Burp will immediately pass the response to the application as soon as it starts receiving data and saves the day.</p><h2 id=13-ssl>1.3 SSL
<a class=header-link href=#13-ssl><svg class="fill-current o-60 hover-accent-color-light" height="22" viewBox="0 0 24 24" width="22"><path d="M0 0h24v24H0z" fill="none"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h2><p><code>Server SSL Certificates</code> just shows a list a certificates retrieved from server. You could easily get the certificates using a command line tool like <code>OpenSSL</code> but I guess you can view the certificate info here too.</p><h3 id=131-ssl-negotiation>1.3.1 SSL Negotiation
<a class=header-link href=#131-ssl-negotiation><svg class="fill-current o-60 hover-accent-color-light" height="22" viewBox="0 0 24 24" width="22"><path d="M0 0h24v24H0z" fill="none"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h3><p>It's a good idea to install the <a href=https://www.oracle.com/technetwork/java/javase/downloads/jce8-download-2133166.html target=_blank rel="noreferrer noopener">Java Cryptography Extension (JCE) Unlimited Strength Jurisdiction Policy Files</a> anyways but you can use unlimited cipher strength in Burp too. Also make sure you are running a recent version of Java Runtime Environment (JRE). The other day I was trying to proxy an application and the TLS handshake failed even with the unlimited strength policy until I realized the machine had JRE 6.</p><p><strong>Enable all options</strong> except the <code>Disable Java SNI extension</code>, chances are that you need SNI. The <code>Allow unsafe renegotiation</code> looks a bit scary but helps a lot when using client side certificates.</p><p>During proxying if you are not confident that the current TLS settings work, keep a close eye on the <code>Alerts</code> tab. If the TLS handshake fails or if Burp and server cannot complete the TLS handshake, there will be errors there. Again, for troubleshooting use <a href=https://parsiya.net/blog/2016-03-27-thick-client-proxying-part-1-burp-interception-and-proxy-listeners/#1-4-ssl-pass-through title="SSL Pass Through">SSL Pass Through</a>.</p><h3 id=132-client-ssl-certificates>1.3.2 Client SSL Certificates
<a class=header-link href=#132-client-ssl-certificates><svg class="fill-current o-60 hover-accent-color-light" height="22" viewBox="0 0 24 24" width="22"><path d="M0 0h24v24H0z" fill="none"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h3><p>If the application needs a client-side certificate, we can add it here. Easy peasy. We can select a destination host and Burp will use the certificate for that host.</p><h2 id=14-session>1.4 Session
<a class=header-link href=#14-session><svg class="fill-current o-60 hover-accent-color-light" height="22" viewBox="0 0 24 24" width="22"><path d="M0 0h24v24H0z" fill="none"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h2><p>This tab gives us a decent amount of automation. You can create macros. You do a bunch of stuff and the request are logged, then you choose some of them and save as a macro. Later in <code>Session Handling Rules</code> you can choose to run the macro for a certain scope or after a specific request. For example you can create a macro for login and let Burp login before you send any request. Another thing to do is to create a parameter (with a specific value) and add it to every request (or requests in a certain scope) or modify the value of a parameter automatically.</p><p>I would write more about this tab but I do not usually use it. I have only used it a few times to do stuff as I have described above. Hopefully in our examples we will be able to use it in action.</p><h2 id=15-display>1.5 Display
<a class=header-link href=#15-display><svg class="fill-current o-60 hover-accent-color-light" height="22" viewBox="0 0 24 24" width="22"><path d="M0 0h24v24H0z" fill="none"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h2><p>You can change the font, encoding and other items here. Note that the font/size of Burp theme is different from the text boxes that display request/responses.</p><h2 id=16-misc>1.6 Misc
<a class=header-link href=#16-misc><svg class="fill-current o-60 hover-accent-color-light" height="22" viewBox="0 0 24 24" width="22"><path d="M0 0h24v24H0z" fill="none"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h2><p>Most items here do not need any explanation. If you have the Pro version, I suggest turning on <code>Automatic Backup</code>. I usually set it to one hour and enable <code>Backup on exit</code>. Because I like to keep daily backups of Burp savedstates, I also enable <code>Include in-scope items only</code> which decreases the size of the savedstate dramatically.</p><p>Having backup of savedstates have saved my backside quite a number of times. During report writing, I remember that I have not taken screenshots of some items so I can just open up the savedstate and create the evidence. Also, if you need to check something when the testing period has ended or your account is locked, sometimes you can use savedstates.</p><p><code>Scheduled Tasks</code> allow you to do some scheduling. For example you can set the scanner to start at a certain hour. If you do not want to or can't scan during the day, set it to start a scan at a certain hour. Unfortunately it does not allow to run a macro as a scheduled tasks and the options are very limited.</p><span class=caption-wrapper><img class=caption src=/images/2016/burp-tips-3/05.PNG title="Schedule task options" alt="Schedule task options">
<span class=caption-text>Schedule task options</span></span><h3 id=161-burp-collaborator-server>1.6.1 Burp Collaborator Server
<a class=header-link href=#161-burp-collaborator-server><svg class="fill-current o-60 hover-accent-color-light" height="22" viewBox="0 0 24 24" width="22"><path d="M0 0h24v24H0z" fill="none"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h3><p>Burp Collaborator is the new thing. Default setting is to <code>Use the default collaborator server</code> which is annoying. So after every new installation of Burp, this is one of the options that I modify. I am not quite sure what kind of information is passed to the server, but I'd rather not have our clients' info sent to the default server. You can run your own too. Read more about it in the <a href=https://portswigger.net/burp/help/collaborator.html target=_blank rel="noreferrer noopener">documentation</a>.</p><h1 id=2-alerts>2. Alerts
<a class=header-link href=#2-alerts><svg class="fill-current o-60 hover-accent-color-light" height="22" viewBox="0 0 24 24" width="22"><path d="M0 0h24v24H0z" fill="none"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h1><p>Alerts tab is important. Especially on TLS connection problem or timeouts. Pay close attention to this tab and read the information if it lights up.</p><h1 id=3-extender>3. Extender
<a class=header-link href=#3-extender><svg class="fill-current o-60 hover-accent-color-light" height="22" viewBox="0 0 24 24" width="22"><path d="M0 0h24v24H0z" fill="none"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h1><p>Burp has support for extensions. Extensions can be created in Java, Python or Ruby. Unfortunately there is not a lot of documentation for non-Java extension deployment. Personally I prefer Python and most of what I have learned has been from reading other people's extensions.</p><h2 id=31-extensions>3.1 Extensions
<a class=header-link href=#31-extensions><svg class="fill-current o-60 hover-accent-color-light" height="22" viewBox="0 0 24 24" width="22"><path d="M0 0h24v24H0z" fill="none"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h2><p>This tab shows the current extensions and if they are loaded. It also displays their output and errors. You can also add extensions here. After loading an extension pay attention to the errors tab in case there are errors. Adding an extension is simple, click <code>Add</code> and then select the type and path to the extension file. I usually put them in a sub-directory inside the Burp directory.</p><h2 id=32-bapp-store>3.2 BApp Store
<a class=header-link href=#32-bapp-store><svg class="fill-current o-60 hover-accent-color-light" height="22" viewBox="0 0 24 24" width="22"><path d="M0 0h24v24H0z" fill="none"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h2><p>Installing plugins from the Burp app store is a breeze. Just switch to this tab, select the extension and click <code>Install</code>. If the extension is written in Python you have to install <code>Jython</code> and if it is not set in the application, Burp conveniently shows you a <code>Download Jython</code> button.</p><span class=caption-wrapper><img class=caption src=/images/2016/burp-tips-3/06.PNG title="Need Jython" alt="Need Jython">
<span class=caption-text>Need Jython</span></span><p>Clicking on the download button open up <a href=http://www.jython.org/downloads.html target=_blank rel="noreferrer noopener">this page</a>. Download the latest <code>Standalone Jar</code>. I usually just put it in the same directory as Burp. Then switch to the <code>Extender > Options</code> tab and select it under the <code>Python Environment > Location of the Jython standalone JAR file</code> and you are good to go.</p><span class=caption-wrapper><img class=caption src=/images/2016/burp-tips-3/07.PNG title="Path to Jython" alt="Path to Jython">
<span class=caption-text>Path to Jython</span></span><p>Now the <code>Install</code> button lights up and you can install the extension(s).</p><h2 id=33-apis>3.3 APIs
<a class=header-link href=#33-apis><svg class="fill-current o-60 hover-accent-color-light" height="22" viewBox="0 0 24 24" width="22"><path d="M0 0h24v24H0z" fill="none"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h2><p>APIs tab contains the API documentation. Burp extensions can use this APIs to interact with Burp. As you can see the documentation is for Java extensions.</p><h2 id=34-options>3.4 Options
<a class=header-link href=#34-options><svg class="fill-current o-60 hover-accent-color-light" height="22" viewBox="0 0 24 24" width="22"><path d="M0 0h24v24H0z" fill="none"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h2><p>As we have seen before, we can set the paths to <code>Jython</code> and <code>JRuby</code> here. We can also designate directories for extension written in Java and Python. When Burp starts, extensions in these directories are automatically loaded.</p><hr><h1 id=4-where-do-we-go-from-here>4. Where do We Go from Here?
<a class=header-link href=#4-where-do-we-go-from-here><svg class="fill-current o-60 hover-accent-color-light" height="22" viewBox="0 0 24 24" width="22"><path d="M0 0h24v24H0z" fill="none"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h1><p>I have talked a lot about the options in Burp, but I have done nothing. From next part, I am going to proxy some sample thick clients using Burp. My biggest problem is finding applications that need the Burp functionalities that we have talked about (e.g. <code>Streaming Responses</code> or <code>Hostname Resolution</code>). If I cannot find such applications in the real world, I am going to develop a few small applications and then we can practice on them.</p><p>Practice is important. We don't want to turn into what the famous Persian poet and scholar <a href=https://en.wikipedia.org/wiki/Saadi_Shirazi target=_blank rel="noreferrer noopener">Saadi Shirazi (سعدی شیرازی)</a> called "عالم بی عمل" or "learned man without practice." As Saadi says in his Gulistan (گلستان or rose garden), chapter 8: "On Rules for Conduct in Life" <a href=https://ebooks.adelaide.edu.au/s/saadi/s12g/chapter8.html#section256 target=_blank rel="noreferrer noopener">Maxim 50</a>:</p><blockquote><p>A disciple without intention is a lover without money; a traveller without knowledge is a bird without wings; a scholar without practice is a tree without fruit, and a devotee without science is a house without a door. The Quran was revealed for the acquisition of a good character, not for chanting written chapters. A pious unlettered man is like one who travels on foot, whilst a negligent scholar is like a sleeping rider. A sinner who lifts his hands in supplication is better than a devotee who keeps them proudly on his head.</p></blockquote><blockquote><p>A good humoured and pleasant military officer<br>Is superior to a theologian who injures men.</p></blockquote><blockquote><p>One being asked what a learned man without practice resembled, replied: 'A bee without honey.'</p></blockquote><blockquote><p>Say to the rude and unkind bee,<br>'At least forbear to sting, if thou givest no honey.'</p></blockquote><p>It's a good book, there are English translations of it in the public domain. <a href=https://ebooks.adelaide.edu.au/s/saadi/s12g/complete.html target=_blank rel="noreferrer noopener">Translation from the University of Adelaide website</a> or <a href=https://archive.org/details/GulistanSaadiShirziPersianTextEnglishTranslation target=_blank rel="noreferrer noopener">Archive.org</a>.</p></div><footer><p class=meta><span class="byline author vcard">Posted by <span class=fn>Parsia</span></span><time>Apr 2, 2016</time>
<span class=categories>Tags:<a class=category href=https://parsiya.net/tags/burp>Burp</a> <a class=category href=https://parsiya.net/tags/tutorial>Tutorial</a></span></p><p class=meta><a class="basic-alignment left" href=https://parsiya.net/blog/2016-03-29-thick-client-proxying-part-2-burp-history-intruder-scanner-and-more/ title="Thick Client Proxying - Part 2: Burp History, Intruder, Scanner and More">Thick Client Proxying - Part 2: Burp History, Intruder, Scanner and More</a>
<a class="basic-alignment right" href=https://parsiya.net/blog/2016-04-03-hugo-octopress-update/ title="Hugo Octopress Update">Hugo Octopress Update</a></p></footer></article></div><aside class="sidebar thirds"><section class="first odd"><h1>Who am I?</h1><p><p>I am Parsia, a security engineer at Microsoft.</p><p>I write about application security, cryptography, static analysis, and
(of course) videogames.</p><p>Click on <a href=/about/>About Me!</a> to know more. Contact me via any of these ways.</p></p></section><ul class=sidebar-nav><li class=sidebar-nav-item><a target=_blank rel="me noopener noreferrer" href=https://infosec.exchange/@parsiya title=https://infosec.exchange/@parsiya><i class="fa fa-mastodon fa-3x"></i></a>
<a target=_blank rel="noopener noreferrer" href=https://github.com/parsiya/ title=https://github.com/parsiya/><i class="fa fa-github fa-3x"></i></a>
<a target=_blank rel="noopener noreferrer" href=https://twitter.com/cryptogangsta/ title=https://twitter.com/cryptogangsta/><i class="fa fa-twitter fa-3x"></i></a>
<a target=_blank rel="noopener noreferrer" href=https://www.linkedin.com/in/parsiya title=https://www.linkedin.com/in/parsiya><i class="fa fa-linkedin fa-3x"></i></a></li></ul><section class=odd><h1>Collections</h1><li><a href=https://parsiya.net/categories/thick-client-proxying/ title="Thick Client Proxying">Thick Client Proxying</a></li><li><a href=https://parsiya.net/categories/writeup/ title=CTFs/Writeups>CTFs/Writeups</a></li><li><a href=https://parsiya.net/categories/attack-surface-analysis/ title="Attack Surface Analysis">Attack Surface Analysis</a></li><li><a href=https://parsiya.net/categories/static-analysis/ title="Static Analysis">Static Analysis</a></li><li><a href=https://parsiya.net/categories/bug-bounty/ title="Bug Bounty">Bug Bounty</a></li><li><a href=https://parsiya.net/categories/blockchain/ title="Blockchain (lol)">Blockchain (lol)</a></li><li><a href=https://parsiya.net/categories/crypto/ title=Crypto(graphy)>Crypto(graphy)</a></li><li><a href=https://parsiya.net/categories/burp-extension/ title="Burp Extension Development">Burp Extension Development</a></li><li><a href=https://parsiya.net/categories/automation/ title=Automation>Automation</a></li><li><a href=https://parsiya.net/categories/reverse-engineering/ title="Reverse Engineering">Reverse Engineering</a></li><li><a href=https://parsiya.net/categories/winappdbg/ title="WinAppDbg (use Frida instead)">WinAppDbg (use Frida instead)</a></li><li><a href=https://awsome.pw title='AWSome.pw - S3 bucket squatting - my very "legit" branded vulnerability'>AWSome.pw - S3 bucket squatting - my very "legit" branded vulnerability</a></li></section></aside></div></div><footer role=contentinfo><p>Copyright &copy; 2025 Parsia - <a href=https://parsiya.net/license/>License</a> -
<span class=credit>Powered by <a target=_blank href=https://gohugo.io rel="noopener noreferrer">Hugo</a> and <a target=_blank href=https://github.com/parsiya/hugo-octopress/ rel="noopener noreferrer">Hugo-Octopress</a> theme.</p></footer></body></html>