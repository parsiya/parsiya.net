<!doctype html><html xmlns=http://www.w3.org/1999/xhtml xml:lang=en lang=en-us><head><meta charset=utf-8><meta name=viewport content="width=device-width,minimum-scale=1,maximum-scale=1"><link href=/css/fonts.css rel=stylesheet type=text/css><title>The Thick Client Vulns That Weren't</title><link rel=stylesheet href=/css/hugo-octopress.css><link rel=stylesheet href=/css/fork-awesome.min.css><link href=https://parsiya.net/favicon.png rel=icon><meta name=description content><meta name=keywords content="[Parsia Hakimian Parsiya infosec information security]"><meta name=author content="Parsia"><meta name=generator content="Hugo 0.97.3"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image:src content="https://parsiya.net/blog/2021-07-30-the-thick-client-vulns-that-werent/01-tweet.png"><meta name=twitter:title content="The Thick Client Vulns That Weren't"><meta name=twitter:description content="A few days ago I saw a tweet about thick client vulnerability. I am not linking
to it because it appeared to be someone new to the industry and very excited.






  
  The Original Tweet


Well, most of these are not vulnerabilities. So, I am compiling
my tweets into a blog post.
It's important that we only go after actual vulnerabilities and not spread
misinformation.
Funnily, I have talked about several of these in a separate blog post named











  
  
  
  
  




















  




No, You Are Not Getting a CVE for That"><meta name=twitter:domain content="parsiya.net"><meta name=twitter:creator content="@CryptoGangsta"></head><body><header role=banner><hgroup><h1><a href=https://parsiya.net/>Hackerman's Hacking Tutorials</a></h1><h2>The knowledge of anything, since all things have causes, is not acquired or
complete unless it is known by its causes. - Avicenna</h2></hgroup></header><nav role=navigation><fieldset class=mobile-nav><select onchange="location=this.value"><option value>Navigate…</option><option value=https://parsiya.net/about/>» About Me!</option><option value=https://parsiya.net/cheatsheet/>» Cheat Sheet</option><option value=https://parsiya.io/>» My Clone</option><option value=https://github.com/parsiya/parsiya.net>» Source Repo</option><option value="https://queue.acm.org/detail.cfm?id=3197520">» Manual Work is a Bug</option><option value="https://www.google.com/search?q=andrew+ridgeley">» The Other Guy from Wham!</option></select></fieldset><ul class=main-navigation><li><a href=https://parsiya.net/about/ title="About Me!" target=_blank rel="noopener noreferrer">About Me!</a></li><li><a href=https://parsiya.net/cheatsheet/ title="Cheat Sheet" target=_blank rel="noopener noreferrer">Cheat Sheet</a></li><li><a href=https://parsiya.io/ title="My Clone" target=_blank rel="noopener noreferrer">My Clone</a></li><li><a href=https://github.com/parsiya/parsiya.net title="Source Repo" target=_blank rel="noopener noreferrer">Source Repo</a></li><li><a href="https://queue.acm.org/detail.cfm?id=3197520" title="Manual Work is a Bug" target=_blank rel="noopener noreferrer">Manual Work is a Bug</a></li><li><a href="https://www.google.com/search?q=andrew+ridgeley" title="The Other Guy from Wham!" target=_blank rel="noopener noreferrer">The Other Guy from Wham!</a></li></ul><ul class=subscription><a href=https://parsiya.net/index.xml target=_blank type=application/rss+xml title=RSS rel="noopener noreferrer"><i class="fa fa-rss-square fa-lg"></i></a></ul><form action=https://www.google.com/search method=get target=_blank rel="noopener noreferrer"><fieldset role=search><input class=search type=text name=q results=0 placeholder=Search>
<input type=hidden name=q value=site:https://parsiya.net/></fieldset></form></nav><div id=main><div id=content><div><article class=hentry role=article><header><p class=meta>Jul 30, 2021
- 4 minute read
- <a href=https://parsiya.net/blog/2021-07-30-the-thick-client-vulns-that-werent/#disqus_thread>Comments</a>
- <a class=label href=https://parsiya.net/categories/thick-client/>Thick Client </a><a class=label href=https://parsiya.net/categories/soapbox/>Soapbox</a></p><h1 class=entry-title>The Thick Client Vulns That Weren't</h1></header><div class=entry-content><p>A few days ago I saw a tweet about thick client vulnerability. I am not linking
to it because it appeared to be someone new to the industry and very excited.</p><span class=caption-wrapper><img class=caption src=01-tweet.png title="The Original Tweet" alt="The Original Tweet">
<span class=caption-text>The Original Tweet</span></span><p>Well, most of these are not vulnerabilities. So, I am compiling
<a href=https://twitter.com/CryptoGangsta/status/1417340945415032839 target=_blank rel="noreferrer noopener">my tweets</a> into a blog post.</p><p>It's important that we only go after actual vulnerabilities and not spread
misinformation.</p><p>Funnily, I have talked about several of these in a separate blog post named
<a href=/blog/2020-07-25-no-you-are-not-getting-a-cve-for-that/ title="No, You Are Not Getting a CVE for That" rel=nofollow target=_blank>No, You Are Not Getting a CVE for That</a></p><h1 id=1-dll-hijacking---usually-not-a-vuln>1. DLL Hijacking - Usually Not a Vuln
<a class=header-link href=#1-dll-hijacking---usually-not-a-vuln><svg class="fill-current o-60 hover-accent-color-light" height="22" viewBox="0 0 24 24" width="22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="none"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h1><p>It's only a vulnerability if the application set bad ACLs on the vulnerable path
then it's not an issue. More discussion in my
<a href=/blog/2020-07-25-no-you-are-not-getting-a-cve-for-that/#dll-hijacking title="No, You Are Not Getting a CVE for That - DLL Hijacking" rel=nofollow target=_blank>previous blog post</a>.</p><h1 id=2-unquoted-service-path---rarely-a-vuln>2. Unquoted Service Path - Rarely a Vuln
<a class=header-link href=#2-unquoted-service-path---rarely-a-vuln><svg class="fill-current o-60 hover-accent-color-light" height="22" viewBox="0 0 24 24" width="22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="none"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h1><p>You don't quote a Windows service path, Windows tries to run <code>C:\program.exe</code>
and so on. Almost never a vulnerability because Standard users cannot write in
the root of the C drive and if they can, then your ACLs are wrong, not the app.
More discussion in my
<a href=/blog/2020-07-25-no-you-are-not-getting-a-cve-for-that/#unquoted-service-paths title="No, You Are Not Getting a CVE for That - Unquoted Service Paths" rel=nofollow target=_blank>previous blog post</a>.</p><h1 id=3-memory-analysis-leads-to-sensitive-information-disclosure---usually-not-a-vuln>3. Memory Analysis Leads to Sensitive Information Disclosure - Usually Not a Vuln
<a class=header-link href=#3-memory-analysis-leads-to-sensitive-information-disclosure---usually-not-a-vuln><svg class="fill-current o-60 hover-accent-color-light" height="22" viewBox="0 0 24 24" width="22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="none"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h1><p>I think this happens when sensitive information is stored in a process' memory.
Password managers are popular targets here.
<a href=https://www.ise.io/casestudies/password-manager-hacking/index.html target=_blank rel="noreferrer noopener">Password Managers: Under the Hood of Secrets Management</a> by
Independent Security Evaluators is a good example. They still have not gotten
back to me after I interviewed with them in 2013 (almost 8 years ago) so I am
technically not rejected :D.</p><p>Apart from password managers exposing the master password or very few other
applications, this is not a vulnerability for your typical thick client app. So
what if the app is storing sensitive information in the process? If you have
malware running on your machine that can snapshot memory then you have much
bigger problems.</p><h1 id=4-misconfigured-readwrite-permission-on-registries---usually-not-a-vuln>4. Misconfigured Read/Write Permission on Registries - Usually Not a Vuln
<a class=header-link href=#4-misconfigured-readwrite-permission-on-registries---usually-not-a-vuln><svg class="fill-current o-60 hover-accent-color-light" height="22" viewBox="0 0 24 24" width="22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="none"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h1><p>Registry keys have bad ACLs. There are only a few scenarios where this could be
an issue. Typically, when a higher privileged process (think Windows service
running as SYSTEM) can be influenced by modifying a registry key that can be
written by standard users. This "influencing" must lead to privilege escalation.
In other words, it needs to enable the standard user to do something they should
not be able to do.</p><p>In most cases, this is not an issue because either the registry keys are not
vulnerable or they result in something the user can already do.</p><h1 id=5-finding-api-endpoints---not-a-vuln>5. Finding API Endpoints - Not a Vuln
<a class=header-link href=#5-finding-api-endpoints---not-a-vuln><svg class="fill-current o-60 hover-accent-color-light" height="22" viewBox="0 0 24 24" width="22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="none"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h1><p>This is not a vulnerability. It's a great step in thick client analysis. The thick
client application talks to the server and we need to
<a href=/categories/thick-client-proxying/>proxy the thick client</a>.</p><p>This is something we should do. We can find unauthenticated calls,
privilege escalation (e.g., <a href=https://twitter.com/CryptoGangsta/status/1359058979033284608 target=_blank rel="noreferrer noopener">create admin as a normal user</a>), or
<a href=https://twitter.com/CryptoGangsta/status/1352818412213309441 target=_blank rel="noreferrer noopener">APIs that should not be called by user</a>.</p><h1 id=6-unencrypted-traffic---usually-a-vuln>6. Unencrypted Traffic - Usually a Vuln
<a class=header-link href=#6-unencrypted-traffic---usually-a-vuln><svg class="fill-current o-60 hover-accent-color-light" height="22" viewBox="0 0 24 24" width="22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="none"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h1><p>This one is usually a vulnerability. The most popular example is when the
application does not use TLS.</p><h1 id=7-hidden-gui-components---5050>7. Hidden GUI Components - 50/50
<a class=header-link href=#7-hidden-gui-components---5050><svg class="fill-current o-60 hover-accent-color-light" height="22" viewBox="0 0 24 24" width="22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="none"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h1><p>This is usually done by manipulating the response coming from the server or
messing with the application with tools like <a href=https://www.catch22.net/software/winspy target=_blank rel="noreferrer noopener">WinSpy</a>.</p><p>This can be a vulnerability when you enable something in the app that is
functional <strong>and</strong> lets you do something you should not be able to. The <code>and</code> is
an important part of the sentence. If we enable a button but it does nothing,
this is not a vulnerability.</p><p>For example, we modify the response from the server and set <code>admin: true</code> to
enable the admin interface in the thick client. If we can interact with the
interface and do things (e.g., send requests that are accepted server-side) then
we have a vulnerability.</p><h1 id=what-did-we-learn-here-today>What Did We Learn Here Today?
<a class=header-link href=#what-did-we-learn-here-today><svg class="fill-current o-60 hover-accent-color-light" height="22" viewBox="0 0 24 24" width="22" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="none"/><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"/></svg></a></h1><p>1.5 (#7 counts as half) out of 7 were vulnerabilities. Not so great. We should
do better.</p></div><footer><p class=meta><span class="byline author vcard">Posted by <span class=fn>Parsia</span></span>
<time>Jul 30, 2021</time></span></p><p class=meta><a class="basic-alignment left" href=https://parsiya.net/blog/2021-06-22-semgrep-the-surgical-static-analysis-tool/ title="Semgrep: The Surgical Static Analysis Tool">Semgrep: The Surgical Static Analysis Tool</a>
<a class="basic-alignment right" href=https://parsiya.net/blog/2021-09-26-attack-surface-analysis-part-3-resurrected-code-execution/ title="Attack Surface Analysis - Part 3 - Resurrected Code Execution">Attack Surface Analysis - Part 3 - Resurrected Code Execution</a></p><div id=disqus_thread></div><script type=application/javascript>window.disqus_config=function(){},function(){if(["localhost","127.0.0.1"].indexOf(window.location.hostname)!=-1){document.getElementById("disqus_thread").innerHTML="Disqus comments not available by default when the website is previewed locally.";return}var t=document,e=t.createElement("script");e.async=!0,e.src="//parsiya.disqus.com/embed.js",e.setAttribute("data-timestamp",+new Date),(t.head||t.body).appendChild(e)}()</script><noscript>Please enable JavaScript to view the <a href=https://disqus.com/?ref_noscript>comments powered by Disqus.</a></noscript><a href=https://disqus.com class=dsq-brlink>comments powered by <span class=logo-disqus>Disqus</span></a></footer></article></div><aside class="sidebar thirds"><section class="first odd"><h1>Who am I?</h1><p><p>I am Parsia, a senior security engineer at <a href=https://www.ea.com/security target=_blank rel="noreferrer noopener">Electronic Arts</a>.</p><p>I write about application security, reverse engineering,
Go, cryptography, and (obviously) videogames.</p><p>Click on <a href=/about/>About Me!</a> to know more.</p></p></section><ul class=sidebar-nav><li class=sidebar-nav-item><a target=_blank rel="noopener noreferrer" href=https://github.com/parsiya/ title=https://github.com/parsiya/><i class="fa fa-github fa-3x"></i></a>
<a target=_blank rel="noopener noreferrer" href=https://twitter.com/cryptogangsta/ title=https://twitter.com/cryptogangsta/><i class="fa fa-twitter fa-3x"></i></a>
<a target=_blank rel="noopener noreferrer" href=https://keybase.io/parsiya/ title=https://keybase.io/parsiya/><i class="fa fa-keybase fa-3x"></i></a>
<a target=_blank rel="noopener noreferrer" href=https://www.linkedin.com/in/parsiya title=https://www.linkedin.com/in/parsiya><i class="fa fa-linkedin fa-3x"></i></a></li></ul><section class=odd><h1>Collections</h1><li><a href=https://parsiya.net/categories/thick-client-proxying/ title="Thick Client Proxying">Thick Client Proxying</a></li><li><a href=https://parsiya.net/categories/writeup/ title=CTFs/Writeups>CTFs/Writeups</a></li><li><a href=https://parsiya.net/categories/attack-surface-analysis/ title="Attack Surface Analysis">Attack Surface Analysis</a></li><li><a href=https://parsiya.net/categories/bug-bounty/ title="Bug Bounty">Bug Bounty</a></li><li><a href=https://parsiya.net/categories/go/ title=Go/Golang>Go/Golang</a></li><li><a href=https://parsiya.net/categories/blockchain/ title=Blockchain>Blockchain</a></li><li><a href=https://parsiya.net/categories/burp-extension/ title="Burp Extension Development">Burp Extension Development</a></li><li><a href=https://parsiya.net/categories/automation/ title=Automation>Automation</a></li><li><a href=https://parsiya.net/categories/reverse-engineering/ title="Reverse Engineering">Reverse Engineering</a></li><li><a href=https://parsiya.net/categories/crypto/ title=Crypto(graphy)>Crypto(graphy)</a></li><li><a href=https://parsiya.net/categories/winappdbg/ title=WinAppDbg>WinAppDbg</a></li><li><a href=https://awsome.pw title="AWSome.pw - S3 bucket squatting - my very legit branded vulnerability">AWSome.pw - S3 bucket squatting - my very legit branded vulnerability</a></li></section></aside></div></div><footer role=contentinfo><p>Copyright &copy; 2022 Parsia - <a href=https://parsiya.net/license/>License</a> -
<span class=credit>Powered by <a target=_blank href=https://gohugo.io rel="noopener noreferrer">Hugo</a> and <a target=_blank href=https://github.com/parsiya/hugo-octopress/ rel="noopener noreferrer">Hugo-Octopress</a> theme.</p></footer></body></html>