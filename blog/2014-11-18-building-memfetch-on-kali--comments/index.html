<!doctype html><html xmlns=http://www.w3.org/1999/xhtml xml:lang=en lang=en-us><head><meta charset=utf-8><meta name=viewport content="width=device-width,minimum-scale=1,maximum-scale=1"><link href=/css/fonts.css rel=stylesheet type=text/css><title>Building memfetch on Kali + Comments</title><link rel=stylesheet href=/css/hugo-octopress.css><link rel=stylesheet href=/css/fork-awesome.min.css><link href=https://parsiya.net/favicon.png rel=icon><meta name=description content><meta name=keywords content="[Parsia Hakimian Parsiya infosec information security]"><meta name=author content="Parsia"><meta name=generator content="Hugo 0.119.0"><meta name=twitter:card content="summary"><meta name=twitter:title content="Building memfetch on Kali + Comments"><meta name=twitter:description content="I've used Disqus to add comments. At the moment, guests can comment and comments
do not need to be approved (unless they have links). Hopefully there won't be
much spam to sink the occasional comment that I think will be posted.
Update from 2020: Comments without approval were a mistake. I got so much spam
and harassment.
Note: I just wanted to make it work in a hurry. There are probably better ways
of doing this.
I stumbled upon the very useful tool
memfetch by the talented
lcamtuf. The utility is quite old (from 2003 if I recall correctly) and I
could not build it using the provided makefile."><meta name=twitter:domain content="parsiya.net"><meta name=twitter:creator content="@CryptoGangsta"></head><body><header role=banner><hgroup><h1><a href=https://parsiya.net/>Hackerman's Hacking Tutorials</a></h1><h2>The knowledge of anything, since all things have causes, is not acquired or
complete unless it is known by its causes. - Avicenna</h2></hgroup></header><nav role=navigation><fieldset class=mobile-nav><select onchange="location=this.value"><option value>Navigate…</option><option value=https://parsiya.net/about/>» About Me!</option><option value=https://parsiya.net/cheatsheet/>» Cheat Sheet</option><option value=https://parsiya.io/>» My Clone</option><option value=https://github.com/parsiya/parsiya.net>» Source Repo</option><option value="https://queue.acm.org/detail.cfm?id=3197520">» Manual Work is a Bug</option><option value="https://www.google.com/search?q=andrew+ridgeley">» The Other Guy from Wham!</option></select></fieldset><ul class=main-navigation><li><a href=https://parsiya.net/about/ title="About Me!" target=_blank rel="noopener noreferrer">About Me!</a></li><li><a href=https://parsiya.net/cheatsheet/ title="Cheat Sheet" target=_blank rel="noopener noreferrer">Cheat Sheet</a></li><li><a href=https://parsiya.io/ title="My Clone" target=_blank rel="noopener noreferrer">My Clone</a></li><li><a href=https://github.com/parsiya/parsiya.net title="Source Repo" target=_blank rel="noopener noreferrer">Source Repo</a></li><li><a href="https://queue.acm.org/detail.cfm?id=3197520" title="Manual Work is a Bug" target=_blank rel="noopener noreferrer">Manual Work is a Bug</a></li><li><a href="https://www.google.com/search?q=andrew+ridgeley" title="The Other Guy from Wham!" target=_blank rel="noopener noreferrer">The Other Guy from Wham!</a></li></ul><ul class=subscription><a href=https://parsiya.net/index.xml target=_blank type=application/rss+xml title=RSS rel="noopener noreferrer"><i class="fa fa-rss-square fa-lg"></i></a></ul><form action=https://www.google.com/search method=get target=_blank rel="noopener noreferrer"><fieldset role=search><input class=search type=text name=q results=0 placeholder=Search>
<input type=hidden name=q value=site:https://parsiya.net/></fieldset></form></nav><div id=main><div id=content><div><article class=hentry role=article><header><p class=meta>Nov 18, 2014
- 2 minute read
- <a href=https://parsiya.net/blog/2014-11-18-building-memfetch-on-kali--comments/#disqus_thread>Comments</a>
- <a class=label href=https://parsiya.net/categories/forensics/>Forensics</a></p><h1 class=entry-title>Building memfetch on Kali + Comments</h1></header><div class=entry-content><p>I've used Disqus to add comments. At the moment, guests can comment and comments
do not need to be approved (unless they have links). Hopefully there won't be
much spam to sink the occasional comment that I think will be posted.</p><p>Update from 2020: Comments without approval were a mistake. I got so much spam
and harassment.</p><p>Note: I just wanted to make it work in a hurry. There are probably better ways
of doing this.</p><p>I stumbled upon the very useful tool
<a href=http://lcamtuf.coredump.cx/soft/memfetch.tgz target=_blank rel="noreferrer noopener">memfetch</a> by the talented
<em>lcamtuf</em>. The utility is quite old (from 2003 if I recall correctly) and I
could not build it using the provided makefile.</p><figure class=code><figcaption><span>errors while building memfetch</span></figcaption><div class=codewrapper><div class=highlight><div style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#495050">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#495050">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#495050">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#495050">4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#495050">5
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ make
</span></span><span style=display:flex><span>gcc -Wall -O9    memfetch.c   -o memfetch
</span></span><span style=display:flex><span>memfetch.c:30:22: fatal error: asm/page.h: No such file or directory
</span></span><span style=display:flex><span>compilation terminated.
</span></span><span style=display:flex><span>make: *** <span style=color:#719e07>[</span>memfetch<span style=color:#719e07>]</span> Error <span style=color:#2aa198>1</span></span></span></code></pre></td></tr></table></div></div></div></figure><p>Seems like the location of header files have moved since then.
<a href=http://stackoverflow.com/a/19310710 target=_blank rel="noreferrer noopener">This stackoverflow answer</a> mentions
removing <code>asm/page.h</code> and adding <code>linux/types.h</code>. Let's see what happens:</p><figure class=code><figcaption><span>more errors</span></figcaption><div class=codewrapper><div class=highlight><div style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#495050">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#495050">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#495050">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#495050">4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#495050">5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#495050">6
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ make
</span></span><span style=display:flex><span>gcc -Wall -O9    memfetch.c   -o memfetch
</span></span><span style=display:flex><span>memfetch.c: In <span style=color:#719e07>function</span> <span style=color:#2aa198>&#39;main&#39;</span>:
</span></span><span style=display:flex><span>memfetch.c:284:25: error: <span style=color:#2aa198>&#39;PAGE_SIZE&#39;</span> undeclared <span style=color:#719e07>(</span>first use in this <span style=color:#719e07>function</span><span style=color:#719e07>)</span>
</span></span><span style=display:flex><span>memfetch.c:284:25: note: each undeclared identifier is reported only once <span style=color:#719e07>for</span> each <span style=color:#719e07>function</span> it appears in
</span></span><span style=display:flex><span>make: *** <span style=color:#719e07>[</span>memfetch<span style=color:#719e07>]</span> Error <span style=color:#2aa198>1</span></span></span></code></pre></td></tr></table></div></div></div></figure><p>The <code>page.h</code> file is located at
<code>/usr/src/linux-headers-3.12-kali1-common/include/asm-generic/page.h</code> on Kali
linux. This is where <code>PAGE_SIZE</code> is defined. Just adding it to <code>memfetch.c</code>
along with changing <code>#include &lt;asm/page.h></code> to <code>#include &lt;linux/types.h></code>
will do the trick.</p><figure class=code><figcaption><span>additions to memfetch.c</span></figcaption><div class=codewrapper><div class=highlight><div style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#495050"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#495050"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#495050"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#495050"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#495050"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#495050"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#495050"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#495050"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#495050"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#495050">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#495050">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#495050">12
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>// <span style=color:#586e75>#include &lt;asm/page.h&gt;</span>
</span></span><span style=display:flex><span><span style=color:#586e75>#include &lt;linux/types.h&gt;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>// Copied from asm-generic/page.h
</span></span><span style=display:flex><span>/* PAGE_SHIFT determines the page size */
</span></span><span style=display:flex><span><span style=color:#586e75>#define PAGE_SHIFT	12</span>
</span></span><span style=display:flex><span><span style=color:#586e75>#ifdef __ASSEMBLY__</span>
</span></span><span style=display:flex><span><span style=color:#586e75>#define PAGE_SIZE	(1 &lt;&lt; PAGE_SHIFT)</span>
</span></span><span style=display:flex><span><span style=color:#586e75>#else</span>
</span></span><span style=display:flex><span><span style=color:#586e75>#define PAGE_SIZE	(1UL &lt;&lt; PAGE_SHIFT)</span>
</span></span><span style=display:flex><span><span style=color:#586e75>#endif</span>
</span></span><span style=display:flex><span><span style=color:#586e75>#define PAGE_MASK	(~(PAGE_SIZE-1))</span></span></span></code></pre></td></tr></table></div></div></div></figure><p>If there is a better way to make this work, please let me know.</p></div><footer><p class=meta><span class="byline author vcard">Posted by <span class=fn>Parsia</span></span>
<time>Nov 18, 2014</time>
<span class=categories>Tags:
<a class=category href=https://parsiya.net/tags/memfetch>Memfetch</a> <a class=category href=https://parsiya.net/tags/kali>Kali</a></span></p><p class=meta><a class="basic-alignment left" href=https://parsiya.net/blog/2014-09-23-my-adventure-with-fireeye-flare-challenge/ title="My Adventure with Fireeye FLARE Challenge">My Adventure with Fireeye FLARE Challenge</a>
<a class="basic-alignment right" href=https://parsiya.net/blog/2014-12-08-pin-adventures-chapter-1-pinsolver-mk1/ title="Pin Adventures - Chapter 1 - PinSolver Mk1">Pin Adventures - Chapter 1 - PinSolver Mk1</a></p><div id=disqus_thread></div><script type=application/javascript>window.disqus_config=function(){},function(){if(["localhost","127.0.0.1"].indexOf(window.location.hostname)!=-1){document.getElementById("disqus_thread").innerHTML="Disqus comments not available by default when the website is previewed locally.";return}var t=document,e=t.createElement("script");e.async=!0,e.src="//parsiya.disqus.com/embed.js",e.setAttribute("data-timestamp",+new Date),(t.head||t.body).appendChild(e)}()</script><noscript>Please enable JavaScript to view the <a href=https://disqus.com/?ref_noscript>comments powered by Disqus.</a></noscript><a href=https://disqus.com class=dsq-brlink>comments powered by <span class=logo-disqus>Disqus</span></a></footer></article></div><aside class="sidebar thirds"><section class="first odd"><h1>Who am I?</h1><p><p>I am Parsia, an application security engineer.</p><p>I write about application security, cryptography, static analysis, and
(of course) videogames.</p><p>Click on <a href=/about/>About Me!</a> to know more.</p></p></section><ul class=sidebar-nav><li class=sidebar-nav-item><a target=_blank rel="me noopener noreferrer" href=https://infosec.exchange/@parsiya title=https://infosec.exchange/@parsiya><i class="fa fa-mastodon fa-3x"></i></a>
<a target=_blank rel="noopener noreferrer" href=https://github.com/parsiya/ title=https://github.com/parsiya/><i class="fa fa-github fa-3x"></i></a>
<a target=_blank rel="noopener noreferrer" href=https://twitter.com/cryptogangsta/ title=https://twitter.com/cryptogangsta/><i class="fa fa-twitter fa-3x"></i></a>
<a target=_blank rel="noopener noreferrer" href=https://www.linkedin.com/in/parsiya title=https://www.linkedin.com/in/parsiya><i class="fa fa-linkedin fa-3x"></i></a></li></ul><section class=odd><h1>Collections</h1><li><a href=https://parsiya.net/categories/thick-client-proxying/ title="Thick Client Proxying">Thick Client Proxying</a></li><li><a href=https://parsiya.net/categories/writeup/ title=CTFs/Writeups>CTFs/Writeups</a></li><li><a href=https://parsiya.net/categories/attack-surface-analysis/ title="Attack Surface Analysis">Attack Surface Analysis</a></li><li><a href=https://parsiya.net/categories/semgrep/ title=Semgrep>Semgrep</a></li><li><a href=https://parsiya.net/categories/bug-bounty/ title="Bug Bounty">Bug Bounty</a></li><li><a href=https://parsiya.net/categories/blockchain/ title="Blockchain (lol)">Blockchain (lol)</a></li><li><a href=https://parsiya.net/categories/crypto/ title=Crypto(graphy)>Crypto(graphy)</a></li><li><a href=https://parsiya.net/categories/burp-extension/ title="Burp Extension Development">Burp Extension Development</a></li><li><a href=https://parsiya.net/categories/automation/ title=Automation>Automation</a></li><li><a href=https://parsiya.net/categories/reverse-engineering/ title="Reverse Engineering">Reverse Engineering</a></li><li><a href=https://parsiya.net/categories/winappdbg/ title="WinAppDbg (use Frida instead)">WinAppDbg (use Frida instead)</a></li><li><a href=https://awsome.pw title='AWSome.pw - S3 bucket squatting - my very "legit" branded vulnerability'>AWSome.pw - S3 bucket squatting - my very "legit" branded vulnerability</a></li></section></aside></div></div><footer role=contentinfo><p>Copyright &copy; 2023 Parsia - <a href=https://parsiya.net/license/>License</a> -
<span class=credit>Powered by <a target=_blank href=https://gohugo.io rel="noopener noreferrer">Hugo</a> and <a target=_blank href=https://github.com/parsiya/hugo-octopress/ rel="noopener noreferrer">Hugo-Octopress</a> theme.</p></footer></body></html>