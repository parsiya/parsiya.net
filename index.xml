<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>Hackerman's Hacking Tutorials</title><link>https://parsiya.net/</link><description>Recent content on Hackerman's Hacking Tutorials</description><generator>Hugo -- gohugo.io</generator><language>en-us</language><lastBuildDate>Mon, 20 Dec 2021 03:22:10 -0800</lastBuildDate><atom:link href="https://parsiya.net/index.xml" rel="self" type="application/rss+xml"/><item><title>RCE in Visual Studio Code's Remote WSL for Fun and Negative Profit</title><link>https://parsiya.net/blog/2021-12-20-rce-in-visual-studio-codes-remote-wsl-for-fun-and-negative-profit/</link><pubDate>Mon, 20 Dec 2021 03:22:10 -0800</pubDate><guid>https://parsiya.net/blog/2021-12-20-rce-in-visual-studio-codes-remote-wsl-for-fun-and-negative-profit/</guid><description>&lt;p>The Visual Studio Code server in Windows Subsystem for Linux uses a local
WebSocket WebSocket connection to communicate with the &lt;code>Remote WSL&lt;/code> extension.
JavaScript in websites can connect to this server and execute arbitrary commands
on the target system. Assigned &lt;a href="https://msrc.microsoft.com/update-guide/en-US/vulnerability/CVE-2021-43907" target="_blank" rel="noreferrer noopener">CVE-2021-43907&lt;/a> and zero bounty. I paid 5
USD for the EC2 machine hosting the proof-of-concept.&lt;/p>
&lt;p>It's really funny that PlayStation paid 15K USD for &lt;a href="https://hackerone.com/reports/873614" target="_blank" rel="noreferrer noopener">almost the same bug&lt;/a>
with 2.2 million subscribers (it was out of scope in their program, too), but
MSFT doesn't pay for an official extension with more than 10 million installs
(obviously, not every install is unique) for one of their most popular products.
But you are not here to listen to my rants. So, read on.&lt;/p>
&lt;p>This post's target audience was &lt;code>Desktop Application Security People&lt;/code> niche. I
want to clarify some issues because more people have read it (edit on 2021-12-21):&lt;/p>
&lt;ol>
&lt;li>I didn't get 5 dollars. I paid 5 dollars out of pocket, so it's -5.&lt;/li>
&lt;li>&amp;quot;I am not angry, I am just disappointed.&amp;quot; I knew it was out-of-scope. This
wasn't some bait-and-switch by Microsoft. I am not angry&lt;/li>
&lt;li>The vuln is &lt;strong>not&lt;/strong> in VS Code. MSFT says it's in the &lt;code>Remote WSL&lt;/code> extension
but I think it's in the way &lt;code>VS Code Server&lt;/code> works with the remote
development extensions.&lt;/li>
&lt;/ol>
&lt;p>HackerNews link: &lt;a href="https://news.ycombinator.com/item?id=29635300" target="_blank" rel="noreferrer noopener">https://news.ycombinator.com/item?id=29635300&lt;/a>.&lt;/p></description></item><item><title>A Hands-On Intro to Semgrep's Autofix</title><link>https://parsiya.net/blog/2021-10-25-a-hands-on-intro-to-semgreps-autofix/</link><pubDate>Mon, 25 Oct 2021 20:00:47 -0700</pubDate><guid>https://parsiya.net/blog/2021-10-25-a-hands-on-intro-to-semgreps-autofix/</guid><description>&lt;p>Semgrep's experimental &lt;a href="https://semgrep.dev/docs/experiments/overview/#autofix" target="_blank" rel="noreferrer noopener">autofix&lt;/a> feature can automagically
modify vulnerable code. A few things can be fixed like this but it's worth
exploring. This post is an introduction to creating fixes for your Semgrep
rules.&lt;/p>
&lt;p>I have included links to the playground for practicing. If you prefer
running the rules via the command-line please see the rules and code at
&lt;a href="https://github.com/parsiya/Parsia-Code/tree/master/semgrep-autofix" target="_blank" rel="noreferrer noopener">https://github.com/parsiya/Parsia-Code/tree/master/semgrep-autofix&lt;/a>.&lt;/p></description></item><item><title>Modify GitLab Repositories from the CI Pipeline</title><link>https://parsiya.net/blog/2021-10-11-modify-gitlab-repositories-from-the-ci-pipeline/</link><pubDate>Mon, 11 Oct 2021 01:12:58 -0700</pubDate><guid>https://parsiya.net/blog/2021-10-11-modify-gitlab-repositories-from-the-ci-pipeline/</guid><description>&lt;p>You would think modifying a GitLab repository from its CI job should be
straightforward. Well, it's not. Here's how I did it.&lt;/p></description></item><item><title>Attack Surface Analysis - Part 3 - Resurrected Code Execution</title><link>https://parsiya.net/blog/2021-09-26-attack-surface-analysis-part-3-resurrected-code-execution/</link><pubDate>Sun, 26 Sep 2021 20:50:38 -0700</pubDate><guid>https://parsiya.net/blog/2021-09-26-attack-surface-analysis-part-3-resurrected-code-execution/</guid><description>&lt;p>In part 3 of my attack surface analysis series, I will discuss an undisclosed RCE.
This bug uses a combination of all tricks introduced in
&lt;a href="https://parsiya.net/blog/2021-03-17-attack-surface-analysis-part-2-custom-protocol-handlers/" title="Attack Surface Analysis - Part 2 - Custom Protocol Handlers" rel="nofollow" target="_blank">part 2 of the series&lt;/a>.&lt;/p>
&lt;p>We will see command-line switch injection from a custom protocol handler,
loading remote files, reversing a custom scripting engine to instrument the
application, and log file injection. Pretty nice chain if I may say so.&lt;/p></description></item><item><title>The Thick Client Vulns That Weren't</title><link>https://parsiya.net/blog/2021-07-30-the-thick-client-vulns-that-werent/</link><pubDate>Fri, 30 Jul 2021 20:30:59 -0700</pubDate><guid>https://parsiya.net/blog/2021-07-30-the-thick-client-vulns-that-werent/</guid><description>&lt;p>A few days ago I saw a tweet about thick client vulnerability. I am not linking
to it because it appeared to be someone new to the industry and very excited.&lt;/p>
&lt;span class="caption-wrapper">
&lt;img class="caption" src="01-tweet.png" title="The Original Tweet" alt="The Original Tweet">
&lt;span class="caption-text">The Original Tweet&lt;/span>
&lt;/span>
&lt;p>Well, most of these are not vulnerabilities. So, I am compiling
&lt;a href="https://twitter.com/CryptoGangsta/status/1417340945415032839" target="_blank" rel="noreferrer noopener">my tweets&lt;/a> into a blog post.&lt;/p>
&lt;p>It's important that we only go after actual vulnerabilities and not spread
misinformation.&lt;/p>
&lt;p>Funnily, I have talked about several of these in a separate blog post named
&lt;a href="https://parsiya.net/blog/2020-07-25-no-you-are-not-getting-a-cve-for-that/" title="No, You Are Not Getting a CVE for That" rel="nofollow" target="_blank">No, You Are Not Getting a CVE for That&lt;/a>&lt;/p></description></item><item><title>Semgrep: The Surgical Static Analysis Tool</title><link>https://parsiya.net/blog/2021-06-22-semgrep-the-surgical-static-analysis-tool/</link><pubDate>Tue, 22 Jun 2021 18:42:06 -0700</pubDate><guid>https://parsiya.net/blog/2021-06-22-semgrep-the-surgical-static-analysis-tool/</guid><description>&lt;h1 id="why-are-we-here">Why are We Here?
&lt;a class="header-link" href="#why-are-we-here">&lt;svg class="fill-current o-60 hover-accent-color-light" height="22px" viewBox="0 0 24 24" width="22px" xmlns="http://www.w3.org/2000/svg">&lt;path d="M0 0h24v24H0z" fill="none"/>&lt;path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76 0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71 0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71 0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76 0 5-2.24 5-5s-2.24-5-5-5z"/>&lt;/svg>&lt;/a>
&lt;/h1>&lt;p>What this blog is about:&lt;/p>
&lt;ol>
&lt;li>Why I like Semgrep.&lt;/li>
&lt;li>Why I think you should use it.&lt;/li>
&lt;li>How I use Semgrep.&lt;/li>
&lt;/ol>
&lt;p>What this blog is not about:&lt;/p>
&lt;ol>
&lt;li>What static analysis is.&lt;/li>
&lt;li>Semgrep tutorial.&lt;/li>
&lt;/ol></description></item><item><title>The JavaScript Bridge in Modern Desktop Applications</title><link>https://parsiya.net/blog/2021-06-08-the-javascript-bridge-in-modern-desktop-applications/</link><pubDate>Tue, 08 Jun 2021 00:53:25 -0700</pubDate><guid>https://parsiya.net/blog/2021-06-08-the-javascript-bridge-in-modern-desktop-applications/</guid><description>&lt;p>We have an XSS in a desktop application, what happens next? How can you
escalate it to remote code execution? Let's see.&lt;/p></description></item><item><title>Public Remote File Share in The Cloud</title><link>https://parsiya.net/blog/2021-05-31-public-remote-file-share-in-the-cloud/</link><pubDate>Mon, 31 May 2021 10:20:40 -0700</pubDate><guid>https://parsiya.net/blog/2021-05-31-public-remote-file-share-in-the-cloud/</guid><description>&lt;p>In
&lt;a href="https://parsiya.net/blog/2021-03-17-attack-surface-analysis-part-2-custom-protocol-handlers/" title="Attack Surface Analysis - Part 2 - Custom Protocol Handlers" rel="nofollow" target="_blank">Part 2 of the Attack Surface Analysis series&lt;/a>
I talked about how passing a remote file with a UNC path can lead to unexpected
results.&lt;/p>
&lt;p>I am documenting how I created a share using an EC2 instance. This guide is for
AWS, but it's a Linux machine running in the cloud. You can easily replicate it.&lt;/p></description></item><item><title>Testing Extensions in Chromium Browsers - Nordpass</title><link>https://parsiya.net/blog/2021-04-30-testing-extensions-in-chromium-browsers-nordpass/</link><pubDate>Fri, 30 Apr 2021 14:20:40 -0700</pubDate><guid>https://parsiya.net/blog/2021-04-30-testing-extensions-in-chromium-browsers-nordpass/</guid><description>&lt;p>Recently, I looked at the &lt;a href="https://chrome.google.com/webstore/detail/nordpass%C2%AE-password-manage/fooolghllnmhmmndgjiamiiodkpenpbb" target="_blank" rel="noreferrer noopener">NordPass Password Manager browser extension&lt;/a>.
I could not find any guides on manual testing of browser extensions. I decided
to write my own. So, here we are, &amp;quot;pushing the boundaries of science.&amp;quot;&lt;/p></description></item><item><title>Attack Surface Analysis - Part 2 - Custom Protocol Handlers</title><link>https://parsiya.net/blog/2021-03-17-attack-surface-analysis-part-2-custom-protocol-handlers/</link><pubDate>Wed, 17 Mar 2021 15:14:00 -0800</pubDate><guid>https://parsiya.net/blog/2021-03-17-attack-surface-analysis-part-2-custom-protocol-handlers/</guid><description>&lt;p>Custom protocol handlers are an obscure attack surface. They allow us to convert
local attacks into remote ones and are an alternative way to
&lt;a href="https://parsiya.net/blog/2020-08-13-localghost-escaping-the-browser-sandbox-without-0-days/" title="jump the browser sandbox without 0days" rel="nofollow" target="_blank">jump the browser sandbox without 0days&lt;/a>).&lt;/p>
&lt;p>Similar to the first part of this series
&lt;a href="https://parsiya.net/blog/2021-01-08-attack-surface-analysis-part-1-application-update-a-novel-way-to-bypass-executable-signature-checks-with-electron/" title="A Novel Way to Bypass Executable Signature Checks with Electron" rel="nofollow" target="_blank">A Novel Way to Bypass Executable Signature Checks with Electron&lt;/a>
I will analyze this attack surface and discuss a few interesting public bugs. I
wanted to discuss two of my undisclosed bugs but the post is already too long.&lt;/p>
&lt;p>&lt;strong>2021-04-21 updates&lt;/strong>:&lt;/p>
&lt;ol>
&lt;li>Startup path limitations and possible workarounds.&lt;/li>
&lt;li>Positive security's excellent blog released a month after this with a near
jar trick.&lt;/li>
&lt;li>&lt;a href="https://positive.security/blog/url-open-rce" target="_blank" rel="noreferrer noopener">Allow arbitrary URLs, expect arbitrary code execution&lt;/a>.&lt;/li>
&lt;/ol>
&lt;p>The article has a great trick for passing parameters when we cannot. Use &lt;code>jar&lt;/code>
files in UNC paths: &lt;code>\\ip\path\whatever.jar&lt;/code>. Search for &lt;code>windows-10-19042&lt;/code> in
the page.&lt;/p></description></item><item><title>Automagically Deploying Websites with Custom Domains to GitHub Pages</title><link>https://parsiya.net/blog/2021-02-17-automagically-deploying-websites-with-custom-domains-to-github-pages/</link><pubDate>Wed, 17 Feb 2021 09:56:33 -0800</pubDate><guid>https://parsiya.net/blog/2021-02-17-automagically-deploying-websites-with-custom-domains-to-github-pages/</guid><description>&lt;p>Recently, I have started moving my non-critical websites to GitHub pages. I am
documenting the process in one place for future me.&lt;/p></description></item><item><title>Some SANS Holiday Hack 2020 Solutions</title><link>https://parsiya.net/blog/2021-01-17-some-sans-holiday-hack-2020-solutions/</link><pubDate>Sun, 17 Jan 2021 11:33:47 -0800</pubDate><guid>https://parsiya.net/blog/2021-01-17-some-sans-holiday-hack-2020-solutions/</guid><description>&lt;p>This year like last year and unlike 2018, I only did a few of the SANS Holiday
Hack challenges. I got invited into this private bug bounty program with a
desktop application in scope (those are quite rare) so I had to poke at it. To
be fair, I hit the motherlode and submitted $10K of bounties.&lt;/p>
&lt;p>Previous writeups:&lt;/p>
&lt;ul>
&lt;li>
&lt;a href="https://parsiya.net/blog/2019-01-15-sans-holiday-hack-challenge-2018-solutions/" title="SANS Holiday Hack 2018 Solutions" rel="nofollow" target="_blank">SANS Holiday Hack 2018 Solutions&lt;/a>&lt;/li>
&lt;li>
&lt;a href="https://parsiya.net/blog/2020-01-15-some-sans-holiday-hack-2019-solutions/" title="Some SANS Holiday Hack 2019 Solutions" rel="nofollow" target="_blank">Some SANS Holiday Hack 2019 Solutions&lt;/a>&lt;/li>
&lt;/ul></description></item><item><title>Attack Surface Analysis - Part 1 - Application Update:
'A Novel Way to Bypass Executable Signature Checks with Electron'</title><link>https://parsiya.net/blog/2021-01-08-attack-surface-analysis-part-1-application-update-a-novel-way-to-bypass-executable-signature-checks-with-electron/</link><pubDate>Fri, 08 Jan 2021 22:33:32 -0800</pubDate><guid>https://parsiya.net/blog/2021-01-08-attack-surface-analysis-part-1-application-update-a-novel-way-to-bypass-executable-signature-checks-with-electron/</guid><description>&lt;p>A few months ago I found a way to subvert the update process of an Electron
application to get local privilege escalation. The application stores the
updater under a path where standard users have write access. But it also
checked if the executable was signed by the vendor. I managed to bypass the
signing using a backdoored Electron application.&lt;/p></description></item><item><title>The $15000 PlayStation Bounty</title><link>https://parsiya.net/blog/2021-01-01-the-15000-playstation-bounty/</link><pubDate>Fri, 01 Jan 2021 15:29:00 -0800</pubDate><guid>https://parsiya.net/blog/2021-01-01-the-15000-playstation-bounty/</guid><description>&lt;p>Earlier in December 2020, my &lt;code>PlayStation Now&lt;/code> report was disclosed. You can see
the report at &lt;a href="https://hackerone.com/reports/873614" target="_blank" rel="noreferrer noopener">https://hackerone.com/reports/873614&lt;/a>. That is my first paid bounty
and my first disclosed report. It was quite exciting. I doubt I can top it.&lt;/p></description></item><item><title>Customizing Python's SimpleHTTPServer</title><link>https://parsiya.net/blog/2020-11-15-customizing-pythons-simplehttpserver/</link><pubDate>Sun, 15 Nov 2020 20:57:46 -0800</pubDate><guid>https://parsiya.net/blog/2020-11-15-customizing-pythons-simplehttpserver/</guid><description>&lt;p>The other day I customized the Python built-in SimpleHTTPServer with some
routes. I did not find a lot of info about it (most use it to serve files). This
is how I did some basic customization.&lt;/p></description></item><item><title>The Same-Origin Policy Gone Wild</title><link>https://parsiya.net/blog/2020-11-01-the-same-origin-policy-gone-wild/</link><pubDate>Sun, 01 Nov 2020 20:02:53 -0800</pubDate><guid>https://parsiya.net/blog/2020-11-01-the-same-origin-policy-gone-wild/</guid><description>&lt;p>I will talk about some edge cases of the Same-Origin Policy (SOP). It affects
browser based thickclient platforms so it's not just for web application
security. This is a more detailed dive into this topic that I touched briefly in
the &lt;a href="https://youtu.be/Cgl51ZcACLg?t=90" target="_blank" rel="noreferrer noopener">localghost&lt;/a> talk.&lt;/p></description></item><item><title>localghost: Escaping the Browser Sandbox Without 0-Days</title><link>https://parsiya.net/blog/2020-08-13-localghost-escaping-the-browser-sandbox-without-0-days/</link><pubDate>Thu, 13 Aug 2020 20:38:06 -0700</pubDate><guid>https://parsiya.net/blog/2020-08-13-localghost-escaping-the-browser-sandbox-without-0-days/</guid><description>&lt;p>I had the hono(u)r of presenting in the &lt;a href="https://www.appsecvillage.com/agenda/2020/localghost-escaping-the-browser-sandbox-without-0-days" target="_blank" rel="noreferrer noopener">DEF CON 28 Appsec village&lt;/a>.
Unfortunately, my super-duper awesome &lt;a href="https://hackerone.com/reports/873614" target="_blank" rel="noreferrer noopener">$15K PlayStation bug&lt;/a> was not
disclosed yet so I did not talk about it. Be sure to read it, it's great.&lt;/p>
&lt;ul>
&lt;li>&lt;a href="parsia-dc2020-appsec-village-localghost.pdf">Slides in PDF&lt;/a>&lt;/li>
&lt;li>Youtube link: &lt;a href="https://youtu.be/Cgl51ZcACLg?t=90" target="_blank" rel="noreferrer noopener">https://youtu.be/Cgl51ZcACLg?t=90&lt;/a>&lt;/li>
&lt;/ul>
&lt;div style="position: relative; padding-bottom: 56.25%; height: 0; overflow: hidden;">
&lt;iframe src="https://www.youtube-nocookie.com/embed/Cgl51ZcACLg?start=90" style="position: absolute; top: 0; left: 0; width: 100%; height: 100%; border:0;" allowfullscreen title="Parsia Hakimian - localghost: Escaping Browser Sandbox Without 0-Days - DEF CON 28SM AppSec Village">&lt;/iframe>
&lt;/div></description></item><item><title>No, You Are Not Getting a CVE for That</title><link>https://parsiya.net/blog/2020-07-25-no-you-are-not-getting-a-cve-for-that/</link><pubDate>Sat, 25 Jul 2020 16:21:15 -0700</pubDate><guid>https://parsiya.net/blog/2020-07-25-no-you-are-not-getting-a-cve-for-that/</guid><description>&lt;p>An intentionally insecure system is insecure. As [Raymond Chen says]
(&lt;a href="https://devblogs.microsoft.com/oldnewthing/?p=18593%29" target="_blank" rel="noreferrer noopener">https://devblogs.microsoft.com/oldnewthing/?p=18593)&lt;/a>, &amp;quot;You can't make up for
the absence of any actual vulnerability by piling on style points and cranking
up the degree of difficulty.&amp;quot;&lt;/p></description></item><item><title>Thick Client Proxying - Part 11 - GOG Galaxy and Extract-SNI</title><link>https://parsiya.net/blog/2020-06-22-thick-client-proxying-part-11-gog-galaxy-and-extract-sni/</link><pubDate>Mon, 22 Jun 2020 09:49:35 -0700</pubDate><guid>https://parsiya.net/blog/2020-06-22-thick-client-proxying-part-11-gog-galaxy-and-extract-sni/</guid><description>&lt;p>In this post we will use our knowledge from
&lt;a href="https://parsiya.net/blog/2020-05-09-thick-client-proxying-part-10-the-hosts-file/" title="Thick Client Proxying - Part 10 - The hosts File" rel="nofollow" target="_blank">Thick Client Proxying - Part 10 - The hosts File&lt;/a>
to proxy GOG Galaxy 2. I will also introduce
&lt;a href="https://github.com/parsiya/extract-sni" target="_blank" rel="noreferrer noopener">some automation&lt;/a> to make our lives easier.&lt;/p></description></item><item><title>Go Slices and Their Oddities</title><link>https://parsiya.net/blog/2020-05-17-go-slices-and-their-oddities/</link><pubDate>Sun, 17 May 2020 22:37:21 -0700</pubDate><guid>https://parsiya.net/blog/2020-05-17-go-slices-and-their-oddities/</guid><description>&lt;p>A friend pointed me to this &lt;a href="https://medium.com/@gotzmann/so-you-think-you-know-go-c5164b0d0511" target="_blank" rel="noreferrer noopener">Go quiz about slices&lt;/a> by
&lt;a href="https://github.com/gotzmann" target="_blank" rel="noreferrer noopener">Serge Gotsuliak&lt;/a>. It's an interesting exercise and points out the
intricacies of Go slices. I decided to explore it in detail. These oddities
might have security implications.&lt;/p></description></item><item><title>Thick Client Proxying - Part 10 - The hosts File</title><link>https://parsiya.net/blog/2020-05-09-thick-client-proxying-part-10-the-hosts-file/</link><pubDate>Sat, 09 May 2020 13:01:59 -0700</pubDate><guid>https://parsiya.net/blog/2020-05-09-thick-client-proxying-part-10-the-hosts-file/</guid><description>&lt;p>Welcome to the 10th installment of
&lt;a href="https://parsiya.net/categories/thick-client-proxying/" title="Thick Client Proxying">Thick Client Proxying&lt;/a>.
A series running since 2016. Woot! Today I will talk about traffic redirection
using the &lt;code>hosts&lt;/code> file.&lt;/p></description></item><item><title>Towards a Quieter Burp History</title><link>https://parsiya.net/blog/2020-05-01-towards-a-quieter-burp-history/</link><pubDate>Fri, 01 May 2020 23:13:24 -0700</pubDate><guid>https://parsiya.net/blog/2020-05-01-towards-a-quieter-burp-history/</guid><description>&lt;p>This is how I reduce the noise in Burp's HTTP history when testing thick
clients. You can use the methods here to create your own Burp configuration file
or build upon the one I have created. I am going to identify common noisy
requests that appear in Windows and then ignore them in Burp.&lt;/p></description></item><item><title>The Encrypted Logz - Some Simple Reverse Engineering</title><link>https://parsiya.net/blog/2020-04-17-the-encrypted-logz-some-simple-reverse-engineering/</link><pubDate>Fri, 17 Apr 2020 17:30:22 -0700</pubDate><guid>https://parsiya.net/blog/2020-04-17-the-encrypted-logz-some-simple-reverse-engineering/</guid><description>&lt;p>I was looking at an application (not related to my day job) and I decided to
reverse engineer how it creates logs. I cannot name the app (yet) but hopefully,
this is useful.&lt;/p></description></item><item><title>The Golang int and the Overlooked Bug</title><link>https://parsiya.net/blog/2020-04-05-the-golang-int-and-the-overlooked-bug/</link><pubDate>Sun, 05 Apr 2020 01:19:36 -0700</pubDate><guid>https://parsiya.net/blog/2020-04-05-the-golang-int-and-the-overlooked-bug/</guid><description>&lt;p>This blog is about a &lt;a href="https://securitylab.github.com/" target="_blank" rel="noreferrer noopener">GitHub Security Lab&lt;/a> &lt;code>Spot The Bug&lt;/code>
challenge that had an overlooked bug. &lt;a href="https://twitter.com/GHSecurityLab" target="_blank" rel="noreferrer noopener">Github Security Lab's Twitter account&lt;/a>
tweets code snippets from time to time. The challenge is to spot the bug.&lt;/p>
&lt;p>&lt;strong>Disclosure&lt;/strong>: I might be completely wrong because we only have access to the
snippet in the picture and people at the GitHub Security Lab are better than me
in static analysis.&lt;/p></description></item><item><title>Time Management For Systems Administrators - Lessons Learned</title><link>https://parsiya.net/blog/2020-03-13-time-management-for-systems-administrators-lessons-learned/</link><pubDate>Fri, 13 Mar 2020 19:25:18 -0700</pubDate><guid>https://parsiya.net/blog/2020-03-13-time-management-for-systems-administrators-lessons-learned/</guid><description>&lt;p>A while ago I read &lt;a href="https://everythingsysadmin.com/books.html" target="_blank" rel="noreferrer noopener">Time Management for System Administrators&lt;/a> by
&lt;a href="https://twitter.com/yesthattom" target="_blank" rel="noreferrer noopener">Tom Limoncelli&lt;/a>. This blog is my reviewed notes.&lt;/p>
&lt;p>You can find my raw notes in my clone at:&lt;/p>
&lt;ul>
&lt;li>&lt;a href="https://parsiya.io/automation/time-management-sysadmins-notes/" target="_blank" rel="noreferrer noopener">https://parsiya.io/automation/time-management-sysadmins-notes/&lt;/a>&lt;/li>
&lt;/ul>
&lt;p>Tom is also the author of one of my favorite articles
&lt;a href="https://queue.acm.org/detail.cfm?id=3197520" target="_blank" rel="noreferrer noopener">Manual Work is a Bug&lt;/a>.&lt;/p>
&lt;p>I have written about it:&lt;/p>
&lt;ul>
&lt;li>&lt;a href="https://parsiya.net/blog/2018-10-03-reflections-on-manual-work-is-a-bug/" title="Reflections on &amp;#39;Manual Work is a Bug&amp;#39;">Reflections on 'Manual Work is a Bug'&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://parsiya.net/blog/2019-04-17-the-dark-side-of-manual-work-is-a-bug/" title="The Dark Side of &amp;#39;Manual Work is a Bug&amp;#39;">The Dark Side of 'Manual Work is a Bug'&lt;/a>&lt;/li>
&lt;/ul></description></item><item><title>Old ContextIS Challenge Solutions</title><link>https://parsiya.net/blog/2020-02-09-old-contextis-challenge-solutions/</link><pubDate>Sun, 09 Feb 2020 19:08:07 -0800</pubDate><guid>https://parsiya.net/blog/2020-02-09-old-contextis-challenge-solutions/</guid><description>&lt;p>A few years ago I did the &lt;a href="https://www.contextis.com/en/" target="_blank" rel="noreferrer noopener">Context Information Security&lt;/a>
challenges. They used it for recruiting so I never published the results.
However, they have now switched to &lt;a href="https://www.hackthebox.eu/" target="_blank" rel="noreferrer noopener">Hack The Box&lt;/a> and the old
challenges are gone. So I am publishing what I did.&lt;/p>
&lt;p>You can see the page with the old challenges using the Wayback Machine at:&lt;/p>
&lt;ul>
&lt;li>&lt;a href="http://web.archive.org/web/20181012035146/https://www.contextis.com/en/careers/challenges" target="_blank" rel="noreferrer noopener">http://web.archive.org/web/20181012035146/https://www.contextis.com/en/careers/challenges&lt;/a>&lt;/li>
&lt;/ul>
&lt;p>I also did some of their &lt;a href="https://parsiya.net/blog/2018-06-05-contextis-xmas-ctf-writeup/" title="xmas 2018 challenges">xmas 2018 challenges&lt;/a>.&lt;/p></description></item><item><title>Documentation Writing for System Administrators - Notes</title><link>https://parsiya.net/blog/2020-02-06-documentation-writing-for-system-administrators-notes/</link><pubDate>Thu, 06 Feb 2020 23:21:57 -0800</pubDate><guid>https://parsiya.net/blog/2020-02-06-documentation-writing-for-system-administrators-notes/</guid><description>&lt;p>These are my notes for the booklet &lt;code>Documentation Writing for System Administrtors&lt;/code>.
It's from 2003, so some of the tools and procedures are old. However, somethings
never change and it's still useful.&lt;/p>
&lt;ul>
&lt;li>&lt;a href="https://www.usenix.org/short-topics/documentation-writing-system-administrators" target="_blank" rel="noreferrer noopener">https://www.usenix.org/short-topics/documentation-writing-system-administrators&lt;/a>&lt;/li>
&lt;/ul></description></item><item><title>Some SANS Holiday Hack 2019 Solutions</title><link>https://parsiya.net/blog/2020-01-15-some-sans-holiday-hack-2019-solutions/</link><pubDate>Wed, 15 Jan 2020 00:09:11 -0800</pubDate><guid>https://parsiya.net/blog/2020-01-15-some-sans-holiday-hack-2019-solutions/</guid><description>&lt;p>I did some of the solutions for the SANS Holiday Hack Challenge of 2019. Last
year I participated for the first time. You can find the solutions below:&lt;/p>
&lt;ul>
&lt;li>&lt;a href="https://parsiya.net/blog/2019-01-15-sans-holiday-hack-challenge-2018-solutions/" title="SANS Holiday Hack 2018 Solutions">SANS Holiday Hack 2018 Solutions&lt;/a>&lt;/li>
&lt;/ul></description></item><item><title>Using Mozilla Rhino to Run JavaScript in Java</title><link>https://parsiya.net/blog/2019-12-22-using-mozilla-rhino-to-run-javascript-in-java/</link><pubDate>Sun, 22 Dec 2019 20:13:09 -0800</pubDate><guid>https://parsiya.net/blog/2019-12-22-using-mozilla-rhino-to-run-javascript-in-java/</guid><description>&lt;p>This post discusses what I learned about executing JavaScript code in Java
with Mozilla Rhino. By the end of this post, you will know:&lt;/p>
&lt;ol>
&lt;li>What Rhino is.&lt;/li>
&lt;li>How to use Rhino in your Java application (e.g., a Burp extension).&lt;/li>
&lt;li>Some tips and tricks when dealing with Rhino.&lt;/li>
&lt;li>Alternative options to using Rhino.&lt;/li>
&lt;/ol>
&lt;p>Code is at:&lt;/p>
&lt;ul>
&lt;li>&lt;a href="https://github.com/parsiya/Parsia-Code/tree/master/java-rhino" target="_blank" rel="noreferrer noopener">https://github.com/parsiya/Parsia-Code/tree/master/java-rhino&lt;/a>&lt;/li>
&lt;/ul></description></item><item><title>Developing and Debugging Java Burp Extensions with Visual Studio Code</title><link>https://parsiya.net/blog/2019-12-02-developing-and-debugging-java-burp-extensions-with-visual-studio-code/</link><pubDate>Mon, 02 Dec 2019 19:32:09 -0800</pubDate><guid>https://parsiya.net/blog/2019-12-02-developing-and-debugging-java-burp-extensions-with-visual-studio-code/</guid><description>&lt;p>A few days ago, I released the &lt;a href="https://github.com/parsiya/bug-diaries" target="_blank" rel="noreferrer noopener">Bug Diaries&lt;/a>
Burp extension. It's a Burp extension that aims to mimic Burp issues for the
community (free) version. For reasons, I decided to rewrite it in Java. This is
the first part of my series on what I learned switching to Java.&lt;/p>
&lt;p>This part discusses how my environment is set up for development with
&lt;a href="https://code.visualstudio.com/" target="_blank" rel="noreferrer noopener">Visual Studio Code&lt;/a>. Things like
auto-completion, Gradle builds and most importantly debugging.&lt;/p>
&lt;p>Clone the repository to skip some of the steps in the blog. I still recommend
doing them yourself if you are not familiar with Gradle and Burp development,
clone the following repository:&lt;/p>
&lt;ul>
&lt;li>&lt;a href="https://github.com/parsiya/burp-sample-extension-java" target="_blank" rel="noreferrer noopener">https://github.com/parsiya/burp-sample-extension-java&lt;/a>&lt;/li>
&lt;/ul></description></item><item><title>Swing in Python Burp Extensions - Part 3 - Tips and Tricks</title><link>https://parsiya.net/blog/2019-11-26-swing-in-python-burp-extensions-part-3-tips-and-tricks/</link><pubDate>Tue, 26 Nov 2019 00:24:37 -0800</pubDate><guid>https://parsiya.net/blog/2019-11-26-swing-in-python-burp-extensions-part-3-tips-and-tricks/</guid><description>&lt;p>In the two previous parts, we learned about Jython Swing. Those blogs take a lot
of time to write. I think each of them took around 10 hours. I do not want to
spend that kind of time but I still want to document what I have learned.&lt;/p>
&lt;p>In this blog I will write tips and tricks with a small code snippet instead of
creating a complete extension.&lt;/p>
&lt;p>Did I tell you I release &lt;a href="https://github.com/parsiya/bug-diaries" target="_blank" rel="noreferrer noopener">Bug Diaries&lt;/a>,
it's a Python Burp extension that aims to bring Burp issues to the community
version. It's pretty neat.&lt;/p>
&lt;ul>
&lt;li>&lt;a href="https://parsiya.net/blog/2019-11-04-swing-in-python-burp-extensions-part-1/" title="Swing in Python Burp Extensions - Part 1">Swing in Python Burp Extensions - Part 1&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://parsiya.net/blog/2019-11-11-swing-in-python-burp-extensions-part-2-netbeans-and-tablemodels/" title="Swing in Python Burp Extensions - Part 2 - NetBeans and TableModels">Swing in Python Burp Extensions - Part 2 - NetBeans and TableModels&lt;/a>&lt;/li>
&lt;/ul></description></item><item><title>Swing in Python Burp Extensions - Part 2 - NetBeans and TableModels</title><link>https://parsiya.net/blog/2019-11-11-swing-in-python-burp-extensions-part-2-netbeans-and-tablemodels/</link><pubDate>Mon, 11 Nov 2019 12:00:53 -0800</pubDate><guid>https://parsiya.net/blog/2019-11-11-swing-in-python-burp-extensions-part-2-netbeans-and-tablemodels/</guid><description>&lt;p>In &lt;a href="https://parsiya.net/blog/2019-11-04-swing-in-python-burp-extensions-part-1/" title="Swing
in Python Burp Extensions - Part 1">part 1&lt;/a> we discussed handcrafting Swing GUI items
in a form. In this part, we will design a GUI using
&lt;a href="https://netbeans.org/" target="_blank" rel="noreferrer noopener">NetBeans&lt;/a> and then convert it to Jython. Then use it in
a Burp tab. Next, we will create a custom table model based on objects to handle
our issues.&lt;/p>
&lt;p>Code is at:&lt;/p>
&lt;ul>
&lt;li>&lt;a href="https://github.com/parsiya/Parsia-Code/tree/master/jython-swing-2" target="_blank" rel="noreferrer noopener">https://github.com/parsiya/Parsia-Code/tree/master/jython-swing-2&lt;/a>&lt;/li>
&lt;/ul></description></item><item><title>Swing in Python Burp Extensions - Part 1</title><link>https://parsiya.net/blog/2019-11-04-swing-in-python-burp-extensions-part-1/</link><pubDate>Mon, 04 Nov 2019 00:40:42 -0700</pubDate><guid>https://parsiya.net/blog/2019-11-04-swing-in-python-burp-extensions-part-1/</guid><description>&lt;p>&lt;strong>TL;DR:&lt;/strong> What I learned from creating handcrafted GUIs for Python Burp
extensions using Swing. Code is at:&lt;/p>
&lt;ul>
&lt;li>&lt;a href="https://github.com/parsiya/Parsia-Code/tree/master/jython-swing-1" target="_blank" rel="noreferrer noopener">https://github.com/parsiya/Parsia-Code/tree/master/jython-swing-1&lt;/a>&lt;/li>
&lt;/ul></description></item><item><title>Quality of Life Tips and Tricks - Burp Suite</title><link>https://parsiya.net/blog/2019-10-13-quality-of-life-tips-and-tricks-burp-suite/</link><pubDate>Sun, 13 Oct 2019 20:48:26 -0700</pubDate><guid>https://parsiya.net/blog/2019-10-13-quality-of-life-tips-and-tricks-burp-suite/</guid><description>Quality of life patch/update in the context of videogames is a patch that focuses on fixing bugs instead of introducing new content. New features in these patches are not ground-breaking but rather making the game easier to play1.
I have been using these things to make my life easier. I am publishing them gradually and will refine them into one final page similar to the cheatsheet. This page also pairs really well with automation.</description></item><item><title>Disabling Cascade Fan's Beep</title><link>https://parsiya.net/blog/2019-07-28-disabling-cascade-fans-beep/</link><pubDate>Sun, 28 Jul 2019 13:23:50 -0700</pubDate><guid>https://parsiya.net/blog/2019-07-28-disabling-cascade-fans-beep/</guid><description>&lt;p>&lt;strong>TL;DR&lt;/strong>:&lt;/p>
&lt;ol>
&lt;li>Open 11 screws.&lt;/li>
&lt;li>Remove the cap on the buzzer.&lt;/li>
&lt;li>Done.&lt;/li>
&lt;/ol></description></item><item><title>Chaining Three Bugs to Get RCE in Microsoft AttackSurfaceAnalyzer</title><link>https://parsiya.net/blog/2019-06-18-chaining-three-bugs-to-get-rce-in-microsoft-attacksurfaceanalyzer/</link><pubDate>Tue, 18 Jun 2019 13:03:53 -0700</pubDate><guid>https://parsiya.net/blog/2019-06-18-chaining-three-bugs-to-get-rce-in-microsoft-attacksurfaceanalyzer/</guid><description>&lt;p>This is a blog post about how I found three vulns and chained them to get RCE in
the Microsoft
&lt;a href="https://github.com/microsoft/AttackSurfaceAnalyzer" target="_blank" rel="noreferrer noopener">AttackSurfaceAnalyzer&lt;/a> (ASA
moving forward) GUI version.&lt;/p>
&lt;ol>
&lt;li>ASA uses &lt;a href="https://github.com/ElectronNET/Electron.NET" target="_blank" rel="noreferrer noopener">Electron.NET&lt;/a> which
binds the internal Kestrel web server to &lt;code>0.0.0.0&lt;/code>. If permission is given to
bypass the Windows OS firewall (or if used on an OS without one), a remote
attacker can connect to it and access the application.&lt;/li>
&lt;li>The web application is vulnerable to Cross-Site Scripting (XSS). A remote
attacker can submit a runID with embedded JavaScript that is executed by
the victim using the ASA Electron application.&lt;/li>
&lt;li>Electron.NET does not have the &lt;code>NodeIntegration&lt;/code> flag set to false. This
allows the JavaScript payload to spawn up processes on the victim's machine.&lt;/li>
&lt;/ol></description></item><item><title>Thick Client Proxying - Part 9 - The Windows DNS Cache</title><link>https://parsiya.net/blog/2019-04-28-thick-client-proxying-part-9-the-windows-dns-cache/</link><pubDate>Sun, 28 Apr 2019 13:35:00 -0700</pubDate><guid>https://parsiya.net/blog/2019-04-28-thick-client-proxying-part-9-the-windows-dns-cache/</guid><description>&lt;p>This post explains a trick that I have been using for a few years to discover
application endpoints on Windows quickly.&lt;/p>
&lt;p>It's a simple trick:&lt;/p>
&lt;ol>
&lt;li>Clear the DNS cache.&lt;/li>
&lt;li>Take a snapshot of the cache.&lt;/li>
&lt;li>Run the application and use different functionalities.&lt;/li>
&lt;li>Take another snapshot of the cache.&lt;/li>
&lt;li>Compare these two snapshots.&lt;/li>
&lt;li>???&lt;/li>
&lt;li>Discover (most) endpoints.&lt;/li>
&lt;/ol>
&lt;p>Code is at:&lt;/p>
&lt;ul>
&lt;li>&lt;a href="https://github.com/parsiya/Parsia-Code/tree/master/dns-cache" target="_blank" rel="noreferrer noopener">https://github.com/parsiya/Parsia-Code/tree/master/dns-cache&lt;/a>&lt;/li>
&lt;/ul></description></item><item><title>Disabling Burp's Update Screen - Part 1 - Analysis and Failures</title><link>https://parsiya.net/blog/2019-04-21-disabling-burps-update-screen-part-1-analysis-and-failures/</link><pubDate>Sun, 21 Apr 2019 14:58:50 -0700</pubDate><guid>https://parsiya.net/blog/2019-04-21-disabling-burps-update-screen-part-1-analysis-and-failures/</guid><description>&lt;p>I tried to disable Burp's update nag screen and failed. This blog post describes
the analysis and my effort to date.&lt;/p>
&lt;p>Hacky Workaround: Block outgoing requests to &lt;code>54.246.133.196&lt;/code> but this will
also, block installing extensions from the Burp app store.&lt;/p>
&lt;p>Part two (if there is one) will discuss more things that I tried and did not
work and/or what worked and how you can disable it.&lt;/p></description></item><item><title>The Dark Side of "Manual Work is a Bug"</title><link>https://parsiya.net/blog/2019-04-17-the-dark-side-of-manual-work-is-a-bug/</link><pubDate>Wed, 17 Apr 2019 19:12:33 -0700</pubDate><guid>https://parsiya.net/blog/2019-04-17-the-dark-side-of-manual-work-is-a-bug/</guid><description>&lt;p>This is a revisit of &lt;a href="https://queue.acm.org/detail.cfm?id=3197520" target="_blank" rel="noreferrer noopener">Manual Work is a Bug&lt;/a>
during my ramp up at my &lt;a href="https://twitter.com/CryptoGangsta/status/1109185306295746563" target="_blank" rel="noreferrer noopener">new job&lt;/a>.
I will discuss my experience doing some automation at my previous job and the
flip side to the utopia painted by the article.&lt;/p></description></item><item><title>Hiding OPTIONS - An Adventure in Dealing with Burp Proxy in an Extension</title><link>https://parsiya.net/blog/2019-04-06-hiding-options-an-adventure-in-dealing-with-burp-proxy-in-an-extension/</link><pubDate>Sat, 06 Apr 2019 15:30:16 -0700</pubDate><guid>https://parsiya.net/blog/2019-04-06-hiding-options-an-adventure-in-dealing-with-burp-proxy-in-an-extension/</guid><description>&lt;p>&lt;strong>TL;DR&lt;/strong>: No matter what you do, your Burp extension cannot modify requests before they hit the HTTP History panel. You can modify requests after that and before they are sent out. We will discuss two ways to modify them with extensions. While the Match/Replace functionality is special, it has the same limitation (note how it has a separate tab that says &lt;code>auto-modified&lt;/code>?).&lt;/p>
&lt;p>Update October 2019: Latest version using &lt;a href="https://github.com/parsiya/burputils/" target="_blank" rel="noreferrer noopener">burputils&lt;/a> is at:&lt;/p>
&lt;ul>
&lt;li>&lt;a href="https://github.com/parsiya/Parsia-Code/tree/master/burp-filter-options" target="_blank" rel="noreferrer noopener">https://github.com/parsiya/Parsia-Code/tree/master/burp-filter-options&lt;/a>&lt;/li>
&lt;/ul></description></item><item><title>path.Join Considered Harmful</title><link>https://parsiya.net/blog/2019-03-09-path.join-considered-harmful/</link><pubDate>Sat, 09 Mar 2019 20:43:40 -0500</pubDate><guid>https://parsiya.net/blog/2019-03-09-path.join-considered-harmful/</guid><description>&lt;p>Credit goes to my friend &lt;a href="https://www.linkedin.com/in/stark-riedesel-4162b846" target="_blank" rel="noreferrer noopener">Stark Riedesel&lt;/a>. Check out his &lt;a href="https://github.com/starkriedesel/" target="_blank" rel="noreferrer noopener">github profile&lt;/a>. One of these days I will bully him into reviving his blog.&lt;/p>
&lt;p>TL;DR: Instead of &lt;a href="https://golang.org/pkg/path/#Join" target="_blank" rel="noreferrer noopener">path.join&lt;/a> use &lt;a href="https://golang.org/pkg/path/filepath/" target="_blank" rel="noreferrer noopener">filepath.Join&lt;/a>.&lt;/p></description></item><item><title>Cheating at Moonlighter - Part 4 - Defense</title><link>https://parsiya.net/blog/2019-01-31-cheating-at-moonlighter-part-4-defense/</link><pubDate>Thu, 31 Jan 2019 21:11:32 -0500</pubDate><guid>https://parsiya.net/blog/2019-01-31-cheating-at-moonlighter-part-4-defense/</guid><description>&lt;p>I am going to talk about defense. This is a mainly non-technical post. It's a bit different from other posts on this topic and in general. With the existence of a trainer and the debug HUD, I decided to can the idea of using Cheat Engine on Moonlighter.&lt;/p>
&lt;p>Other parts:&lt;/p>
&lt;ul>
&lt;li>&lt;a href="https://parsiya.net/blog/2019-01-23-cheating-at-moonlighter-part-1-save-file/" title="Cheating at Moonlighter - Part 1 - Save File">Cheating at Moonlighter - Part 1 - Save File&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://parsiya.net/blog/2019-01-27-cheating-at-moonlighter-part-2-changing-game-logic-with-dnspy/" title="Cheating at Moonlighter - Part 2 - Changing Game Logic with dnSpy">Cheating at Moonlighter - Part 2 - Changing Game Logic with dnSpy&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://parsiya.net/blog/2019-01-29-cheating-at-moonlighter-part-3-enabling-debug-hud/" title="Cheating at Moonlighter - Part 3 - Enabling Debug HUD">Cheating at Moonlighter - Part 3 - Enabling Debug HUD&lt;/a>&lt;/li>
&lt;/ul></description></item><item><title>Cheating at Moonlighter - Part 3 - Enabling Debug HUD</title><link>https://parsiya.net/blog/2019-01-29-cheating-at-moonlighter-part-3-enabling-debug-hud/</link><pubDate>Tue, 29 Jan 2019 22:52:01 -0500</pubDate><guid>https://parsiya.net/blog/2019-01-29-cheating-at-moonlighter-part-3-enabling-debug-hud/</guid><description>&lt;p>In this part, I am going to use dnSpy to enable the Debug HUD. We will analyze how it's enabled and how it can be accessed.&lt;/p>
&lt;ul>
&lt;li>&lt;a href="https://parsiya.net/blog/2019-01-23-cheating-at-moonlighter-part-1-save-file/" title="Cheating at Moonlighter - Part 1 - Save File">Cheating at Moonlighter - Part 1 - Save File&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://parsiya.net/blog/2019-01-27-cheating-at-moonlighter-part-2-changing-game-logic-with-dnspy/" title="Cheating at Moonlighter - Part 2 - Changing Game Logic with dnSpy">Cheating at Moonlighter - Part 2 - Changing Game Logic with dnSpy&lt;/a>&lt;/li>
&lt;/ul></description></item><item><title>Cheating at Moonlighter - Part 2 - Changing Game Logic with dnSpy</title><link>https://parsiya.net/blog/2019-01-27-cheating-at-moonlighter-part-2-changing-game-logic-with-dnspy/</link><pubDate>Sun, 27 Jan 2019 20:47:30 -0500</pubDate><guid>https://parsiya.net/blog/2019-01-27-cheating-at-moonlighter-part-2-changing-game-logic-with-dnspy/</guid><description>&lt;p>In part 1 we messed a bit with Moonlighter but modifying the save file. In this part, we will modify game logic using dnSpy.&lt;/p>
&lt;p>We will modify our damage, player stats and discover a hidden stat.&lt;/p></description></item><item><title>Cheating at Moonlighter - Part 1 - Save File</title><link>https://parsiya.net/blog/2019-01-23-cheating-at-moonlighter-part-1-save-file/</link><pubDate>Wed, 23 Jan 2019 20:03:08 -0500</pubDate><guid>https://parsiya.net/blog/2019-01-23-cheating-at-moonlighter-part-1-save-file/</guid><description>&lt;p>&lt;a href="http://moonlighterthegame.com/" target="_blank" rel="noreferrer noopener">Moonlighter&lt;/a> is a nice game. Over the new year break, I played it for 10 hours a day for 2-3 days. It's your typical dungeon crawler with a twist. You have a shop and you can sell items in your shop and do a bit of price manipulation based on supply and demand.&lt;/p>
&lt;p>It has some grinding. At each dungeon level (there are four), you have grind the items needed for crafting the next level equipment. After farming for multiple hours to get a few drops of one item, I decided to cheat at it.&lt;/p>
&lt;p>This post talks about how I discovered the save file and how we can modify it to give ourselves any item in the game. In the next part, I will discuss modifying the game to one-shot enemies and other things. It's a straightforward game for getting into &amp;quot;game hacking.&amp;quot;&lt;/p></description></item><item><title>Notes on Escaping Python Shells</title><link>https://parsiya.net/blog/2019-01-19-notes-on-escaping-python-shells/</link><pubDate>Sat, 19 Jan 2019 22:29:43 -0500</pubDate><guid>https://parsiya.net/blog/2019-01-19-notes-on-escaping-python-shells/</guid><description>&lt;p>During the &lt;a href="https://parsiya.net/blog/2019-01-15-sans-holiday-hack-challenge-2018-solutions/" title="SANS Holiday Hack Challenge 2018">SANS Holiday Hack Challenge 2018&lt;/a>, I viewed a talk by &lt;a href="https://twitter.com/markbaggett" target="_blank" rel="noreferrer noopener">Mark Baggett&lt;/a> about escaping Python shells. These are my notes.&lt;/p>
&lt;ul>
&lt;li>Talk: &lt;a href="https://www.youtube.com/watch?v=ZVx2Sxl3B9c" target="_blank" rel="noreferrer noopener">https://www.youtube.com/watch?v=ZVx2Sxl3B9c&lt;/a>&lt;/li>
&lt;li>Code: &lt;a href="https://gist.github.com/MarkBaggett/dd440362f8a443d644b913acadff9499" target="_blank" rel="noreferrer noopener">https://gist.github.com/MarkBaggett/dd440362f8a443d644b913acadff9499&lt;/a>&lt;/li>
&lt;/ul>
&lt;p>It's part of &lt;a href="https://www.sans.org/course/automating-information-security-with-python" target="_blank" rel="noreferrer noopener">SANS SEC573: Automating Information Security with Python&lt;/a> which looks interesting. Although, I am Go fanatic and will probably will never be able to afford to course anyways. Creating a Go version of the course sounds fun.&lt;/p></description></item><item><title>SANS Holiday Hack Challenge 2018 Solutions</title><link>https://parsiya.net/blog/2019-01-15-sans-holiday-hack-challenge-2018-solutions/</link><pubDate>Tue, 15 Jan 2019 19:33:21 -0500</pubDate><guid>https://parsiya.net/blog/2019-01-15-sans-holiday-hack-challenge-2018-solutions/</guid><description>&lt;p>SANS Holiday hack challenge 2018 was fun. It was also the first one I tried. I liked the talks and that the challenges were accessible to most skill levels. I mean &lt;a href="https://abiondo.me/2019/01/02/exploiting-math-expm1-v8/" target="_blank" rel="noreferrer noopener">RCE through the -0 bug in v8 is great and all&lt;/a> but I want people to be able to have fun and learn new skills.&lt;/p>
&lt;p>If being a security consultant has taught me anything, it's that no one has time to read your 100 page report. So here are some quick solutions. I will post my notes from the Youtube videos in different posts.&lt;/p></description></item><item><title>Cloudflare Concise Christmas Cryptography Challenges 2019 Solutions</title><link>https://parsiya.net/blog/2019-01-03-cloudflare-concise-christmas-cryptography-challenges-2019-solutions/</link><pubDate>Thu, 03 Jan 2019 20:24:15 -0500</pubDate><guid>https://parsiya.net/blog/2019-01-03-cloudflare-concise-christmas-cryptography-challenges-2019-solutions/</guid><description>&lt;p>Cloudflare had a &lt;a href="https://blog.cloudflare.com/christmas-cryptography-challenges-2019/" target="_blank" rel="noreferrer noopener">Christmas crypto(graphy) challenge&lt;/a>. Here are my solutions. The first two questions were pretty easy but the 3rd sent me down on a rabbit hole. Apparently, only 15 people solved it which places me in the world top 15 cryptographers (that's how it works right?).&lt;/p></description></item><item><title>Cryptography in Python Burp Extensions</title><link>https://parsiya.net/blog/2018-12-24-cryptography-in-python-burp-extensions/</link><pubDate>Mon, 24 Dec 2018 01:00:14 -0500</pubDate><guid>https://parsiya.net/blog/2018-12-24-cryptography-in-python-burp-extensions/</guid><description>&lt;p>In this post, I will discuss a few tricks for creating Burp extensions in Python that deal with cryptography. Our example is a Burp extension that adds a new tab to decode and decrypt an application's traffic. This allows us to modify payloads on the fly and take advantage of Repeater (and other tabs). I have used similar extensions when testing mobile and thickclient applications.&lt;/p>
&lt;p>The code is at:&lt;/p>
&lt;ul>
&lt;li>&lt;a href="https://github.com/parsiya/Parsia-Code/tree/master/python-burp-crypto" target="_blank" rel="noreferrer noopener">https://github.com/parsiya/Parsia-Code/tree/master/python-burp-crypto&lt;/a>&lt;/li>
&lt;/ul></description></item><item><title>AES-CFB128: PyCrypto vs. Go</title><link>https://parsiya.net/blog/2018-12-22-aes-cfb128-pycrypto-vs.-go/</link><pubDate>Sat, 22 Dec 2018 19:25:10 -0500</pubDate><guid>https://parsiya.net/blog/2018-12-22-aes-cfb128-pycrypto-vs.-go/</guid><description>&lt;p>We have encrypted something with AES-CFB128 in Go. How can we decrypt it with PyCrypto?&lt;/p>
&lt;p>This was originally part of the next blog post (about creating Python Burp extensions) but it grew large enough to be a separate post.&lt;/p>
&lt;p>Disclaimer: I am not knowledgeable enough to explain cryptography to people. Read actual papers/books/articles to figure things out. If you find mistakes here, please let me know.&lt;/p>
&lt;p>Code is at: &lt;a href="https://github.com/parsiya/Go-Security/tree/master/aes-cfb128" target="_blank" rel="noreferrer noopener">https://github.com/parsiya/Go-Security/tree/master/aes-cfb128&lt;/a>&lt;/p></description></item><item><title>Python Utility Modules for Burp Extensions</title><link>https://parsiya.net/blog/2018-12-19-python-utility-modules-for-burp-extensions/</link><pubDate>Wed, 19 Dec 2018 22:48:10 -0500</pubDate><guid>https://parsiya.net/blog/2018-12-19-python-utility-modules-for-burp-extensions/</guid><description>&lt;p>We can create and load Python/Java utility modules in Burp and then use them in extensions. It's a somewhat unknown/unused capability in Burp's Python/Java extensions.&lt;/p>
&lt;p>&lt;strong>Note:&lt;/strong> Alternatively, the modules can be placed in the same path as the extension and loaded/used the same way. For example, instead of putting the Burp Exceptions file in the modules folder, store it in the extension directory.&lt;/p></description></item><item><title>Tiredful API - Part 2 - Comparing Site Maps with Burp</title><link>https://parsiya.net/blog/2018-12-17-tiredful-api-part-2-comparing-site-maps-with-burp/</link><pubDate>Mon, 17 Dec 2018 01:11:11 -0500</pubDate><guid>https://parsiya.net/blog/2018-12-17-tiredful-api-part-2-comparing-site-maps-with-burp/</guid><description>&lt;p>In &lt;a href="https://parsiya.net/blog/2018-12-11-tiredful-api-part-1-burp-session-validation-with-macros/" title="Burp Session Validation with Macros">Part 1 - Burp Session Validation with Macros&lt;/a> I discussed using Burp macros to validate sessions. In this part, I will show how to use Burp's sitemap comparison to detect forced browsing/access control/direct object reference issues and the like.&lt;/p>
&lt;p>The flow is straightforward:&lt;/p>
&lt;ol>
&lt;li>Navigate around the application as user1. Personally, I just do my normal testing for a couple of days.&lt;/li>
&lt;li>Set a session handling rule to do one of the two:
&lt;ol>
&lt;li>Update the cookie from the cookie jar. In this case you login as user2 first and let Burp update cookies.&lt;/li>
&lt;li>Run a macro to create a valid session for user2 and use the token.&lt;/li>
&lt;/ol>
&lt;/li>
&lt;li>Tell Burp to compare site maps.&lt;/li>
&lt;/ol>
&lt;p>Also, read these:&lt;/p>
&lt;ul>
&lt;li>&lt;a href="https://portswigger.net/burp/documentation/desktop/tools/target/site-map/comparing" target="_blank" rel="noreferrer noopener">https://portswigger.net/burp/documentation/desktop/tools/target/site-map/comparing&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://support.portswigger.net/customer/portal/articles/1969844-using-burp-s-site-map-to-test-for-access-control-issues" target="_blank" rel="noreferrer noopener">https://support.portswigger.net/customer/portal/articles/1969844-using-burp-s-site-map-to-test-for-access-control-issues&lt;/a>&lt;/li>
&lt;/ul></description></item><item><title>Tiredful API - Part 1 - Burp Session Validation with Macros</title><link>https://parsiya.net/blog/2018-12-11-tiredful-api-part-1-burp-session-validation-with-macros/</link><pubDate>Tue, 11 Dec 2018 00:15:07 -0500</pubDate><guid>https://parsiya.net/blog/2018-12-11-tiredful-api-part-1-burp-session-validation-with-macros/</guid><description>&lt;p>&lt;a href="https://github.com/payatu/Tiredful-API" target="_blank" rel="noreferrer noopener">Tiredful API&lt;/a> is an intentionally vulnerable REST API. I am going to use it to practice a bunch of Burp tricks.&lt;/p>
&lt;p>In this part, I want to show how to use Burp macros to detect invalid session and add a custom bearer token header to the requests.&lt;/p></description></item><item><title>Cheap Integrity Checks with HEAD</title><link>https://parsiya.net/blog/2018-12-04-cheap-integrity-checks-with-head/</link><pubDate>Tue, 04 Dec 2018 22:51:03 -0500</pubDate><guid>https://parsiya.net/blog/2018-12-04-cheap-integrity-checks-with-head/</guid><description>&lt;p>&lt;strong>tl;dr:&lt;/strong> HEAD returns file size in &lt;code>Content-Length&lt;/code> response header.&lt;/p>
&lt;p>A few months ago, I did a side project of creating a Go package for npm. It was before the current dumpster fire that is &lt;a href="https://github.com/dominictarr/event-stream/issues/116" target="_blank" rel="noreferrer noopener">event-stream&lt;/a>. The idea was to be able to query npm and get information and packages.&lt;/p></description></item><item><title>Pointers Inside for</title><link>https://parsiya.net/blog/2018-11-18-pointers-inside-for/</link><pubDate>Sun, 18 Nov 2018 16:57:24 -0500</pubDate><guid>https://parsiya.net/blog/2018-11-18-pointers-inside-for/</guid><description>&lt;p>Do not directly assign the for counter/range variables to a slice as pointers. Read this by Jon Calhoun &lt;a href="https://www.calhoun.io/gotchas-and-common-mistakes-with-closures-in-go/#variables-declared-in-for-loops-are-passed-by-reference" target="_blank" rel="noreferrer noopener">Variables declared in for loops are passed by reference&lt;/a>. &amp;quot;[...] the variables aren't being redeclared with each iteration [...]&amp;quot;.&lt;/p>
&lt;p>I have written so much buggy code that I am going to write this down.&lt;/p></description></item><item><title>filepath.Ext Notes</title><link>https://parsiya.net/blog/2018-11-10-filepath.ext-notes/</link><pubDate>Sat, 10 Nov 2018 00:59:58 -0500</pubDate><guid>https://parsiya.net/blog/2018-11-10-filepath.ext-notes/</guid><description>&lt;p>The &lt;a href="https://golang.org/pkg/path/filepath/" target="_blank" rel="noreferrer noopener">filepath&lt;/a> package has some functions for processing paths and filenames. I am using it extensively in a current project. You can do cool stuff with it, like &lt;a href="https://parsiya.net/blog/2018-10-06-gophercises-lessons-learned/#filepath-walk" title="filepath.Walk">traversing a path recursively with filepath.Walk&lt;/a>.&lt;/p>
&lt;p>&lt;a href="https://golang.org/pkg/path/filepath/#Ext" target="_blank" rel="noreferrer noopener">filepath.Ext&lt;/a> returns the extension of a filename (or path). It returns whatever is after the last dot. It has some gotchas that might have security implications.&lt;/p>
&lt;p>Code is at: &lt;a href="https://github.com/parsiya/Parsia-Code/tree/master/filepath-ext" target="_blank" rel="noreferrer noopener">https://github.com/parsiya/Parsia-Code/tree/master/filepath-ext&lt;/a>&lt;/p></description></item><item><title>Windows Filetime Timestamps and Byte Wrangling with Go</title><link>https://parsiya.net/blog/2018-11-01-windows-filetime-timestamps-and-byte-wrangling-with-go/</link><pubDate>Thu, 01 Nov 2018 08:05:47 -0400</pubDate><guid>https://parsiya.net/blog/2018-11-01-windows-filetime-timestamps-and-byte-wrangling-with-go/</guid><description>&lt;p>For a side project, I have to parse timestamps in a file. These timestamps are in the Windows Filetime format. This post documents what I have learned about them and how they can be converted to a Golang &lt;a href="https://golang.org/pkg/time/#Time" target="_blank" rel="noreferrer noopener">time.Time&lt;/a> and then converted to any desirable format after that.&lt;/p>
&lt;p>We will start by looking at endian-ness and use a real-world example to practice our newly acquired knowledge.&lt;/p>
&lt;p>&lt;strong>TL;DR: To convert a Windows Filetime to Go's time.Time:&lt;/strong>&lt;/p>
&lt;ol>
&lt;li>Read 8 bytes in LittleEndian from the file.&lt;/li>
&lt;li>Create a &lt;code>syscall.Filetime&lt;/code>.
&lt;ul>
&lt;li>Assign the first 4 bytes to &lt;code>LowDateTime&lt;/code> field and the other four to &lt;code>HighDateTime&lt;/code>.&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>Convert the resulting Filetime to nanoseconds with &lt;a href="https://godoc.org/golang.org/x/sys/windows#Filetime.Nanoseconds" target="_blank" rel="noreferrer noopener">Filetime.Nanoseconds()&lt;/a>.&lt;/li>
&lt;li>Convert the resulting value to &lt;a href="https://golang.org/pkg/time/#Time" target="_blank" rel="noreferrer noopener">time.Time&lt;/a>.&lt;/li>
&lt;/ol>
&lt;p>The code is at:&lt;/p>
&lt;ul>
&lt;li>&lt;a href="https://github.com/parsiya/Parsia-Code/tree/master/filetime-bytewrangling" target="_blank" rel="noreferrer noopener">https://github.com/parsiya/Parsia-Code/tree/master/filetime-bytewrangling&lt;/a>&lt;/li>
&lt;/ul></description></item><item><title>Blackfriday's Parser and Generating graphs with gographviz</title><link>https://parsiya.net/blog/2018-10-28-blackfridays-parser-and-generating-graphs-with-gographviz/</link><pubDate>Sun, 28 Oct 2018 11:31:34 -0400</pubDate><guid>https://parsiya.net/blog/2018-10-28-blackfridays-parser-and-generating-graphs-with-gographviz/</guid><description>&lt;p>I have been working on a personal automation project. In short, I write most of my notes in markdown so I wanted to grab them and store them in a specific format with annotations (e.g. everything under heading &lt;code>deployment notes&lt;/code> is labeled as such in the final data file). These are not high volume, large files. I have written them manually, I am talking about a 10-20 KB file (with most content being pasted code/request snippets). I am not looking for efficiency.&lt;/p>
&lt;p>&lt;a href="https://godoc.org/gopkg.in/russross/blackfriday.v2" target="_blank" rel="noreferrer noopener">Blackfriday&lt;/a> is the markdown parser for &lt;a href="https://github.com/gohugoio/hugo" target="_blank" rel="noreferrer noopener">Hugo&lt;/a>, so I was somewhat familiar with it. Since version 2, it has a markdown parser.&lt;/p>
&lt;p>In this post, I am going to describe what I learned during the process and how I leveraged Blackfriday's markdown parser in some hacky ways to get annotated data. To visualize the AST (Abstract Syntax Tree) generated by Blackfriday, I used &lt;a href="https://github.com/awalterschulze/gographviz" target="_blank" rel="noreferrer noopener">gographviz&lt;/a>.&lt;/p>
&lt;p>A simple package &lt;code>parse&lt;/code> and code can be found here:&lt;/p>
&lt;ul>
&lt;li>&lt;a href="https://github.com/parsiya/Parsia-Code/tree/master/markdown-parsing" target="_blank" rel="noreferrer noopener">https://github.com/parsiya/Parsia-Code/tree/master/markdown-parsing&lt;/a>&lt;/li>
&lt;/ul></description></item><item><title>DEF CON 26 - Tineola - Youtube Video</title><link>https://parsiya.net/blog/2018-10-26-def-con-26-tineola-youtube-video/</link><pubDate>Fri, 26 Oct 2018 21:56:22 -0400</pubDate><guid>https://parsiya.net/blog/2018-10-26-def-con-26-tineola-youtube-video/</guid><description>&lt;p>The DEF CON 26 video is finally released:&lt;/p>
&lt;ul>
&lt;li>&lt;a href="https://www.youtube.com/watch?v=xKYIde5jh_8" target="_blank" rel="noreferrer noopener">https://www.youtube.com/watch?v=xKYIde5jh_8&lt;/a>&lt;/li>
&lt;/ul>
&lt;p>I sound somewhat comprehensible. That was a nice surprise. Credit goes to Travis for making us do many dry-runs. As usual, I am eternally grateful to Stark for his work.&lt;/p>
&lt;p>Airport and TSA diaries, Elon Musk jokes, we have it all.&lt;/p>
&lt;div style="position: relative; padding-bottom: 56.25%; height: 0; overflow: hidden;">
&lt;iframe src="https://www.youtube.com/embed/xKYIde5jh_8" style="position: absolute; top: 0; left: 0; width: 100%; height: 100%; border:0;" allowfullscreen title="YouTube Video">&lt;/iframe>
&lt;/div></description></item><item><title>Gophercises - Lessons Learned</title><link>https://parsiya.net/blog/2018-10-06-gophercises-lessons-learned/</link><pubDate>Sat, 06 Oct 2018 00:22:58 -0400</pubDate><guid>https://parsiya.net/blog/2018-10-06-gophercises-lessons-learned/</guid><description>&lt;p>I recently finished &lt;a href="https://gophercises.com" target="_blank" rel="noreferrer noopener">Gophercises&lt;/a>, a great set of Go practice lessons by &lt;a href="https://www.calhoun.io/" target="_blank" rel="noreferrer noopener">Jon Calhoun&lt;/a>. I think it took me around a month from start to finish with some stuff in the middle. Most were nice, some were tedious. For example, the last exercise was about &lt;a href="https://gophercises.com/exercises/pdf" target="_blank" rel="noreferrer noopener">PDF generation&lt;/a> and went to boring quickly.&lt;/p>
&lt;p>After every lesson, I wrote down &amp;quot;Lessons Learned&amp;quot; in the README. This page collects most of them. All code is here:&lt;/p>
&lt;ul>
&lt;li>&lt;a href="https://github.com/parsiya/Parsia-Code/tree/master/gophercises" target="_blank" rel="noreferrer noopener">https://github.com/parsiya/Parsia-Code/tree/master/gophercises&lt;/a>&lt;/li>
&lt;/ul></description></item><item><title>Reflections on "Manual Work is a Bug"</title><link>https://parsiya.net/blog/2018-10-03-reflections-on-manual-work-is-a-bug/</link><pubDate>Wed, 03 Oct 2018 00:48:17 -0400</pubDate><guid>https://parsiya.net/blog/2018-10-03-reflections-on-manual-work-is-a-bug/</guid><description>&lt;p>I recently read &lt;a href="https://queue.acm.org/detail.cfm?id=3197520" target="_blank" rel="noreferrer noopener">Manual Work is a Bug&lt;/a> by Thomas A. Limoncelli. It's a great article in my opinion. I realized I had been doing some of what it mentions.&lt;/p>
&lt;p>If you know me, you know I am a great fan of knowledge bases or &lt;code>clones&lt;/code> as I call them. I have my own external clone at &lt;a href="https://parsiya.io" target="_blank" rel="noreferrer noopener">parsiya.io&lt;/a>. It's also somewhat &lt;a href="https://parsiya.net/blog/2018-04-24-semi-automated-cloning-pain-free-knowledge-base-creation/" title="Semi-Automated Cloning: Pain-Free Knowledge Base Creation">automated&lt;/a>. I have had an internal one for more than two years.&lt;/p>
&lt;p>But the automation was not what rhymed with me. It was the documentation.&lt;/p></description></item><item><title>Tineola: Taking a Bite out of Enterprise Blockchain</title><link>https://parsiya.net/blog/2018-09-27-tineola-taking-a-bite-out-of-enterprise-blockchain/</link><pubDate>Thu, 27 Sep 2018 01:17:59 -0400</pubDate><guid>https://parsiya.net/blog/2018-09-27-tineola-taking-a-bite-out-of-enterprise-blockchain/</guid><description>&lt;p>So I wrote about &lt;a href="https://github.com/tineola/tineola" target="_blank" rel="noreferrer noopener">Tineola&lt;/a> for our corporate blog. The editors fixed my words so it sounds fancy and actually English. You can read it here:&lt;/p>
&lt;ul>
&lt;li>&lt;a href="https://www.synopsys.com/blogs/software-security/tineola-enterprise-blockchain/" target="_blank" rel="noreferrer noopener">https://www.synopsys.com/blogs/software-security/tineola-enterprise-blockchain/&lt;/a>&lt;/li>
&lt;/ul>
&lt;p>In the meanwhile, I have been doing &lt;a href="https://gophercises.com/exercises/" target="_blank" rel="noreferrer noopener">Gophercises&lt;/a> by &lt;a href="https://www.calhoun.io" target="_blank" rel="noreferrer noopener">Jon Calhoun&lt;/a>. I am up to 16. I am documenting my learned lessons in the readme of each directory. I will add them all together and put them somewhere here or in &lt;a href="http://hackingwithgo.com" target="_blank" rel="noreferrer noopener">hackingwithgo.com&lt;/a>. You can see the code here:&lt;/p>
&lt;ul>
&lt;li>&lt;a href="https://github.com/parsiya/Parsia-Code/tree/master/gophercises" target="_blank" rel="noreferrer noopener">https://github.com/parsiya/Parsia-Code/tree/master/gophercises&lt;/a>&lt;/li>
&lt;/ul>
&lt;span class="caption-wrapper">
&lt;img class="caption" src="tineola-defcon.jpg" title="Babbling about blockchain at DEF CON 26" alt="Babbling about blockchain at DEF CON 26">
&lt;span class="caption-text">Babbling about blockchain at DEF CON 26&lt;/span>
&lt;/span></description></item><item><title>DVTA - Part 5 - Client-side Storage and DLL Hijacking</title><link>https://parsiya.net/blog/2018-08-25-dvta-part-5-client-side-storage-and-dll-hijacking/</link><pubDate>Sat, 25 Aug 2018 13:49:10 -0400</pubDate><guid>https://parsiya.net/blog/2018-08-25-dvta-part-5-client-side-storage-and-dll-hijacking/</guid><description>&lt;p>Thick clients store ample information on the device. In this part, we are going to investigate DVTA to see what, how, and where it stores data. We are also going to do some basic DLL hijacking. Our tools are procmon, PowerSploit, and dnSpy.&lt;/p>
&lt;p>Previous parts are at:&lt;/p>
&lt;ul>
&lt;li>&lt;a href="https://parsiya.net/blog/2018-07-15-dvta-part-1-setup/" title="DVTA - Part 1 - Setup">DVTA - Part 1 - Setup&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://parsiya.net/blog/2018-07-21-dvta-part-2-cert-pinning-and-login-button/" title="DVTA - Part 2 - Cert Pinning and Login Button">DVTA - Part 2 - Cert Pinning and Login Button&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://parsiya.net/blog/2018-07-30-dvta-part-3-network-recon/" title="DVTA - Part 3 - Network Recon">DVTA - Part 3 - Network Recon&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://parsiya.net/blog/2018-08-02-dvta-part-4-traffic-tampering-with-dnspy/" title="DVTA - Part 4 - Traffic Tampering with dnSpy">DVTA - Part 4 - Traffic Tampering with dnSpy&lt;/a>&lt;/li>
&lt;/ul></description></item><item><title>Committing Insurance Fraud with Tineola</title><link>https://parsiya.net/blog/2018-08-23-committing-insurance-fraud-with-tineola/</link><pubDate>Thu, 23 Aug 2018 21:18:32 -0400</pubDate><guid>https://parsiya.net/blog/2018-08-23-committing-insurance-fraud-with-tineola/</guid><description>&lt;p>We recently presented our tool at the DefCon 26 conference in Vegas. Amazing time was had. We had a friendly crowd at our talk &lt;a href="https://www.defcon.org/html/defcon-26/dc-26-speakers.html#Riedesel" target="_blank" rel="noreferrer noopener">Tineola: Taking a Bite Out of Enterprise Blockchain&lt;/a>. You can see our &lt;a href="https://github.com/tineola/tineola/blob/master/docs/Tineola-Slides-Defcon26.pdf" target="_blank" rel="noreferrer noopener">slides&lt;/a> and &lt;a href="https://github.com/tineola/tineola/blob/master/docs/TineolaWhitepaper.pdf" target="_blank" rel="noreferrer noopener">whitepaper&lt;/a> in the repository. The tool is released under MIT and is at:&lt;/p>
&lt;ul>
&lt;li>&lt;a href="https://github.com/tineola/tineola" target="_blank" rel="noreferrer noopener">https://github.com/tineola/tineola&lt;/a>&lt;/li>
&lt;/ul>
&lt;p>During the talk, Stark demoed our tool and showed how to completely break the &lt;a href="https://github.com/IBM/build-blockchain-insurance-app" target="_blank" rel="noreferrer noopener">Build Blockchain Insurance App&lt;/a>. You can see the videos on the &lt;a href="https://media.defcon.org/DEF%20CON%2026/DEF%20CON%2026%20presentations/Stark%20Riedesel%20and%20Parsia%20Hakimian/DEFCON-26-Stark-Riedesel-and-Parsia-Hakimian-Demo-Videos/" target="_blank" rel="noreferrer noopener">DefCon Media Server&lt;/a>.&lt;/p>
&lt;p>This blog post will teach you how to use Tineola and commit insurance fraud.&lt;/p></description></item><item><title>DVTA - Part 4 - Traffic Tampering with dnSpy</title><link>https://parsiya.net/blog/2018-08-02-dvta-part-4-traffic-tampering-with-dnspy/</link><pubDate>Thu, 02 Aug 2018 19:41:54 -0400</pubDate><guid>https://parsiya.net/blog/2018-08-02-dvta-part-4-traffic-tampering-with-dnspy/</guid><description>&lt;p>After doing network recon in part three, it's time to do some traffic manipulation. We will learn how to capture and modify network traffic using dnSpy. This is much easier than trying to intercept and modify traffic after it's transmitted.&lt;/p>
&lt;p>Previous parts are at:&lt;/p>
&lt;ul>
&lt;li>&lt;a href="https://parsiya.net/blog/2018-07-15-dvta-part-1-setup/" title="DVTA - Part 1 - Setup">DVTA - Part 1 - Setup&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://parsiya.net/blog/2018-07-21-dvta-part-2-cert-pinning-and-login-button/" title="DVTA - Part 2 - Cert Pinning and Login Button">DVTA - Part 2 - Cert Pinning and Login Button&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://parsiya.net/blog/2018-07-30-dvta-part-3-network-recon/" title="DVTA - Part 3 - Network Recon">DVTA - Part 3 - Network Recon&lt;/a>&lt;/li>
&lt;/ul></description></item><item><title>DVTA - Part 3 - Network Recon</title><link>https://parsiya.net/blog/2018-07-30-dvta-part-3-network-recon/</link><pubDate>Mon, 30 Jul 2018 00:35:57 -0400</pubDate><guid>https://parsiya.net/blog/2018-07-30-dvta-part-3-network-recon/</guid><description>&lt;p>In this part, we will focus on network traffic. More often than not, thick client applications have some sort of network connectivity. They talk to some server(s) to do things.&lt;/p>
&lt;p>Previous parts are:&lt;/p>
&lt;ul>
&lt;li>&lt;a href="https://parsiya.net/blog/2018-07-15-dvta-part-1-setup/" title="DVTA - Part 1 - Setup">DVTA - Part 1 - Setup&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://parsiya.net/blog/2018-07-21-dvta-part-2-cert-pinning-and-login-button/" title="DVTA - Part 2 - Cert Pinning and Login Button">DVTA - Part 2 - Cert Pinning and Login Button&lt;/a>&lt;/li>
&lt;/ul></description></item><item><title>DVTA - Part 2 - Cert Pinning and Login Button</title><link>https://parsiya.net/blog/2018-07-21-dvta-part-2-cert-pinning-and-login-button/</link><pubDate>Sat, 21 Jul 2018 01:38:50 -0400</pubDate><guid>https://parsiya.net/blog/2018-07-21-dvta-part-2-cert-pinning-and-login-button/</guid><description>&lt;p>After setting up the Damn Vulnerable Thick Client Application, we are now ready to hack it.&lt;/p>
&lt;p>In this section, we will bypass the certificate pinning, enable the login button, learn how to modify the code in dnSpy through writing C# code and get a quick intro to Common Intermediate Language (CIL).&lt;/p>
&lt;p>You can see previous parts here:&lt;/p>
&lt;ul>
&lt;li>&lt;a href="https://parsiya.net/blog/2018-07-15-dvta-part-1-setup/" title="DVTA - Part 1 - Setup">Damn Vulnerable Thick Client Application - Part 1 - Setup&lt;/a>&lt;/li>
&lt;/ul></description></item><item><title>DVTA - Part 1 - Setup</title><link>https://parsiya.net/blog/2018-07-15-dvta-part-1-setup/</link><pubDate>Sun, 15 Jul 2018 21:26:41 -0400</pubDate><guid>https://parsiya.net/blog/2018-07-15-dvta-part-1-setup/</guid><description>&lt;p>I have written a lot about thick clients. However, I have not done more than a few practical examples that I can show my co-workers or anyone else asking questions. Recently, I came across the Damn Vulnerable Thick Client Application by SecVulture at &lt;a href="https://github.com/secvulture/dvta" target="_blank" rel="noreferrer noopener">https://github.com/secvulture/dvta&lt;/a>.&lt;/p>
&lt;p>I am not going to use the original version of the application. Someone has created a fork and added more protections. We will use this fork instead:&lt;/p>
&lt;ul>
&lt;li>&lt;a href="https://github.com/nddmars/dvta" target="_blank" rel="noreferrer noopener">https://github.com/nddmars/dvta&lt;/a>&lt;/li>
&lt;/ul>
&lt;p>Neither fork's setup instructions worked for me. As a result, the first part is actually setting up the application and the necessary back-end in only one VM. But don't worry, we will do a bit of reverse engineering with dnSpy to fix an issue.&lt;/p>
&lt;p>&lt;strong>Thanks to SecVulture for creating the app and maintainers of the second repository for adding protections.&lt;/strong>&lt;/p></description></item><item><title>Istanbul Tips and Tricks</title><link>https://parsiya.net/blog/2018-07-04-istanbul-tips-and-tricks/</link><pubDate>Wed, 04 Jul 2018 05:56:48 -0400</pubDate><guid>https://parsiya.net/blog/2018-07-04-istanbul-tips-and-tricks/</guid><description>&lt;p>Recently I was in Istanbul for two weeks in June 2018. This blog contains what I learned. Sharing it with the world in case you end up there. &lt;strong>It's a nice city and most people are friendly but unfortunately like any other tourist destination, the opportunist minority ruin it for everyone else&lt;/strong>.&lt;/p>
&lt;p>Disclaimer: I loved the city and most people in it but I hated the Taxis and most shopkeepers. Once we started using public transport, the quality of our experience went up drastically.&lt;/p>
&lt;p>Here's a picture of us before all the negativity :D&lt;/p>
&lt;span class="caption-wrapper">
&lt;img class="caption" src="01-main.jpg" title="Survived Istanbul" alt="Survived Istanbul">
&lt;span class="caption-text">Survived Istanbul&lt;/span>
&lt;/span></description></item><item><title>ContextIS xmas CTF Writeup</title><link>https://parsiya.net/blog/2018-06-05-contextis-xmas-ctf-writeup/</link><pubDate>Tue, 05 Jun 2018 22:34:55 -0400</pubDate><guid>https://parsiya.net/blog/2018-06-05-contextis-xmas-ctf-writeup/</guid><description>&lt;p>In January 2018, &lt;a href="https://www.contextis.com/" target="_blank" rel="noreferrer noopener">Context Information Security&lt;/a> had a CTF. Here are my write-ups for some of them and write-ups for some I did not figure out. But that's CTF for you. If you manage to walk down the path of designer, you will be fine. Otherwise, you will have a bad time.&lt;/p>
&lt;p>But enough complaining, let's see what happens.&lt;/p></description></item><item><title>On Username Enumeration</title><link>https://parsiya.net/blog/2018-05-26-on-username-enumeration/</link><pubDate>Sat, 26 May 2018 21:51:48 -0400</pubDate><guid>https://parsiya.net/blog/2018-05-26-on-username-enumeration/</guid><description>&lt;p>Enumeration is &lt;em>identifying valid resources in a target address space&lt;/em>. This sounds academic and I hate academic mumbo jumbo but bear with me.&lt;/p>
&lt;p>Username enumeration is &lt;em>identifying valid user identifiers in an application&lt;/em>. These are typically usernames or account IDs.&lt;/p>
&lt;p>Enumeration is an interesting topic. The concept of enumeration is straightforward but not always obvious. In this post I will explain username enumeration using an example.&lt;/p></description></item><item><title>Learning Go-Fuzz 2: goexif2</title><link>https://parsiya.net/blog/2018-05-05-learning-go-fuzz-2-goexif2/</link><pubDate>Sat, 05 May 2018 18:01:09 -0400</pubDate><guid>https://parsiya.net/blog/2018-05-05-learning-go-fuzz-2-goexif2/</guid><description>&lt;p>Previously on &lt;code>Learning Go-Fuzz&lt;/code>:&lt;/p>
&lt;ul>
&lt;li>&lt;a href="https://parsiya.net/blog/2018-04-29-learning-go-fuzz-1-iprange/" title="Learning Go-Fuzz 1: iprange">&amp;quot;Learning Go-Fuzz 1: iprange&amp;quot;&lt;/a>&lt;/li>
&lt;/ul>
&lt;p>This time I am looking at a different package. This is a package called &lt;code>goexif&lt;/code> at &lt;a href="https://github.com/rwcarlsen/goexif" target="_blank" rel="noreferrer noopener">https://github.com/rwcarlsen/goexif&lt;/a>. Being a file parser, it's a prime target for &lt;code>Go-Fuzz&lt;/code>. Unfortunately it has not been updated for a while. Instead, we will be looking at a fork at &lt;a href="https://github.com/xor-gate/goexif2" target="_blank" rel="noreferrer noopener">https://github.com/xor-gate/goexif2&lt;/a>.&lt;/p>
&lt;p>Code and fuzzing artifacts are at:&lt;/p>
&lt;ul>
&lt;li>&lt;a href="https://github.com/parsiya/Go-Security/tree/master/go-fuzz/goexif2" target="_blank" rel="noreferrer noopener">https://github.com/parsiya/Go-Security/tree/master/go-fuzz/goexif2&lt;/a>&lt;/li>
&lt;/ul>
&lt;!-- Links in summary --></description></item><item><title>Learning Go-Fuzz 1: iprange</title><link>https://parsiya.net/blog/2018-04-29-learning-go-fuzz-1-iprange/</link><pubDate>Sun, 29 Apr 2018 19:25:10 -0400</pubDate><guid>https://parsiya.net/blog/2018-04-29-learning-go-fuzz-1-iprange/</guid><description>&lt;p>&lt;a href="https://github.com/dvyukov/go-fuzz" target="_blank" rel="noreferrer noopener">Go-Fuzz&lt;/a> is like AFL but for Go. If you have a Go package that parses some input, you might be able fuzz it with Go-Fuzz (terms and conditions apply). Not everything can be fuzzed very easily. For example Go-Fuzz does not like cycling imports, so if one of your sub-packages imports the main package then you are in trouble (I am looking at your &lt;a href="https://github.com/alecthomas/chroma" target="_blank" rel="noreferrer noopener">Chroma&lt;/a>).&lt;/p>
&lt;p>The rest of the article will show how to use Go-Fuzz to fuzz a Go library named &lt;code>iprange&lt;/code> at:&lt;/p>
&lt;ul>
&lt;li>&lt;a href="https://github.com/malfunkt/iprange" target="_blank" rel="noreferrer noopener">https://github.com/malfunkt/iprange&lt;/a>&lt;/li>
&lt;/ul>
&lt;p>Code and fuzzing artifacts are at:&lt;/p>
&lt;ul>
&lt;li>&lt;a href="https://github.com/parsiya/Go-Security/tree/master/go-fuzz/iprange" target="_blank" rel="noreferrer noopener">https://github.com/parsiya/Go-Security/tree/master/go-fuzz/iprange&lt;/a>&lt;/li>
&lt;/ul>
&lt;!-- Summary Links --></description></item><item><title>Semi-Automated Cloning: Pain-Free Knowledge Base Creation</title><link>https://parsiya.net/blog/2018-04-24-semi-automated-cloning-pain-free-knowledge-base-creation/</link><pubDate>Tue, 24 Apr 2018 21:18:32 -0400</pubDate><guid>https://parsiya.net/blog/2018-04-24-semi-automated-cloning-pain-free-knowledge-base-creation/</guid><description>&lt;h1 id="tldr">TL;DR:
&lt;a class="header-link" href="#tldr">&lt;svg class="fill-current o-60 hover-accent-color-light" height="22px" viewBox="0 0 24 24" width="22px" xmlns="http://www.w3.org/2000/svg">&lt;path d="M0 0h24v24H0z" fill="none"/>&lt;path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76 0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71 0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71 0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76 0 5-2.24 5-5s-2.24-5-5-5z"/>&lt;/svg>&lt;/a>
&lt;/h1>&lt;p>Instead of creating an index manually for Github, I am using a Hugo blog for my knowledge base (a.k.a. &lt;code>Parsia-Clone&lt;/code>). This blog is about my flow and how I have semi-automated the process. Demo site is at &lt;a href="https://parsiya.io" target="_blank" rel="noreferrer noopener">https://parsiya.io&lt;/a> (it's served in plaintext because I am making rapid changes and do not want to invalidate CloudFront's cache after every push).&lt;/p>
&lt;h1 id="flow">Flow
&lt;a class="header-link" href="#flow">&lt;svg class="fill-current o-60 hover-accent-color-light" height="22px" viewBox="0 0 24 24" width="22px" xmlns="http://www.w3.org/2000/svg">&lt;path d="M0 0h24v24H0z" fill="none"/>&lt;path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76 0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71 0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71 0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76 0 5-2.24 5-5s-2.24-5-5-5z"/>&lt;/svg>&lt;/a>
&lt;/h1>&lt;p>Flow is pretty simple:&lt;/p>
&lt;ol>
&lt;li>Create the page bundle directory and page in the clone with &lt;code>hugo new&lt;/code>. I usually create it under &lt;code>categories\main-category-name&lt;/code>. The command will look like:
&lt;ul>
&lt;li>&lt;code>hugo new categories\research\hacking-the-gibson\index.md&lt;/code>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>Run &lt;code>hugo serve&lt;/code> to preview the page during the edit.&lt;/li>
&lt;li>Fill front matter and write the page in &lt;code>index.md&lt;/code>.&lt;/li>
&lt;li>Any resources such as pictures and files can be in the same directory. This helps in two ways, they can be referenced in the page (like pictures) and seen on Github (like config files).&lt;/li>
&lt;li>When done, &lt;code>git add/commit/push&lt;/code> the clone inside the &lt;code>content&lt;/code> directory.&lt;/li>
&lt;li>???&lt;/li>
&lt;li>Profit. See updated blog, built and deployed by &lt;code>Travis CI&lt;/code>.&lt;/li>
&lt;/ol></description></item><item><title>Deploying my Knowledge Base at parsiya.io to S3 with Travis CI</title><link>https://parsiya.net/blog/2018-04-24-deploying-my-knowledge-base-at-parsiya.io-to-s3-with-travis-ci/</link><pubDate>Tue, 24 Apr 2018 01:02:03 -0400</pubDate><guid>https://parsiya.net/blog/2018-04-24-deploying-my-knowledge-base-at-parsiya.io-to-s3-with-travis-ci/</guid><description>&lt;p>I finally managed to automate deployment of &lt;a href="https://parsiya.io" target="_blank" rel="noreferrer noopener">parsiya.io&lt;/a> with Travis CI. Not having done this before, I encountered some pitfalls. Additionally I had two extra problems:&lt;/p>
&lt;ul>
&lt;li>The structure of the blog is different from most Hugo deployments. &lt;a href="https://github.com/parsiya/Parsia-Clone" target="_blank" rel="noreferrer noopener">Parsia-Clone&lt;/a> only contains the &lt;code>content&lt;/code> directory. Parents and everything else are in the &lt;a href="https://github.com/parsiya/Parsiya.io" target="_blank" rel="noreferrer noopener">parsiya.io&lt;/a> repo. So while we push to &lt;code>Parsia-Clone&lt;/code>, we need to clone &lt;code>parsiya.io&lt;/code> and build the repository there.&lt;/li>
&lt;li>I am hosting it out of an S3 bucket. All other examples were using github pages.&lt;/li>
&lt;/ul>
&lt;p>&lt;strong>Update November 2020:&lt;/strong> As of late November 2020, I have switched to Github
actions for both &lt;code>parsiya.net&lt;/code> and &lt;code>parsiya.io&lt;/code>. Please see
&lt;a href="https://github.com/parsiya/Parsia-Clone/blob/main/.github/workflows/deploy.ymlOLD" target="_blank" rel="noreferrer noopener">deploy.ymlOLD&lt;/a>.&lt;/p>
&lt;p>&lt;strong>Update February 2021:&lt;/strong> parsiya.io is now hosted on github pages with a custom
domain instead of an S3 bucket. Please see the workflow file at
&lt;a href="https://github.com/parsiya/Parsia-Clone/blob/main/.github/workflows/gh-pages.yml" target="_blank" rel="noreferrer noopener">gh-pages.yml&lt;/a>.&lt;/p></description></item><item><title>Adding Custom Chroma Styles to Hugo Themes</title><link>https://parsiya.net/blog/2018-04-15-adding-custom-chroma-styles-to-hugo-themes/</link><pubDate>Sun, 15 Apr 2018 13:38:57 -0400</pubDate><guid>https://parsiya.net/blog/2018-04-15-adding-custom-chroma-styles-to-hugo-themes/</guid><description>&lt;p>Update: &lt;a href="https://github.com/alecthomas/chroma" target="_blank" rel="noreferrer noopener">Chroma&lt;/a> now &lt;a href="https://github.com/alecthomas/chroma/pull/140" target="_blank" rel="noreferrer noopener">supports&lt;/a> &lt;code>solarized-dark&lt;/code> families. Currently, this version is not used in Hugo.&lt;/p>
&lt;p>Hugo has switched to &lt;a href="https://github.com/alecthomas/chroma" target="_blank" rel="noreferrer noopener">Chroma&lt;/a> for syntax highlighting from Pygments. While it still supports Pygments, it appears Chroma is much faster. However, Chroma does not support the &lt;a href="https://github.com/john2x/solarized-pygment/" target="_blank" rel="noreferrer noopener">solarized dark&lt;/a> theme that is used by &lt;a href="https://github.com/parsiya/Hugo-Octopress" target="_blank" rel="noreferrer noopener">Hugo-Octopress&lt;/a>. So I had to generate the CSS and add it manually.&lt;/p>
&lt;p>The process is decently simple because Chroma has a &lt;a href="https://github.com/alecthomas/chroma#styles" target="_blank" rel="noreferrer noopener">built-in tool for converting styles&lt;/a> &lt;code>_tools/style.py&lt;/code>. You can see the files inside my clone:&lt;/p>
&lt;ul>
&lt;li>&lt;a href="https://github.com/parsiya/Parsia-Clone/tree/master/random/chroma-pygments-convert" target="_blank" rel="noreferrer noopener">https://github.com/parsiya/Parsia-Clone/tree/master/random/chroma-pygments-convert&lt;/a>&lt;/li>
&lt;/ul>
&lt;!-- Links before summary --></description></item><item><title>Blockchain Security Talk at NoVA Hackers</title><link>https://parsiya.net/blog/2018-03-17-blockchain-security-talk-at-nova-hackers/</link><pubDate>Sat, 17 Mar 2018 20:37:29 -0400</pubDate><guid>https://parsiya.net/blog/2018-03-17-blockchain-security-talk-at-nova-hackers/</guid><description>&lt;p>I had a 30 minute talk about Blockchain security at &lt;a href="https://twitter.com/novahackers" target="_blank" rel="noreferrer noopener">NoVA Hackers&lt;/a> on March 12th 2018.&lt;/p>
&lt;p>NoVA Hackers is a monthly security meetup for in northern Virginia. Very welcoming event.&lt;/p>
&lt;p>You can download the PDF from Google Drive:&lt;/p>
&lt;ul>
&lt;li>&lt;a href="https://drive.google.com/file/d/1aXJgpGs6TznOx5uO7U1cvkvi-zVEjPSJ/view" target="_blank" rel="noreferrer noopener">https://drive.google.com/file/d/1aXJgpGs6TznOx5uO7U1cvkvi-zVEjPSJ/view&lt;/a>&lt;/li>
&lt;/ul>
&lt;p>Hopefully I can do more presentations as I learn more.&lt;/p>
&lt;p>As usual, please let me know where I messed up.&lt;/p></description></item><item><title>The Great Hiatus</title><link>https://parsiya.net/blog/2018-03-01-the-great-hiatus/</link><pubDate>Thu, 01 Mar 2018 22:22:51 -0500</pubDate><guid>https://parsiya.net/blog/2018-03-01-the-great-hiatus/</guid><description>&lt;p>This is copied to a blog entry on Aug 1 2016.&lt;/p>
&lt;p>I did not blog for almost exactly a year from July 28th 2016 to July 8th 2017.&lt;/p>
&lt;p>This is not something new, if you look at my blog dates you can see I work in clusters. I do a few blogs about something interesting in quick succession and then don't do anything for a while.&lt;/p>
&lt;p>You could call this a problem. Some people recommend holding off posts and then publishing them more steadily. I am not like that, I want to document what I do for future reference right now before I forget.&lt;/p></description></item><item><title>Extracting PNG Chunks with Go</title><link>https://parsiya.net/blog/2018-02-25-extracting-png-chunks-with-go/</link><pubDate>Sun, 25 Feb 2018 18:27:49 -0500</pubDate><guid>https://parsiya.net/blog/2018-02-25-extracting-png-chunks-with-go/</guid><description>&lt;p>Yesterday I had to extract some data from hidden chunks in PNG files. I realized the PNG file format is blissfully simple.&lt;/p>
&lt;p>I wrote some quick code that parses a PNG file, extracts some information, identifies chunks and finally extracts chunk data. The code has minimal error handling (if chunks are not formatted properly). We also do not care about parsing &lt;code>PLTE&lt;/code> and &lt;code>tRNS&lt;/code> chunks although we will extract them.&lt;/p>
&lt;p>Code is at:&lt;/p>
&lt;ul>
&lt;li>&lt;a href="https://github.com/parsiya/Go-Security/blob/master/png-tests/png-chunk-extraction.go" target="_blank" rel="noreferrer noopener">https://github.com/parsiya/Go-Security/blob/master/png-tests/png-chunk-extraction.go&lt;/a>&lt;/li>
&lt;/ul></description></item><item><title>CAP Theorem and Credit Cards</title><link>https://parsiya.net/blog/2018-02-22-cap-theorem-and-credit-cards/</link><pubDate>Thu, 22 Feb 2018 20:43:14 -0500</pubDate><guid>https://parsiya.net/blog/2018-02-22-cap-theorem-and-credit-cards/</guid><description>&lt;p>CAP Theorem is another of those &lt;code>blockchain buzzwords&lt;/code>.&lt;/p>
&lt;p>CAP stands for:&lt;/p>
&lt;ul>
&lt;li>&lt;strong>Consistency&lt;/strong>: Every read should get up-to-date data.&lt;/li>
&lt;li>&lt;strong>Availability&lt;/strong>: Every request should get a response.&lt;/li>
&lt;li>&lt;strong>Partition Tolerance&lt;/strong>: If a section of the network is partitioned/cut-off (messages are dropped), the network should continue to work.&lt;/li>
&lt;/ul>
&lt;p>&lt;strong>CAP Theorem&lt;/strong>: A distributed network &lt;strong>can only pick two&lt;/strong>.&lt;/p></description></item><item><title>Byzantine Generals' Problem</title><link>https://parsiya.net/blog/2018-02-21-byzantine-generals-problem/</link><pubDate>Wed, 21 Feb 2018 15:58:41 -0500</pubDate><guid>https://parsiya.net/blog/2018-02-21-byzantine-generals-problem/</guid><description>&lt;p>In the previous blog post, I talked about &lt;a href="https://parsiya.net/blog/2018-02-18-byzantine-fault-tolerance-and-the-telephone-game/" title="Byzantine Fault Tolerance and the Telephone Game">Byzantine Fault Tolerance&lt;/a>. It was sort of a jump into the middle of everything. In this post I will take a step back and look at the history behind BFT. This is my short post about the &lt;strong>Byzantine Generals' Problem&lt;/strong>.&lt;/p></description></item><item><title>Byzantine Fault Tolerance and the Telephone Game</title><link>https://parsiya.net/blog/2018-02-18-byzantine-fault-tolerance-and-the-telephone-game/</link><pubDate>Sun, 18 Feb 2018 21:14:05 -0500</pubDate><guid>https://parsiya.net/blog/2018-02-18-byzantine-fault-tolerance-and-the-telephone-game/</guid><description>&lt;p>This distributed ledger thing &lt;em>clicked&lt;/em> when I realized &lt;strong>a blockchain is just a distributed network&lt;/strong>. Like any other model, blockchains attempt to solve a few problems and as a result introduce some challenges. &lt;strong>Byzantine Fault Tolerance&lt;/strong> or &lt;strong>BFT&lt;/strong> is one of those buzzwords that go around during nowadays. Blockchains have consensus models that claim to achieve BFT.&lt;/p>
&lt;p>Here are my notes on BFT and how it relates to blockchains. I do not claim these notes to be neither complete nor correct. I am still learning. This is not an academic paper. I am just writing down what worked for me in hopes of helping others. That said, if you have any feedback, you know where to find me.&lt;/p></description></item><item><title>Notes from NISTIR 8202 - Blockchain Technology Overview January 2018 Draft</title><link>https://parsiya.net/blog/2018-02-08-notes-from-nistir-8202-blockchain-technology-overview-january-2018-draft/</link><pubDate>Thu, 08 Feb 2018 21:52:41 -0500</pubDate><guid>https://parsiya.net/blog/2018-02-08-notes-from-nistir-8202-blockchain-technology-overview-january-2018-draft/</guid><description>&lt;p>I read the &lt;strong>NISTIR 8202 - Blockchain Technology Overview draft&lt;/strong> so you do not have to. These are my notes from the January 2018 version of the document.&lt;/p>
&lt;p>&lt;em>After reading this, you will know enough buzzwords to add &lt;code>Blockchain Expert&lt;/code> to your LinkedIn title/Twitter bio/email signature.&lt;/em>&lt;/p>
&lt;p>You can find a copy of the draft at:&lt;/p>
&lt;ul>
&lt;li>&lt;a href="https://csrc.nist.gov/CSRC/media/Publications/nistir/8202/draft/documents/nistir8202-draft.pdf" target="_blank" rel="noreferrer noopener">https://csrc.nist.gov/CSRC/media/Publications/nistir/8202/draft/documents/nistir8202-draft.pdf&lt;/a>&lt;/li>
&lt;/ul></description></item><item><title>VirtualBox Live State File Format</title><link>https://parsiya.net/blog/2018-01-29-virtualbox-live-state-file-format/</link><pubDate>Mon, 29 Jan 2018 00:10:03 -0500</pubDate><guid>https://parsiya.net/blog/2018-01-29-virtualbox-live-state-file-format/</guid><description>&lt;p>In &lt;a href="https://parsiya.net/blog/2018-01-23-mounting-live-snapshots-of-encrypted-vms-in-virtualbox/" title="Mounting Live Snapshots of Encrypted VMs in VirtualBox">Mounting Live Snapshots of Encrypted VMs in VirtualBox&lt;/a> we mounted a live snapshot and logged into the machine. We also got a sneak peek of what kind of information we can extract from the live snapshot (&lt;code>sav&lt;/code> file).&lt;/p>
&lt;p>In this post I will talk about parts of the live state file format and show some data that can be extracted from these files. The format is not formally documented but we have access to commented source.&lt;/p>
&lt;p>To make it easier, I have uploaded the live state from our previous MysteryVM separately. You can download it from &lt;a href="https://drive.google.com/file/d/1WdlcHsQattvFs8Wu9RdFC5UOaSxqhk0d/view?usp=sharing" target="_blank" rel="noreferrer noopener">Google Drive&lt;/a> (45 MB).&lt;/p></description></item><item><title>Mounting Live Snapshots of Encrypted VMs in VirtualBox</title><link>https://parsiya.net/blog/2018-01-23-mounting-live-snapshots-of-encrypted-vms-in-virtualbox/</link><pubDate>Tue, 23 Jan 2018 22:24:39 -0500</pubDate><guid>https://parsiya.net/blog/2018-01-23-mounting-live-snapshots-of-encrypted-vms-in-virtualbox/</guid><description>&lt;h3 id="tldr">TL;DR
&lt;a class="header-link" href="#tldr">&lt;svg class="fill-current o-60 hover-accent-color-light" height="22px" viewBox="0 0 24 24" width="22px" xmlns="http://www.w3.org/2000/svg">&lt;path d="M0 0h24v24H0z" fill="none"/>&lt;path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76 0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71 0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71 0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76 0 5-2.24 5-5s-2.24-5-5-5z"/>&lt;/svg>&lt;/a>
&lt;/h3>&lt;p>&lt;strong>Problem&lt;/strong>: We have an encrypted Virtual Machine (VM) disk and the associated
VirtualBox (VBox) live snapshot (taken when user was logged in). Mount the VM
and restore the live snapshot to get access to the data.&lt;/p>
&lt;p>It seems pretty easy, but turns out it's not and looks to be a first of its kind
tutorial (at least public). This is surprising because I can imagine this issue
being a recurring problem in the forensics community.&lt;/p>
&lt;p>A few days ago I did a couple of Forensics challenges. Both involved mounting
images and analyzing the contents of a VM. The second challenge was a disk and a
live snapshot. Part of the challenge involved mounting the snapshot and
restoring the state to log in.&lt;/p>
&lt;p>It's an ongoing challenge so I do not want to spill the beans. Instead, I have
re-created a VM to show what I did. Hopefully this will help the next person
with a similar problem.&lt;/p></description></item><item><title>Decoding Large Base64 Files with Go</title><link>https://parsiya.net/blog/2018-01-19-decoding-large-base64-files-with-go/</link><pubDate>Fri, 19 Jan 2018 22:45:55 -0500</pubDate><guid>https://parsiya.net/blog/2018-01-19-decoding-large-base64-files-with-go/</guid><description>&lt;p>I am working on this challenge and it has a large base64 file. Each line has 2 characters and it has 150+ million lines.&lt;/p>
&lt;p>Luckily we can use the &lt;a href="https://golang.org/pkg/encoding/base64/#NewDecoder" target="_blank" rel="noreferrer noopener">Base64 stream decoder&lt;/a>. It reads from an &lt;code>io.Reader&lt;/code> and returns one that can be copied into an &lt;code>io.Writer&lt;/code>. It also takes care of the new lines.&lt;/p>
&lt;p>Sample code is at:&lt;/p>
&lt;ul>
&lt;li>&lt;a href="https://github.com/parsiya/Go-Security/blob/master/base64-stream-decoder/b64-stream-decoder.go" target="_blank" rel="noreferrer noopener">https://github.com/parsiya/Go-Security/blob/master/base64-stream-decoder/b64-stream-decoder.go&lt;/a>.&lt;/li>
&lt;/ul></description></item><item><title>Simple SSH Harvester in Go</title><link>https://parsiya.net/blog/2017-12-29-simple-ssh-harvester-in-go/</link><pubDate>Fri, 29 Dec 2017 13:40:56 -0500</pubDate><guid>https://parsiya.net/blog/2017-12-29-simple-ssh-harvester-in-go/</guid><description>&lt;p>During my Go SSH adventures at &lt;a href="https://github.com/parsiya/Hacking-with-Go/blob/master/content/04.4.md" target="_blank" rel="noreferrer noopener">Hacking with Go&lt;/a> I wanted to write a simple SSH harvester. As usual, the tool turned out to be much larger than I thought.&lt;/p>
&lt;p>I realized I cannot find any examples of SSH certificate verification. There are a few examples for host keys here and there. Even the &lt;code>certs_test.go&lt;/code> file just checks the host name. There was a &lt;a href="https://github.com/golang/go/issues/23266" target="_blank" rel="noreferrer noopener">typo in an error message&lt;/a>&lt;sup id="fnref:1">&lt;a href="#fn:1" class="footnote-ref" role="doc-noteref">1&lt;/a>&lt;/sup> in the &lt;code>crypto/ssh&lt;/code> package but I think because this is not very much used, had gone unreported.&lt;/p>
&lt;p>Here's my step by step guide to writing this tool by piggybacking on SSH host verification callbacks. Hopefully this will make it easier for the next person.&lt;/p>
&lt;p>You can find the code here:&lt;/p>
&lt;ul>
&lt;li>&lt;a href="https://github.com/parsiya/SSH-Scanner/blob/master/SSHHarvesterv1.go?ts=4" target="_blank" rel="noreferrer noopener">https://github.com/parsiya/SSH-Scanner/blob/master/SSHHarvesterv1.go&lt;/a>&lt;/li>
&lt;/ul>
&lt;h3 id="tldr-verifying-ssh-servers">TL;DR: verifying SSH servers
&lt;a class="header-link" href="#tldr-verifying-ssh-servers">&lt;svg class="fill-current o-60 hover-accent-color-light" height="22px" viewBox="0 0 24 24" width="22px" xmlns="http://www.w3.org/2000/svg">&lt;path d="M0 0h24v24H0z" fill="none"/>&lt;path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76 0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71 0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71 0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76 0 5-2.24 5-5s-2.24-5-5-5z"/>&lt;/svg>&lt;/a>
&lt;/h3>&lt;ol>
&lt;li>Create an instance of &lt;a href="https://godoc.org/golang.org/x/crypto/ssh#CertChecker" target="_blank" rel="noreferrer noopener">ssh.CertChecker&lt;/a>.&lt;/li>
&lt;li>Set callback functions for &lt;code>IsHostAuthority&lt;/code>, &lt;code>IsRevoked&lt;/code> and optionally &lt;code>HostKeyFallback&lt;/code>.
&lt;ul>
&lt;li>&lt;code>IsHostAuthority&lt;/code>'s callback should return &lt;code>true&lt;/code> for valid certificates.&lt;/li>
&lt;li>&lt;code>IsRevoked&lt;/code>'s callback should return &lt;code>false&lt;/code> for valid certificates.&lt;/li>
&lt;li>&lt;code>HostKeyFallback&lt;/code>'s callback should return &lt;code>nil&lt;/code> for valid certificates.&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>Create an instance of &lt;a href="https://godoc.org/golang.org/x/crypto/ssh#ClientConfig" target="_blank" rel="noreferrer noopener">ssh.ClientConfig&lt;/a>.&lt;/li>
&lt;li>Set &lt;code>HostKeyCallback&lt;/code> in &lt;code>ClientConfig&lt;/code> to &lt;code>&amp;amp;ssh.CertChecker.CheckHostKey&lt;/code>.&lt;/li>
&lt;li>&lt;a href="https://godoc.org/golang.org/x/crypto/ssh#CertChecker.CheckHostKey" target="_blank" rel="noreferrer noopener">CheckHostKey&lt;/a> will verify the certificate based on other callback functions.&lt;/li>
&lt;li>The certificate can be accessed in &lt;code>IsRevoked&lt;/code> callback function.&lt;/li>
&lt;/ol></description></item><item><title>Windows XP 32-bit SP3 Virtual Machines</title><link>https://parsiya.net/blog/2017-12-19-windows-xp-32-bit-sp3-virtual-machines/</link><pubDate>Tue, 19 Dec 2017 19:45:22 -0500</pubDate><guid>https://parsiya.net/blog/2017-12-19-windows-xp-32-bit-sp3-virtual-machines/</guid><description>&lt;p>There used to be Windows XP virtual machines on &lt;a href="https://developer.microsoft.com/en-us/microsoft-edge/tools/vms/" target="_blank" rel="noreferrer noopener">modern.ie&lt;/a>. I still have a couple of copies around for testing. Unfortunately after XP going out of support, they were removed. But the copies used to be on &lt;a href="https://www.reddit.com/r/AskNetsec/comments/6qea8a/need_a_windows_xp_iso/dkwq0qw/" target="_blank" rel="noreferrer noopener">Azure CDN&lt;/a> (credit &lt;a href="https://www.reddit.com/user/JoshBrodieNZ" target="_blank" rel="noreferrer noopener">/u/JoshBrodieNZ&lt;/a>. Seems like they recently removed them too.&lt;/p>
&lt;p>There's still a way to get Windows XP 32-bit VMs from Microsoft (no 64-bit) through Windows XP mode. It contains a VHD (virtual hard disk) with a 32-bit Windows XP SP3.&lt;/p>
&lt;p>&lt;strong>EDIT 2022-01-12&lt;/strong>: The link below is dead. Looks like Windows XP Mode was tied to Windows 7 and removed when it went EOL.&lt;/p>
&lt;ol>
&lt;li>Download Microsoft XP Mode from &lt;a href="https://www.microsoft.com/en-us/download/details.aspx?id=8002" target="_blank" rel="noreferrer noopener">https://www.microsoft.com/en-us/download/details.aspx?id=8002&lt;/a>.&lt;/li>
&lt;li>Using 7-zip or any other utility decompress the exe.&lt;/li>
&lt;li>Inside sources, there's another file called &lt;code>xpm&lt;/code>. Decompress it too. With 7-zip, right click on it and select &amp;quot;Extract to ... .&amp;quot;&lt;/li>
&lt;li>One of the extracted files is &lt;code>VirtualXPVHD&lt;/code> and around 1.2 GB. Rename it to &lt;code>VirtualXP.vhd&lt;/code>.&lt;/li>
&lt;li>In VirtualBox (or any other virtualization software that supports importing VHDs), create a new Windows XP 32-bit VM and use this file as the hard disk. When you start the VM, it will start a Windows XP setup. My mouse did not work, but you can use shortcut keys to navigate the installer (e.g. Alt+N for Next).&lt;/li>
&lt;li>???&lt;/li>
&lt;li>Profit.&lt;/li>
&lt;/ol>
&lt;p>For a step by step guide with pictures, check &lt;a href="https://www.howtogeek.com/howto/12183/how-to-run-xp-mode-in-virtualbox-on-windows-7/" target="_blank" rel="noreferrer noopener">this post&lt;/a> from howtogeek.com.&lt;/p></description></item><item><title>Go and pcaps</title><link>https://parsiya.net/blog/2017-12-03-go-and-pcaps/</link><pubDate>Sun, 03 Dec 2017 18:40:26 -0500</pubDate><guid>https://parsiya.net/blog/2017-12-03-go-and-pcaps/</guid><description>&lt;p>I was trying to solve a challenge where the &amp;quot;hidden data&amp;quot; were in ICMP echo payloads. I decided to do it in Go but there were some hiccups on the way. Here are my notes in case (most likely) future me or someone else needs to do the same.&lt;/p>
&lt;p>Code is in my clone at:&lt;/p>
&lt;ul>
&lt;li>&lt;a href="https://github.com/parsiya/Go-Security/tree/master/pcap-tutorial" target="_blank" rel="noreferrer noopener">https://github.com/parsiya/Go-Security/tree/master/pcap-tutorial&lt;/a>&lt;/li>
&lt;/ul></description></item><item><title>"Hacking" Car Mechanic Simulator 2015</title><link>https://parsiya.net/blog/2017-11-29-hacking-car-mechanic-simulator-2015/</link><pubDate>Wed, 29 Nov 2017 20:29:30 -0500</pubDate><guid>https://parsiya.net/blog/2017-11-29-hacking-car-mechanic-simulator-2015/</guid><description>&lt;p>Not real hacking!&lt;/p>
&lt;p>&lt;strong>Tl;dr:&lt;/strong>&lt;/p>
&lt;ol>
&lt;li>Open this file with a hex editor:
&lt;ul>
&lt;li>&lt;code>\AppData\LocalLow\Red Dot Games\Car Mechanic Simulator 2015\profile#\global&lt;/code>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>Search for &lt;code>money&lt;/code> and &lt;code>xp&lt;/code>.&lt;/li>
&lt;li>Locate the int32 value of each property in little-endian.&lt;/li>
&lt;li>Convert your current XP and money to hex to make the search easier.&lt;/li>
&lt;li>Overwrite them with&lt;code>6F FF FF FF&lt;/code>.&lt;/li>
&lt;li>???&lt;/li>
&lt;li>You have &amp;quot;hacked&amp;quot; the game.&lt;/li>
&lt;/ol>
&lt;p>It does not get easier than this.&lt;/p></description></item><item><title>cmd Startup Commands</title><link>https://parsiya.net/blog/2017-11-27-cmd-startup-commands/</link><pubDate>Mon, 27 Nov 2017 23:13:55 -0500</pubDate><guid>https://parsiya.net/blog/2017-11-27-cmd-startup-commands/</guid><description>&lt;p>This blog talks about how to run a command automatically every time you open a new command prompt on Windows.&lt;/p>
&lt;ol>
&lt;li>Open registry.&lt;/li>
&lt;li>Navigate to the following location:
&lt;ul>
&lt;li>&lt;code>HKCU\Software\Microsoft\Command Processor&lt;/code>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>Double click &lt;code>Autorun&lt;/code> and type in your command. For example:
&lt;ul>
&lt;li>&lt;code>cd /d C:\Users\IEUser\Desktop\Whatever\&lt;/code>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>If the &lt;code>Autorun&lt;/code> property is missing, create one with type &lt;code>REG_SZ&lt;/code>.&lt;/li>
&lt;li>Now every cmd will automatically cd to the &lt;code>Whatever&lt;/code> directory.&lt;/li>
&lt;/ol>
&lt;p>I am going to keep blogging consistently (hopefully). This means breaking my habit of having to write extensive blog posts.&lt;/p></description></item><item><title>WinAppDbg - Part 4 - Bruteforcing FlareOn 2017 - Challenge 3</title><link>https://parsiya.net/blog/2017-11-15-winappdbg-part-4-bruteforcing-flareon-2017-challenge-3/</link><pubDate>Wed, 15 Nov 2017 18:45:04 -0500</pubDate><guid>https://parsiya.net/blog/2017-11-15-winappdbg-part-4-bruteforcing-flareon-2017-challenge-3/</guid><description>&lt;p>Previous parts:&lt;/p>
&lt;ul>
&lt;li>&lt;a href="https://parsiya.net/blog/2017-11-09-winappdbg-part-1-basics/" title="WinAppDbg - Part 1 - Basics">Part 1 - Basics&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://parsiya.net/blog/2017-11-11-winappdbg-part-2-function-hooking-and-others/" title="WinAppDbg - Part 2 - Function Hooking and Others">Part 2 - Function Hooking and Others&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://parsiya.net/blog/2017-11-11-winappdbg-part-2-function-hooking-and-others/" title="WinAppDbg - Part 3 - Manipulating Function Calls">Part 3 - Manipulating Function Calls&lt;/a>&lt;/li>
&lt;/ul>
&lt;p>We have learned some good stuff. In this part I am going to talk about the original problem that led me to learning WinAppDbg. This is my writeup for challenge 3 &amp;quot;Greek to me&amp;quot; of &lt;a href="https://www.fireeye.com/blog/threat-research/2017/10/2017-flare-on-challenge-solutions.html" target="_blank" rel="noreferrer noopener">FlareOn 2017&lt;/a>. This is a bruteforce challenge and is rather easy but instead of bruteforcing it the conventional (and straightforward way), I will show how I traversed arbitrary Assembly blobs using WinAppDbg.&lt;/p>
&lt;p>I will (hopefully) mostly talk about solving the challenge and not a lot of recon or other places I was stuck at.&lt;/p>
&lt;p>Code is in my clone:&lt;/p>
&lt;ul>
&lt;li>&lt;a href="https://github.com/parsiya/Parsia-Code/tree/master/winappdbg" title="WinAppDbg code in Parsia-Code" target="_blank" rel="noreferrer noopener">https://github.com/parsiya/Parsia-Code/tree/master/winappdbg&lt;/a>&lt;/li>
&lt;/ul></description></item><item><title>WinAppDbg - Part 3 - Manipulating Function Calls</title><link>https://parsiya.net/blog/2017-11-15-winappdbg-part-3-manipulating-function-calls/</link><pubDate>Wed, 15 Nov 2017 00:30:25 -0500</pubDate><guid>https://parsiya.net/blog/2017-11-15-winappdbg-part-3-manipulating-function-calls/</guid><description>&lt;p>Previously on WinAppDbg-TV:&lt;/p>
&lt;ul>
&lt;li>&lt;a href="https://parsiya.net/blog/2017-11-09-winappdbg-part-1-basics/" title="WinAppDbg - Part 1 - Basics">Part 1 - Basics&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://parsiya.net/blog/2017-11-11-winappdbg-part-2-function-hooking-and-others/" title="WinAppDbg - Part 2 - Function Hooking and Others">Part 2 - Function Hooking and Others&lt;/a>&lt;/li>
&lt;/ul>
&lt;p>As usual, code is in my clone on Github. Download that directory to your VM and follow along:&lt;/p>
&lt;ul>
&lt;li>&lt;a href="https://github.com/parsiya/Parsia-Code/tree/master/winappdbg" title="WinAppDbg code in Parsia-Code" target="_blank" rel="noreferrer noopener">https://github.com/parsiya/Parsia-Code/tree/master/winappdbg&lt;/a>&lt;/li>
&lt;/ul>
&lt;p>In part two we learned how to hook functions by hooking IE and Firefox to see pre-TLS traffic. Just looking at function calls is fun but often not enough. We need to be able to modify function parameters and return values.&lt;/p>
&lt;p>In this part we will learn how to do that (and a few other things). We will start with something simple and then move on to more complex examples.&lt;/p></description></item><item><title>WinAppDbg - Part 2 - Function Hooking and Others</title><link>https://parsiya.net/blog/2017-11-11-winappdbg-part-2-function-hooking-and-others/</link><pubDate>Sat, 11 Nov 2017 12:04:48 -0500</pubDate><guid>https://parsiya.net/blog/2017-11-11-winappdbg-part-2-function-hooking-and-others/</guid><description>&lt;p>In &lt;a href="https://parsiya.net/blog/2017-11-09-winappdbg-part-1-basics/" title="WinAppDbg - Part 1 - Basics">part one&lt;/a> we talked about the basics of WinAppDbg. In this part we are going to learn a few new things:&lt;/p>
&lt;ul>
&lt;li>I wrote a &lt;a href="https://github.com/parsiya/WinAppUtil" title="WinAppDbg repository on Github" target="_blank" rel="noreferrer noopener">simple python module&lt;/a> to simplify my use of WinAppDbg. It will most likely be modified later, but I have included a version that works with the tutorials at:
&lt;ul>
&lt;li>&lt;a href="https://github.com/parsiya/Parsia-Code/tree/master/winappdbg" title="WinAppDbg code in Parsia-Code" target="_blank" rel="noreferrer noopener">https://github.com/parsiya/Parsia-Code/tree/master/winappdbg&lt;/a>&lt;/li>
&lt;li>We do not need to type the full filename anymore if the executable is in PATH. Note Run Line (&lt;code>win+r&lt;/code>) pulls stuff from more locations than PATH, so we cannot call &lt;code>chrome.exe&lt;/code>. I have written about it &lt;a href="https://parsiya.net/blog/2017-10-23-run-line-vs.-cmd-vs.-powershell/" title="Run Line vs. cmd vs. PowerShell">here&lt;/a>.&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>&lt;strong>DLL enumeration&lt;/strong>: We're going to implement one of procmon's features.&lt;/li>
&lt;li>&lt;strong>Process/Thread tracing&lt;/strong>: Another procmon feature.&lt;/li>
&lt;li>&lt;strong>Function Hooking&lt;/strong>: It's very easy in WinAppDbg and we will learn how to do it a couple of different ways.
&lt;ul>
&lt;li>We will hook pre-TLS encryption data for Internet Explorer and Firefox to hack the Gibson.&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;p>Copy this directory &lt;a href="https://github.com/parsiya/Parsia-Code/tree/master/winappdbg" title="WinAppDbg code in Parsia-Code" target="_blank" rel="noreferrer noopener">https://github.com/parsiya/Parsia-Code/tree/master/winappdbg&lt;/a> to your VM and let's go.&lt;/p></description></item><item><title>WinAppDbg - Part 1 - Basics</title><link>https://parsiya.net/blog/2017-11-09-winappdbg-part-1-basics/</link><pubDate>Thu, 09 Nov 2017 19:22:24 -0500</pubDate><guid>https://parsiya.net/blog/2017-11-09-winappdbg-part-1-basics/</guid><description>&lt;p>&lt;a href="https://github.com/MarioVilas/winappdbg" title="WinAppDbg repository on Github" target="_blank" rel="noreferrer noopener">WinAppDbg&lt;/a> by &lt;a href="https://twitter.com/Mario_Vilas" title="Mario Vilas Twitter account" target="_blank" rel="noreferrer noopener">Mario Vilas&lt;/a> is perhaps one of the most underrated instrumentation frameworks for Windows. In this day and age where everyone write JavaScript code to hook functions (I am looking at you Frida), writing Python code feels great. Just kidding, Frida is pretty cool too.&lt;/p>
&lt;p>Going around the web searching for tutorials did not give me many results. &lt;a href="https://winappdbg.readthedocs.io/en/latest/" title="WinAppDbg documentation on readthedocs" target="_blank" rel="noreferrer noopener">The docs&lt;/a> are great, they are some of the most practical docs I have seen. But apart from that, I could not find much. There are some random code here and there where people have documented using it but there were no guides to get me started apart from the docs.&lt;/p>
&lt;p>Here's the result of my learning. I am sharing it to fill the gap that I encountered while getting started with the tool. We're going to learn as we go using real-world applications and will write code. We will start from the basics, expanding our code-base as we learn more.&lt;/p>
&lt;p>Code is in my clone at:&lt;/p>
&lt;ul>
&lt;li>&lt;a href="https://github.com/parsiya/Parsia-Code/tree/master/winappdbg" title="WinAppDbg code in Parsia-Code" target="_blank" rel="noreferrer noopener">https://github.com/parsiya/Parsia-Code/tree/master/winappdbg&lt;/a>&lt;/li>
&lt;/ul></description></item><item><title>Silly Attack Using Run Line</title><link>https://parsiya.net/blog/2017-10-26-silly-attack-using-run-line/</link><pubDate>Thu, 26 Oct 2017 21:11:55 -0400</pubDate><guid>https://parsiya.net/blog/2017-10-26-silly-attack-using-run-line/</guid><description>&lt;p>&lt;a href="https://parsiya.net/blog/2017-10-23-run-line-vs.-cmd-vs.-powershell/" title="Run Line vs. cmd vs. PowerShell">Previously&lt;/a> we saw how Windows Run Line searches in &lt;code>App Paths&lt;/code> registry keys before PATH. We can perform a silly attack and create a registry key for an application in path and point it to another command.&lt;/p>
&lt;p>This is a silly attack because we need to be admin to create/edit those keys. But if you ever find yourself in the unlikely situation, you can use this to become delayed admin (i.e. wait for admin to run the app via Run Line).&lt;/p></description></item><item><title>Run Line vs. cmd vs. PowerShell</title><link>https://parsiya.net/blog/2017-10-23-run-line-vs.-cmd-vs.-powershell/</link><pubDate>Mon, 23 Oct 2017 22:01:50 -0400</pubDate><guid>https://parsiya.net/blog/2017-10-23-run-line-vs.-cmd-vs.-powershell/</guid><description>&lt;p>Note about the differences between search paths when running stuff via the Windows Run Line (&lt;code>win+r&lt;/code>), command line and PowerShell.&lt;/p>
&lt;p>We can type &lt;code>iexplore&lt;/code> in Run Line to open up Internet Explorer but doing the same in a cmd or PowerShell is not successful.&lt;/p>
&lt;p>&lt;strong>tl;dr&lt;/strong>\
Run Line looks in the following registry location then PATH. Credit Vic Laurie at &lt;a href="https://commandwindows.com/runline.htm" target="_blank" rel="noreferrer noopener">commandwindows.com&lt;/a>.&lt;/p>
&lt;ul>
&lt;li>&lt;code>HKLM\Software\Microsoft\Windows\CurrentVersion\App Paths&lt;/code>&lt;/li>
&lt;/ul>
&lt;p>&lt;strong>Search order&lt;/strong>&lt;/p>
&lt;ul>
&lt;li>cmd searches first in local directory and then in PATH.&lt;/li>
&lt;li>PowerShell searches first in PATH and then in local directory.&lt;/li>
&lt;li>Run Line searches in &lt;code>App Paths&lt;/code> first.&lt;/li>
&lt;/ul>
&lt;p>Usual blabbering and needless digging follows.&lt;/p></description></item><item><title>Thick Client Proxying - Part 8 - Notes on Proxying Windows Services</title><link>https://parsiya.net/blog/2017-10-08-thick-client-proxying-part-8-notes-on-proxying-windows-services/</link><pubDate>Sun, 08 Oct 2017 15:00:00 -0400</pubDate><guid>https://parsiya.net/blog/2017-10-08-thick-client-proxying-part-8-notes-on-proxying-windows-services/</guid><description>&lt;p>These are my notes about proxying Windows services. Being run from a different account (usually LocalSystem).&lt;/p>
&lt;p>Proxy settings are usually configured per user and are not applicable to Windows services.&lt;/p>
&lt;p>If you have to proxy a Windows service, here are some of the things you can try (and hope they work).&lt;/p>
&lt;p>There are also some issues when using &lt;code>netsh&lt;/code> to set WinHTTP proxies for 32-bit applications on Windows 7 64-bit.&lt;/p></description></item><item><title>Thick Client Proxying - Part 7 - Proxying .NET Applications via Config File</title><link>https://parsiya.net/blog/2017-10-07-thick-client-proxying-part-7-proxying-.net-applications-via-config-file/</link><pubDate>Sat, 07 Oct 2017 18:30:28 -0400</pubDate><guid>https://parsiya.net/blog/2017-10-07-thick-client-proxying-part-7-proxying-.net-applications-via-config-file/</guid><description>&lt;p>.NET applications use a configuration file to read some settings. It's an XML
file named &lt;code>appName.exe.config&lt;/code>. We can pass a proxy address in this file.&lt;/p>
&lt;p>These apps usually use WinINET or IE proxy settings. Sometimes, they do not. We
can either use an application specific config file or use one for the entire
.NET framework for a machine.&lt;/p>
&lt;p>Look inside the decompiled code (or just grep the binary files) for references
to &lt;code>System.Configuration&lt;/code> &lt;a href="https://msdn.microsoft.com/en-us/library/system.configuration.configuration%28v=vs.110%29.aspx" target="_blank" rel="noreferrer noopener">MSDN-page&lt;/a>. Applications
use &lt;code>ConfigurationManager&lt;/code> and &lt;code>WebConfigurationManager&lt;/code> classes to access these
settings.&lt;/p>
&lt;!-- links --></description></item><item><title>Razer Comms</title><link>https://parsiya.net/blog/2017-09-21-razer-comms/</link><pubDate>Thu, 21 Sep 2017 22:45:20 -0400</pubDate><guid>https://parsiya.net/blog/2017-09-21-razer-comms/</guid><description>&lt;p>A couple of years ago I looked at Razer Comms. I found a bunch of stuff that I never reported or pursued. I discovered the application is &lt;a href="http://support.razerzone.com/software/comms" target="_blank" rel="noreferrer noopener">now retired&lt;/a> so I am publishing these.&lt;/p>
&lt;p>I did not look very hard but Razer Comms was essentially a webapp running via the &lt;a href="https://bitbucket.org/chromiumembedded/cef" target="_blank" rel="noreferrer noopener">Chromium Embedded Framework&lt;/a>. There were no checks on channel authorizations. You could read every channel including ones protected with passwords.&lt;/p>
&lt;p>You can see my notes at &lt;a href="https://github.com/parsiya/Parsia-Clone/tree/master/research/razer-comms" target="_blank" rel="noreferrer noopener">https://github.com/parsiya/Parsia-Clone/tree/master/research/razer-comms&lt;/a>.&lt;/p></description></item><item><title>TLDR: Base64</title><link>https://parsiya.net/blog/2017-08-06-tldr-base64/</link><pubDate>Sun, 06 Aug 2017 13:54:45 -0400</pubDate><guid>https://parsiya.net/blog/2017-08-06-tldr-base64/</guid><description>&lt;p>Some quick notes about base64 encoding. URL safe and avoiding a pitfall when using Burp Decoder.&lt;/p>
&lt;p>This document assumes you already know what base64 is and some of the major use-cases.&lt;/p></description></item><item><title>From Atom to Sublime Text</title><link>https://parsiya.net/blog/2017-07-08-from-atom-to-sublime-text/</link><pubDate>Sat, 08 Jul 2017 11:56:58 -0400</pubDate><guid>https://parsiya.net/blog/2017-07-08-from-atom-to-sublime-text/</guid><description>&lt;p>I have moved from Atom to Sublime. Atom is a nice editor with a lot of features but it has a lot of performance issues for what I want to do.&lt;/p>
&lt;p>Below is my setup for reference. When I want to do it again in a year (or a new machine) I can just use everything here or just use the config files. You can find the config files in my clone:&lt;/p>
&lt;ul>
&lt;li>&lt;a href="https://github.com/parsiya/Parsia-Clone/tree/master/configs/sublime-text" target="_blank" rel="noreferrer noopener">https://github.com/parsiya/Parsia-Clone/tree/master/configs/sublime-text&lt;/a>&lt;/li>
&lt;/ul></description></item><item><title>The Great Hiatus</title><link>https://parsiya.net/blog/2016-08-01-the-great-hiatus/</link><pubDate>Mon, 01 Aug 2016 02:04:23 -0400</pubDate><guid>https://parsiya.net/blog/2016-08-01-the-great-hiatus/</guid><description>&lt;p>This is a blog from the future. This is a copy of my post from March 1st 2018.&lt;/p>
&lt;p>I did not blog for almost exactly a year from July 28th 2016 to July 8th 2017.&lt;/p>
&lt;p>This is not something new, if you look at my blog dates you can see I work in clusters. I do a few blogs about something interesting in quick succession and then don't do anything for a while.&lt;/p>
&lt;p>You could call this a problem. Some people recommend holding off posts and then publishing them more steadily. I am not like that, I want to document what I do for future reference right now before I forget.&lt;/p></description></item><item><title>Thick Client Proxying - Part 6: How HTTP(s) Proxies Work</title><link>https://parsiya.net/blog/2016-07-28-thick-client-proxying-part-6-how-https-proxies-work/</link><pubDate>Thu, 28 Jul 2016 02:04:23 -0400</pubDate><guid>https://parsiya.net/blog/2016-07-28-thick-client-proxying-part-6-how-https-proxies-work/</guid><description>&lt;p>In order to create our own custom proxies, first we need to know how proxies work. When I wanted to write a custom proxy tool (it's a simple Python script) in &lt;a href="https://parsiya.net/blog/2015-10-19-proxying-hipchat-part-3-ssl-added-and-removed-here/" title="Proxying Hipchat Part 3: SSL Added and Removed Here">Hipchat part3&lt;/a>, I had to go back and learn how they work. I did not find such a resource online that looked at proxies from an infosec perspective. Most talked about how to configure caching or forwarding proxies and not much about MitM ones. I have briefly talked about it in the section 2 of the same post named &lt;code>How does a Proxy Work?&lt;/code>. In this post I am going to take a deep(er) dive. I actually read some RFCs and they were surprisingly well written.&lt;/p>
&lt;p>If you want to skip the intro, go to &lt;a href="#section-3" title="How HTTP Proxies Work">section 3&lt;/a>.&lt;/p></description></item><item><title>Gynvael Coldwind - Garage4Hackers - Notes from March 2014</title><link>https://parsiya.net/blog/2016-07-14-gynvael-coldwind-garage4hackers-notes-from-march-2014/</link><pubDate>Thu, 14 Jul 2016 23:03:51 -0400</pubDate><guid>https://parsiya.net/blog/2016-07-14-gynvael-coldwind-garage4hackers-notes-from-march-2014/</guid><description>&lt;p>Back in March 2014, Garage4Hackers had a live stream with Gynvael Coldwind. His talk was named &lt;code>&amp;quot;Data, data, data! I can't make bricks without clay&amp;quot;&lt;/code> or &lt;code>a few practical notes on reverse-engineering&lt;/code>. You can see the recording &lt;a href="https://www.youtube.com/watch?v=Jk5Yad598vs" target="_blank" rel="noreferrer noopener">on youtube&lt;/a>.&lt;/p>
&lt;p>Here are my notes that I discovered from 2014.&lt;/p></description></item><item><title>Windows Netsh Interface Portproxy</title><link>https://parsiya.net/blog/2016-06-07-windows-netsh-interface-portproxy/</link><pubDate>Tue, 07 Jun 2016 22:29:49 -0400</pubDate><guid>https://parsiya.net/blog/2016-06-07-windows-netsh-interface-portproxy/</guid><description>&lt;p>I thought I had found the Windows &lt;code>iptables&lt;/code> with &lt;a href="https://technet.microsoft.com/de-de/library/cc731068%28v=ws.10%29.aspx" target="_blank" rel="noreferrer noopener">Portproxy&lt;/a>
but I was wrong. But I learned something neat in the process and I am
documenting it.&lt;/p>
&lt;p>Portproxy allows you to listen on a certain port on one of your network
interfaces (or all interfaces) and redirect all traffic
&lt;strong>destined to that interface&lt;/strong> to another port/IP.&lt;/p>
&lt;p>The &lt;code>to that interface&lt;/code> is the limitation that unfortunately kills it. This will
be a short post.&lt;/p></description></item><item><title>Go Notes</title><link>https://parsiya.net/go/</link><pubDate>Wed, 01 Jun 2016 20:35:00 -0400</pubDate><guid>https://parsiya.net/go/</guid><description>Note: You can use these notes instead, but it's nice to have everything in one page:
https://github.com/parsiya/Hacking-with-Go Gophercises - Lessons Learned These are my notes when learning go from the Tour of Go and some other sources. A lot of copy/pasted from them and I have used double-quotes to indicate those are not written by me to the best of my ability. This is not something original and is mostly here as a quick lookup reference while learning Go.</description></item><item><title>Learning Go</title><link>https://parsiya.net/blog/2016-06-01-learning-go/</link><pubDate>Wed, 01 Jun 2016 20:35:00 -0400</pubDate><guid>https://parsiya.net/blog/2016-06-01-learning-go/</guid><description>&lt;p>I have decided to learn Go (or Golang). I went through the &lt;a href="https://tour.golang.org/" target="_blank" rel="noreferrer noopener">Tour of Go&lt;/a> and made some notes. Some of the items/code are directly copy pasted from there. The notes are just a cheatsheet to help me look things up quickly while learning. I will update that page as I learn more.&lt;/p>
&lt;p>You can see the notes at &lt;a href="https://parsiya.net/go/" title="Go Notes">https://parsiya.net/go/&lt;/a>.&lt;/p></description></item><item><title>Thick Client Proxying - Part 5: FileHippo App Manager or the Bloated Hippo</title><link>https://parsiya.net/blog/2016-05-15-thick-client-proxying-part-5-filehippo-app-manager-or-the-bloated-hippo/</link><pubDate>Sun, 15 May 2016 16:55:24 -0400</pubDate><guid>https://parsiya.net/blog/2016-05-15-thick-client-proxying-part-5-filehippo-app-manager-or-the-bloated-hippo/</guid><description>&lt;p>I have talked a lot about this and that but have done nothing in action. Now I will talk about proxying actual applications. I will start with something easy, the &lt;a href="http://filehippo.com/download_app_manager/" target="_blank" rel="noreferrer noopener">FileHippo App Manager&lt;/a>. This app was chosen because it can be proxied with Burp, it does not use TLS and it has its own proxy settings (also works with Internet Explorer proxy settings). The requests are pretty simple to understand. I like the FileHippo website because it archives old versions of software. For example I loved the non-bloated Yahoo! Messenger 8.0 when I used it (it's pretty popular in some places) and used FileHippo to download the old versions.&lt;/p>
&lt;p>FileHippo App Manager turned out to be more interesting than I thought and this post turned into some .NET reverse engineering using dnSpy. Here's what I talk about in this post:&lt;/p>
&lt;ul>
&lt;li>The app contains the AWS SDK and a fortunately invalid set of AWS Access/Secret keys. Both the SDK and the keys are in dead code.&lt;/li>
&lt;li>Requests have an &lt;code>AccessToken&lt;/code> header which is generated client-side. We will discuss how it is generated.&lt;/li>
&lt;li>The application has a &amp;quot;hidden&amp;quot; DEBUG mode which unfortunately does nothing special. We will discover how to enable it.&lt;/li>
&lt;/ul></description></item><item><title>Looking for Apps to Proxy</title><link>https://parsiya.net/blog/2016-05-09-looking-for-apps-to-proxy/</link><pubDate>Mon, 09 May 2016 01:37:41 -0400</pubDate><guid>https://parsiya.net/blog/2016-05-09-looking-for-apps-to-proxy/</guid><description>&lt;p>It's been a while since Burp part four and I want to continue writing these. It's time to actually proxy applications. However I have three problems:&lt;/p>
&lt;ol>
&lt;li>I was too busy at work.&lt;/li>
&lt;li>I could not find a lot of interesting applications that are interesting to proxy and can showcase different Burp functionalities that we talked about.&lt;/li>
&lt;li>I found some interesting applications but there were security vulns so I am going through disclosure (unfortunately I may never be able to release them publicly).&lt;/li>
&lt;/ol>
&lt;p>The last point was a surprise, these are decently popular apps and I could not believe that no one has looked at them before.&lt;/p>
&lt;p>Nevertheless, I will continue soon.&lt;/p>
&lt;p>In the meanwhile, Burp version &lt;code>1.7&lt;/code> has been &lt;a href="http://releases.portswigger.net/" target="_blank" rel="noreferrer noopener">released&lt;/a>. Now we have Burp projects. Instead of saving the state everyday, we can use one project file that contains all the items. Pretty cool. Some of the items have changed, especially options. Now it has &lt;code>User Options&lt;/code> and &lt;code>Project Options&lt;/code> but the options by themselves are still there.&lt;/p></description></item><item><title>Cloudfront and TLS</title><link>https://parsiya.net/blog/2016-04-14-cloudfront-and-tls/</link><pubDate>Thu, 14 Apr 2016 20:45:15 -0400</pubDate><guid>https://parsiya.net/blog/2016-04-14-cloudfront-and-tls/</guid><description>&lt;p>I finally decided to cave in and take advantage of the Amazon Cloudfront free TLS certificate. I know I will end up paying more than what I already do but I pay few bucks each month. Each month I pay one dollar for two hosted zones and another dollar or so for the bandwidth. Even if I was still in my home country, I would have been able to pay this as it is less than a large pizza even where I lived.&lt;/p>
&lt;p>If you are interested in free hosting alternatives, you can use &lt;a href="https://gohugo.io/tutorials/github-pages-blog/" target="_blank" rel="noreferrer noopener">Github-pages&lt;/a>, &lt;a href="https://gohugo.io/tutorials/hosting-on-bitbucket/" target="_blank" rel="noreferrer noopener">Bitbucket&lt;/a> or just go with the excellent &lt;a href="https://gitlab.com/pages/hugo" target="_blank" rel="noreferrer noopener">Gitlab-Pages&lt;/a> (which supports Hugo and whole lot of other static website generators natively).&lt;/p>
&lt;p>It took me a lot of tries and probably burning a good amount of money on Cloudfront invalidation requests (otherwise I had to wait for a day or so to see the changes) but it finally worked. The trick was to setup the origin policy during creation of the distribution as it cannot be modified through the web portal after that.&lt;/p>
&lt;p>Burp part five is still on hold for now because I am doing something else.&lt;/p></description></item><item><title>Thick Client Proxying - Part 4: Burp in Proxy Chains</title><link>https://parsiya.net/blog/2016-04-07-thick-client-proxying-part-4-burp-in-proxy-chains/</link><pubDate>Thu, 07 Apr 2016 21:17:25 -0400</pubDate><guid>https://parsiya.net/blog/2016-04-07-thick-client-proxying-part-4-burp-in-proxy-chains/</guid><description>&lt;p>In this post I will talk about using Burp as part of a proxy chain. The number of applications that can be proxied by Burp and used with Burp in proxy chains is &lt;em>infinite&lt;/em> for documentation purposes. Instead I am going to demonstrate how to use some of more used tools with Burp in proxy chain. All of this is going to happen on a Windows 7 Virtual Machine (VM).&lt;/p>
&lt;p>These applications/utilities are:&lt;/p>
&lt;ul>
&lt;li>&lt;a href="https://www.cygwin.com/" target="_blank" rel="noreferrer noopener">Cygwin&lt;/a>: I will use cURL commands for demonstration purposes.&lt;/li>
&lt;li>IBM Appscan Standard: I will use the evaluation version.&lt;/li>
&lt;li>&lt;a href="https://www.charlesproxy.com/download/latest-release/" target="_blank" rel="noreferrer noopener">Charles Proxy&lt;/a>: For when you have to use multiple proxies.&lt;/li>
&lt;li>&lt;a href="https://www.telerik.com/download/fiddler" target="_blank" rel="noreferrer noopener">Fiddler&lt;/a>: Same as above.&lt;/li>
&lt;li>&lt;a href="https://www.soapui.org/downloads/soapui.html" target="_blank" rel="noreferrer noopener">SoapUI&lt;/a>&lt;/li>
&lt;/ul>
&lt;p>You don't need Burp Pro to play along and apart from Appscan, all application are free to use. For Appscan we will use the evaluation version which is free for its demo test.&lt;/p></description></item><item><title>Hugo Octopress Update</title><link>https://parsiya.net/blog/2016-04-03-hugo-octopress-update/</link><pubDate>Sun, 03 Apr 2016 13:13:39 -0400</pubDate><guid>https://parsiya.net/blog/2016-04-03-hugo-octopress-update/</guid><description>&lt;p>I have made a good number of changes to the &lt;a href="https://github.com/parsiya/hugo-octopress" target="_blank" rel="noreferrer noopener">Hugo-Octopress&lt;/a> theme. As I have been using the theme more and more, I have realized there were a bunch of bugs (some were pointed out on Github).&lt;/p>
&lt;p>Apart from Bugs, I had hardcoded too many settings in the theme. For example, modifying the text in the sidebar could only be accomplished by changing the sidebar template. Ideally user should not need to modify anything in the theme and it should be customizable by just using the config file.&lt;/p>
&lt;p>In the end I created a bunch of issues on Github and then closed them myself. I am not quite sure if this is correct &lt;code>git&lt;/code> but eh :D&lt;/p></description></item><item><title>Thick Client Proxying - Part 3: Burp Options and Extender</title><link>https://parsiya.net/blog/2016-04-02-thick-client-proxying-part-3-burp-options-and-extender/</link><pubDate>Sat, 02 Apr 2016 20:22:37 -0400</pubDate><guid>https://parsiya.net/blog/2016-04-02-thick-client-proxying-part-3-burp-options-and-extender/</guid><description>&lt;p>Previous parts:&lt;/p>
&lt;ul>
&lt;li>&lt;a href="https://parsiya.net/blog/2016-03-27-thick-client-proxying-part-1-burp-interception-and-proxy-listeners/" title="Burp Tips and Tricks for Non-Webapp Testing - Part 1: Interception and Proxy Listeners">Burp Tips and Tricks for Non-Webapp Testing - Part 1: Interception and Proxy Listeners&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://parsiya.net/blog/2016-03-29-thick-client-proxying-part-2-burp-history-intruder-scanner-and-more/" title="Burp Tips and Tricks for Non-Webapp Testing - Part 2: History, Intruder, Scanner and More">Burp Tips and Tricks for Non-Webapp Testing - Part 2: History, Intruder, Scanner and More&lt;/a>&lt;/li>
&lt;/ul>
&lt;p>Almost there, I will get through &lt;code>Options&lt;/code> and &lt;code>Extender&lt;/code> in this part and we will actually start doing stuff moving forward.&lt;/p></description></item><item><title>Thick Client Proxying - Part 2: Burp History, Intruder, Scanner and More</title><link>https://parsiya.net/blog/2016-03-29-thick-client-proxying-part-2-burp-history-intruder-scanner-and-more/</link><pubDate>Tue, 29 Mar 2016 19:57:53 -0400</pubDate><guid>https://parsiya.net/blog/2016-03-29-thick-client-proxying-part-2-burp-history-intruder-scanner-and-more/</guid><description>&lt;p>In &lt;a href="https://parsiya.net/blog/2016-03-27-thick-client-proxying-part-1-burp-interception-and-proxy-listeners/" title="Burp Tips and Tricks for Non-Webapp Testing - Part 1: Interception and Proxy Listeners">part1&lt;/a> I talked about some of Burp's functionalities with regards to testing non-webapps. I did not expect it to be that long, originally I had intended to just shared some quick tips that I use. Now you are forced to read my drivel.&lt;/p>
&lt;p>In this part I will talk about &lt;code>Target &amp;gt; Scope&lt;/code>, &lt;code>Proxy &amp;gt; HTTP History&lt;/code> and &lt;code>Intruder/Scanner&lt;/code>. I will discuss a bit of &lt;code>Scanner&lt;/code>, &lt;code>Repeater&lt;/code> and &lt;code>Comparer&lt;/code> too, but there is not much to discuss for the last three. They are pretty straightforward.&lt;/p></description></item><item><title>Thick Client Proxying - Part 1: Burp Interception and Proxy Listeners</title><link>https://parsiya.net/blog/2016-03-27-thick-client-proxying-part-1-burp-interception-and-proxy-listeners/</link><pubDate>Sun, 27 Mar 2016 02:45:03 -0400</pubDate><guid>https://parsiya.net/blog/2016-03-27-thick-client-proxying-part-1-burp-interception-and-proxy-listeners/</guid><description>&lt;p>Burp is not just used for web application testing. I usually use it during mobile and thick client tests. If the application is using HTTP methods then Burp is your best friend.&lt;/p>
&lt;p>I am going to document a bunch of Burp tips and tricks that have helped me during my work. One purpose is to share it with the world and not be the other guy from Wham! (:D) and the other is to have it in an accessible place (similar to the cheat sheet in the menu).&lt;/p>
&lt;p>This part one I talk about Interception and Proxy listeners which are configured via &lt;code>Proxy &amp;gt; Options&lt;/code>.&lt;/p>
&lt;p>At the time of writing the current version of Burp Pro is &lt;code>1.6.39&lt;/code> and most items should apply to the current Burp Free version (&lt;code>1.6.32&lt;/code>). Most settings have not changed since I started working with Burp (v1.5). You can download Burp from: &lt;a href="https://portswigger.net/burp/download.html" target="_blank" rel="noreferrer noopener">https://portswigger.net/burp/download.html&lt;/a>.&lt;/p>
&lt;p>When I started this, I did not think I have so much stuff to write about Burp. So I broke it into multiple parts. Please note that these series of posts are not targeted towards web application testing so I have skipped some functionalities. If you have any favorite tips or usecases and want them included with credit please let me know, as usual feedback is always welcome.&lt;/p></description></item><item><title>Cheat Sheet</title><link>https://parsiya.net/cheatsheet/</link><pubDate>Wed, 24 Feb 2016 22:29:57 -0500</pubDate><guid>https://parsiya.net/cheatsheet/</guid><description>You will find those commands and tips that I need from time to time (and usually forget when I need them). This is a page to complement my clone at parsiya.io and gives me a simple repository of how-tos I can access online. Look at the table of contents below or ctrl+f and search for keywords.
Tar Compress a Directory Using tar Decompress a tar.gz file OpenSSL Dump The TLS Certificate of a Domain with OpenSSL TLS Connection with a Specific Ciphersuite with OpenSSL AWS How to Use s3deploy Sync a Directory with an Amazon S3 bucket with s3cmd Change the MIME-Type of the CSS file After Upload to Fix CSS not Displaying Correctly Set the Website Index to a Non-Root file in a Static Website on S3 Use AWS CLI Without Credentials Windows Shortcut to IE (or WinINET) Proxy Settings where.</description></item><item><title>Installing Burp Certificate Authority in Windows Certificate Store</title><link>https://parsiya.net/blog/2016-02-21-installing-burp-certificate-authority-in-windows-certificate-store/</link><pubDate>Sun, 21 Feb 2016 14:42:41 -0500</pubDate><guid>https://parsiya.net/blog/2016-02-21-installing-burp-certificate-authority-in-windows-certificate-store/</guid><description>&lt;p>I was writing another blog post and I realized that I keep repeating how to do the same things, so I decided to write some tutorial-ish things and just link them.&lt;/p>
&lt;p>Burp uses custom certificates to Man-in-the-Middle (MitM) the traffic. All of these certificates are signed by Burp's root Certificate Authority (CA). Each installation of Burp generates its own root CA that needs to be installed in the browser or Operating System's certificate store to be recognized properly. Otherwise browsers will return warnings and some thick client applications will not recognize these certificates as valid.&lt;/p>
&lt;p>Each installation of Burp generates its own root CA so it is unlikely that others can gain access to it and sign certificates to MitM your connection. To get the certificate's private key, the attackers need to get to your local machine and if so they have better ways to look at your traffic anyway.&lt;/p>
&lt;p>Alternate instructions by Portswigger: &lt;a href="https://support.portswigger.net/customer/en/portal/articles/1783075-installing-burp-s-ca-certificate-in-your-browser" target="_blank" rel="noreferrer noopener">https://support.portswigger.net/customer/en/portal/articles/1783075-installing-burp-s-ca-certificate-in-your-browser&lt;/a>&lt;/p>
&lt;p>For instructions on installing/removing Burp's CA in other browsers and devices please use Portswigger's website: &lt;a href="https://support.portswigger.net/customer/en/portal/articles/1783075-installing-burp-s-ca-certificate-in-your-browser" target="_blank" rel="noreferrer noopener">https://support.portswigger.net/customer/en/portal/articles/1783075-installing-burp-s-ca-certificate-in-your-browser&lt;/a>.&lt;/p>
&lt;p>&lt;strong>Note&lt;/strong>: These instructions are for Burp version 1.6.37 Pro and 1.6.32 Free. As long as I remember (v1.5) these instructions have not changed, although they may change in the future but I really doubt it.&lt;/p></description></item><item><title>Archive Page in Hugo</title><link>https://parsiya.net/blog/2016-02-14-archive-page-in-hugo/</link><pubDate>Sun, 14 Feb 2016 20:52:45 -0500</pubDate><guid>https://parsiya.net/blog/2016-02-14-archive-page-in-hugo/</guid><description>&lt;p>This is a re-hash of my answer on Hugo forums about creating a custom archive page. You can see the answer &lt;a href="https://discuss.gohugo.io/t/blog-archives-page/2577/16" target="_blank" rel="noreferrer noopener">here&lt;/a>.&lt;/p>
&lt;p>Creating a custom archive page in Hugo is pretty simple. I think there are better ways to do this but this works as of version 0.15.&lt;/p></description></item><item><title>From Octopress to Hugo</title><link>https://parsiya.net/blog/2016-02-02-from-octopress-to-hugo/</link><pubDate>Tue, 02 Feb 2016 22:58:26 -0500</pubDate><guid>https://parsiya.net/blog/2016-02-02-from-octopress-to-hugo/</guid><description>&lt;p>In &lt;a href="https://parsiya.net/blog/2016-01-31-why-hugo/" title="Why Hugo?">my previous post&lt;/a> I talked about why I moved from Octopress to Hugo. You can also see the last archive of my Octopress blog (previously a private repo on Bitbucket) on &lt;a href="https://github.com/parsiya/Octopress-Blog" target="_blank" rel="noreferrer noopener">github&lt;/a> and this is the new site. If I had wanted to use an already existing Hugo theme, it would have not taken more than a few hours.&lt;/p>
&lt;p>In this post I am going to talk about how I managed the migration and any interesting things that I encountered in the process. I will also introduce the &lt;a href="https://github.com/parsiya/hugo-octopress/" target="_blank" rel="noreferrer noopener">Hugo-Octopress&lt;/a> theme (you are looking at it), which is the classic Octopress theme ported to Hugo. If you like what you see, please go ahead and use it. If there are any issues please use the &lt;a href="https://github.com/parsiya/Hugo-Octopress/issues" target="_blank" rel="noreferrer noopener">Github issue tracker&lt;/a> or contact me another way. I will try my best to fix them but please remember that I am not a developer and do not know much about css :).&lt;/p></description></item><item><title>Why Hugo?</title><link>https://parsiya.net/blog/2016-01-31-why-hugo/</link><pubDate>Sun, 31 Jan 2016 20:22:19 -0500</pubDate><guid>https://parsiya.net/blog/2016-01-31-why-hugo/</guid><description>&lt;p>As you may have noticed (well no one reads this so I am fine), I have moved from &lt;a href="http://octopress.org" target="_blank" rel="noreferrer noopener">Octopress&lt;/a> to &lt;a href="https://gohugo.io" target="_blank" rel="noreferrer noopener">Hugo&lt;/a>. I have been trying to make this change for a while but due to laziness and some other matters it did not happen. I am going to talk about why I decided on the move and what I did. In then ext post I will talk about my migration from Octopress to Hugo.&lt;/p></description></item><item><title>Intro to .NET Remoting for Hackers</title><link>https://parsiya.net/blog/2015-11-14-intro-to-.net-remoting-for-hackers/</link><pubDate>Sat, 14 Nov 2015 16:22:36 +0000</pubDate><guid>https://parsiya.net/blog/2015-11-14-intro-to-.net-remoting-for-hackers/</guid><description>&lt;p>This is a simple tutorial about &lt;a href="https://msdn.microsoft.com/en-us/library/kwdt6w2k%28v=vs.71%29.aspx" target="_blank" rel="noreferrer noopener">.NET Remoting&lt;/a>. I am going to re-create a very simple RCE and local privilege escalation that I encountered in my projects and use it to explain .NET Remoting and simple debugging in &lt;code>dnSpy&lt;/code>.&lt;/p>
&lt;p>In this post we will:&lt;/p>
&lt;ol>
&lt;li>Do a brief introduction to .NET Remoting&lt;/li>
&lt;li>Develop a simple .NET Remoting client and a vulnerable server in Visual Studio&lt;/li>
&lt;li>Observe .NET Remoting traffic&lt;/li>
&lt;li>See .NET Remoting in action by doing some basic debugging with dnSpy&lt;/li>
&lt;li>Re-create the vulnerable application&lt;/li>
&lt;li>Use dnSpy to patch and create modified .NET modules to exploit our sample vulnerable server&lt;/li>
&lt;/ol>
&lt;p>If you know of any applications that use .NET Remoting please let me know. I want to look at them.&lt;/p>
&lt;p>Code is at:&lt;/p>
&lt;ul>
&lt;li>&lt;a href="https://github.com/parsiya/Parsia-Code/tree/master/net-remoting" target="_blank" rel="noreferrer noopener">https://github.com/parsiya/Parsia-Code/tree/master/net-remoting&lt;/a>&lt;/li>
&lt;/ul></description></item><item><title>Proxying Hipchat Part 3: SSL Added and Removed Here :^)</title><link>https://parsiya.net/blog/2015-10-19-proxying-hipchat-part-3-ssl-added-and-removed-here/</link><pubDate>Mon, 19 Oct 2015 21:42:10 +0000</pubDate><guid>https://parsiya.net/blog/2015-10-19-proxying-hipchat-part-3-ssl-added-and-removed-here/</guid><description>&lt;p>Finally we are at part 3 of proxying Hipchat. This has been quite the adventure. In &lt;a href="https://parsiya.net/blog/2015-10-08-proxying-hipchat-part-1-where-did-the-traffic-go/" title="Proxying Hipchat Part 1: Where did the Traffic Go?">&lt;strong>part1&lt;/strong>&lt;/a> we identified the endpoints. In &lt;a href="https://parsiya.net/blog/2015-10-09-proxying-hipchat-part-2-so-you-think-you-can-use-burp/" title="Proxying Hipchat Part 2: So You Think You Can Use Burp?">&lt;strong>part2&lt;/strong>&lt;/a> we answered the question So you think you can use Burp with yes and proxied some of Hipchat's traffic with Burp.&lt;/p>
&lt;p>In this part we will talk about developing our own proxy in Python to view Hipchat's traffic to/form &lt;code>hipchatserver.com&lt;/code> (our example Hipchat server). First we are going to discuss how proxies work and we will get over Burp breaking our heart by creating our own proxy in Python to observe and dump the traffic in plaintext.&lt;/p>
&lt;p>Related (crappy) code is at now in my clone at:&lt;/p>
&lt;ul>
&lt;li>&lt;a href="https://github.com/parsiya/Parsia-Code/tree/master/hipchat-proxy" target="_blank" rel="noreferrer noopener">https://github.com/parsiya/Parsia-Code/tree/master/hipchat-proxy&lt;/a>&lt;/li>
&lt;/ul>
&lt;p>For a similar effort (although with a much more complex proxy in &lt;code>erlang&lt;/code>) look at &lt;a href="http://blog.silentsignal.eu/2015/10/02/proxying-nonstandard-https-traffic/" target="_blank" rel="noreferrer noopener">http://blog.silentsignal.eu/2015/10/02/proxying-nonstandard-https-traffic/&lt;/a>.&lt;/p></description></item><item><title>Proxying Hipchat Part 2: So You Think You Can Use Burp?</title><link>https://parsiya.net/blog/2015-10-09-proxying-hipchat-part-2-so-you-think-you-can-use-burp/</link><pubDate>Fri, 09 Oct 2015 22:34:37 +0000</pubDate><guid>https://parsiya.net/blog/2015-10-09-proxying-hipchat-part-2-so-you-think-you-can-use-burp/</guid><description>&lt;p>In &lt;a href="https://parsiya.net/blog/2015-10-08-proxying-hipchat-part-1-where-did-the-traffic-go/" title="Proxying Hipchat Part 1: Where did the Traffic Go?">&lt;strong>part1&lt;/strong>&lt;/a> I talked about identifying Hipchat endpoints and promised to discuss proxying the application. In this post I will show how to proxy &lt;em>some&lt;/em> of Hipchat's traffic using Burp.&lt;/p>
&lt;p>This is specific to Hipchat client for Windows. The current version at the time of writing was is &lt;strong>2.2.1361&lt;/strong>. Atlassian is skipping version 3 and version 4 still in beta.&lt;/p></description></item><item><title>Proxying Hipchat Part 1: Where did the Traffic Go?</title><link>https://parsiya.net/blog/2015-10-08-proxying-hipchat-part-1-where-did-the-traffic-go/</link><pubDate>Thu, 08 Oct 2015 23:05:24 +0000</pubDate><guid>https://parsiya.net/blog/2015-10-08-proxying-hipchat-part-1-where-did-the-traffic-go/</guid><description>&lt;p>This is a slightly different version of a series of blog post that I wrote on our internal blog about proxying. I see that proxying traffic is a time consuming step in testing thick client applications so I thought I would share what I know. I tackled Hipchat. Why Hipchat? Because it uses a known protocol (XMPP) and I thought it's an interesting application.&lt;/p>
&lt;p>I used Hipchat Windows client version 2. At the time of writing version 4 is in beta. In this part we will see how we can identify endpoints from traffic captures even when they are behind a load balancer/shared hosting etc. In next parts we will start proxying.&lt;/p></description></item><item><title>Network Traffic Attribution on Windows</title><link>https://parsiya.net/blog/2015-08-01-network-traffic-attribution-on-windows/</link><pubDate>Sat, 01 Aug 2015 19:37:42 +0000</pubDate><guid>https://parsiya.net/blog/2015-08-01-network-traffic-attribution-on-windows/</guid><description>&lt;p>Thick client assessments come in different flavors. Most of our work is on
&lt;code>consumer applications&lt;/code> where &lt;code>consumer&lt;/code> means either the customer or an
employee of our client. But these applications usually have network
communications.&lt;/p>
&lt;p>When looking at thick client applications from a network traffic perspective, we
face two big challenges:&lt;/p>
&lt;ol>
&lt;li>
&lt;p>&lt;strong>Traffic Attribution&lt;/strong> or &lt;strong>Where does this traffic come from?&lt;/strong>: How to we
identify application's traffic? The operating system (in this case Windows)
is running many applications and services. Each of them may have network
connectivity.&lt;/p>
&lt;/li>
&lt;li>
&lt;p>&lt;strong>Proxying Traffic&lt;/strong> or &lt;strong>How do I look view/modify traffic?&lt;/strong>: This is more
challenging and involves capturing, modifying and in a lot of cases
decrypting/decoding target application's traffic. This could be as easy as
setting up Burp via an application setting (EZ-mode) or as hard as setting up
your own access point to capture a device's traffic then developing your own
decryption plugin for your proxy tool (good luck).&lt;/p>
&lt;/li>
&lt;/ol>
&lt;p>In this post, I will be talking about the much easier first challenge. I will be
talking about some of the tools and techniques that I use to accomplish this.
This is not a groundbreaking post ;). We will use a simple application, in this
case &lt;code>notepad++&lt;/code>.&lt;/p></description></item><item><title>Image Popup and Octopress</title><link>https://parsiya.net/blog/2015-07-26-image-popup-and-octopress/</link><pubDate>Sun, 26 Jul 2015 23:02:58 +0000</pubDate><guid>https://parsiya.net/blog/2015-07-26-image-popup-and-octopress/</guid><description>&lt;p>&lt;strong>Update&lt;/strong>: I have migrated the blog to &lt;a href="https://gohugo.io" target="_blank" rel="noreferrer noopener">Hugo&lt;/a> and I do not use this anymore. However, it is still in the repository.&lt;/p>
&lt;p>I finally realized that I need an image popup plugin. The image plugins that I usually use do not support this. They are fine for normal images but not for larger ones. When I see a screenshot of a tool, I want to be able to zoom in. In my quest I looked at a few plugins and methods and finally decided to use &lt;a href="https://github.com/ctdk/octopress-image-popup" target="_blank" rel="noreferrer noopener">https://github.com/ctdk/octopress-image-popup&lt;/a>. It creates resized thumbnails automatically and the installation procedure is short and simple.&lt;/p>
&lt;p>However, it did not work for me out of the box. I created a test post with just an image and while the plugin worked, there are things that I did not like about it.&lt;/p></description></item><item><title>Tales from the Crypt(o) - Leaking AES Keys</title><link>https://parsiya.net/blog/2015-01-06-tales-from-the-crypto-leaking-aes-keys/</link><pubDate>Tue, 06 Jan 2015 23:36:48 +0000</pubDate><guid>https://parsiya.net/blog/2015-01-06-tales-from-the-crypto-leaking-aes-keys/</guid><description>&lt;p>This post is part one of a two part internal blog entry on creating a Pintool for an assessment. Unfortunately I cannot talk about it, so I decided to put the first part out. If I find an opensource program similar to the assessment I will try and recreate the tool (but I am not holding my breath). As this part is essentially a build up, it may not be coherent at times. Alteratively, if you really want to read it, you can join us. We are almost always hiring (let me do the referral though ;).&lt;/p>
&lt;p>Today we are going to talk about discovering encryption keys in sneaky ways. We will start with simple examples, do a bit of Digital Forensics or DF (for low standards of DF) and finally in part two we will use our recently acquired knowledge of Pintool to do &lt;code>[redacted]&lt;/code>.&lt;/p>
&lt;p>First let's talk a bit about the inner-workings of AES decryption. By inner-workings of AES I do not mean the following diagrams that you have seen so many times.&lt;/p></description></item><item><title>Pin Adventures - Chapter 1 - PinSolver Mk1</title><link>https://parsiya.net/blog/2014-12-08-pin-adventures-chapter-1-pinsolver-mk1/</link><pubDate>Mon, 08 Dec 2014 20:46:59 +0000</pubDate><guid>https://parsiya.net/blog/2014-12-08-pin-adventures-chapter-1-pinsolver-mk1/</guid><description>&lt;p>While writing the writeups for the &lt;a href="http://parsiya.net/blog/2014-10-07-my-adventure-with-fireeye-flare-challenge/#ch6" target="_blank" rel="noreferrer noopener">Flare On Challenge 6&lt;/a> I came upon &lt;a href="http://gaasedelen.blogspot.com/2014/09/solving-fireeyes-flare-on-six-via-side.html" target="_blank" rel="noreferrer noopener">an alternative solution&lt;/a> by &lt;a href="https://twitter.com/gaasedelen" target="_blank" rel="noreferrer noopener">@gaasedelen&lt;/a> to use the number of executed instructions as a side-channel. Recently during an engagement I used &lt;a href="https://software.intel.com/en-us/articles/pintool" target="_blank" rel="noreferrer noopener">Pintool&lt;/a> to do &lt;code>[redacted]&lt;/code>. Now that I have a bit of time, I decided to use the idea to write such a tool.&lt;/p>
&lt;p>As an example, we will use a C program that checks input for a hardcoded value using &lt;code>strncmp&lt;/code>. We want to see if it's vulnerable to this side-channel (number of executed instructions).&lt;/p></description></item><item><title>Building memfetch on Kali + Comments</title><link>https://parsiya.net/blog/2014-11-18-building-memfetch-on-kali-comments/</link><pubDate>Tue, 18 Nov 2014 23:21:01 +0000</pubDate><guid>https://parsiya.net/blog/2014-11-18-building-memfetch-on-kali-comments/</guid><description>&lt;p>I've used Disqus to add comments. At the moment, guests can comment and comments
do not need to be approved (unless they have links). Hopefully there won't be
much spam to sink the occasional comment that I think will be posted.&lt;/p>
&lt;p>Update from 2020: Comments without approval were a mistake. I got so much spam
and harassment.&lt;/p>
&lt;p>Note: I just wanted to make it work in a hurry. There are probably better ways
of doing this.&lt;/p>
&lt;p>I stumbled upon the very useful tool
&lt;a href="http://lcamtuf.coredump.cx/soft/memfetch.tgz" target="_blank" rel="noreferrer noopener">memfetch&lt;/a> by the talented
&lt;em>lcamtuf&lt;/em>. The utility is quite old (from 2003 if I recall correctly) and I
could not build it using the provided makefile.&lt;/p></description></item><item><title>My Adventure with Fireeye FLARE Challenge</title><link>https://parsiya.net/blog/2014-09-23-my-adventure-with-fireeye-flare-challenge/</link><pubDate>Tue, 23 Sep 2014 02:31:44 +0000</pubDate><guid>https://parsiya.net/blog/2014-09-23-my-adventure-with-fireeye-flare-challenge/</guid><description>&lt;p>These are my (rather long) solutions to Fireeye's FLARE challenge. This is just not the solution but other ways that I tried. This was a great learning experience for me so I am writing this post to document everything I tried. As a result, this post is somewhat long.&lt;/p>
&lt;p>If you have any feedback, please let me know. I spent a lot of time on this writeup and I am always happy to learn new stuff. My email and twitter handle are in the sidebar.&lt;/p>
&lt;p>I am a bit late to the party. There &lt;del>were two&lt;/del> are now other three solutions posted (that I know of). Check them out.&lt;/p>
&lt;ul>
&lt;li>&lt;a href="https://www.codeandsec.com/Detailed-Solutions-to-FireEye-FLARE-Challenge" target="_blank" rel="noreferrer noopener">Detailed Solutions to FireEye FLARE Challenge&lt;/a>&lt;/li>
&lt;li>&lt;a href="http://www.ghettoforensics.com/2014/09/a-walkthrough-for-flare-re-challenges.html" target="_blank" rel="noreferrer noopener">A Walk through for FLARE RE Challenges&lt;/a>&lt;/li>
&lt;li>The FLARE On Challenge Solutions by Fireye
&lt;ul>
&lt;li>&lt;a href="http://www.fireeye.com/blog/technical/cyber-exploits/2014/11/the-flare-on-challenge-solutions-part-1-of-2.html" target="_blank" rel="noreferrer noopener">Part 1 - solutions for challenges 1 to 5&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://www.fireeye.com/blog/threat-research/2014/11/flare_on_challengep.html" target="_blank" rel="noreferrer noopener">Part 2 - solutions for challenges 6 and 7&lt;/a>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul></description></item><item><title>Malware Adventure</title><link>https://parsiya.net/blog/2014-09-21-malware-adventure/</link><pubDate>Sun, 21 Sep 2014 19:11:43 +0000</pubDate><guid>https://parsiya.net/blog/2014-09-21-malware-adventure/</guid><description>Update 28 Oct 2017:\ I have moved most of my code under one repository. Malware adventure is copied at two places:
https://github.com/parsiya/malwareadventure https://github.com/parsiya/Parsia-Code/tree/master/malware-adventure A fork of PAWS is here:
https://github.com/Moonbase59/PAWS I finally caved in and started to push some of my code to github bitbucket. It is located at https://bitbucket.org/parsiya and is almost empty ;).
This is Malware Adventure. It's a small adventure game I wrote using PAWS.</description></item><item><title>Fireeye's FLARE Challenge</title><link>https://parsiya.net/blog/2014-09-02-fireeyes-flare-challenge/</link><pubDate>Tue, 02 Sep 2014 00:34:00 +0000</pubDate><guid>https://parsiya.net/blog/2014-09-02-fireeyes-flare-challenge/</guid><description>It's been a while. I know I should have updated more frequently but lazyness prevails.
Anyway, I was busy doing Fireeye's FlARE challenges for a month or so (it was depressing to see people finish in 10 hours :). You can find the challenges at http://flare-on.com. I learned a lot doing them. They will release solutions in 2 weeks. I am also working on a writeup which I will release then.</description></item><item><title>Apple's Common Crypto Library Defaults to a Zero IV if One is not Provided</title><link>https://parsiya.net/blog/2014-07-03-apples-common-crypto-library-defaults-to-a-zero-iv-if-one-is-not-provided/</link><pubDate>Thu, 03 Jul 2014 01:30:18 +0000</pubDate><guid>https://parsiya.net/blog/2014-07-03-apples-common-crypto-library-defaults-to-a-zero-iv-if-one-is-not-provided/</guid><description>Today I was writing some guidelines about generating keys for mobile applications at work. While providing code examples in Java and Obj-C for AES encryption I happened to look at Apple's [Common Crypto] CCLink library . While going through the source code for [CommonCryptor.c] CCLink2, I noticed that IV is commented as /* optional initialization vector */. This makes sense because not all ciphers use IV and not all AES modes of operation (e.</description></item><item><title>Piping SSL/TLS Traffic from SoapUI to Burp</title><link>https://parsiya.net/blog/2014-06-25-piping-ssl/tls-traffic-from-soapui-to-burp/</link><pubDate>Wed, 25 Jun 2014 22:04:53 +0000</pubDate><guid>https://parsiya.net/blog/2014-06-25-piping-ssl/tls-traffic-from-soapui-to-burp/</guid><description>Recently I was trying to test a web service. The traffic was over SSL/TLS and everything was fine. As I am better with Burp than SoapUI, I wanted to use Burp as a proxy for SoapUI. This should be an easy matter. Burp will create a custom certificate (signed by its root CA) for each site and effectively Man-in-the-Middle the connection. But this time it was different, I was getting the dreaded Peer not Authenticated error.</description></item><item><title>Pasting Shellcode in GDB using Python</title><link>https://parsiya.net/blog/2014-05-25-pasting-shellcode-in-gdb-using-python/</link><pubDate>Sun, 25 May 2014 18:39:58 +0000</pubDate><guid>https://parsiya.net/blog/2014-05-25-pasting-shellcode-in-gdb-using-python/</guid><description>A few days ago I was trying to write an exploit for a buffer overflow with GDB. This was a console application and pasting shellcode would mess with it.
There are a few options:
Writing shellcode to a file and then using it as input for GDB. # you can also include GDB commands like setting up breakpoints (e.g. b * 0xDEADBEEF) # remember to include a new line after each command $ python -c &amp;#39;print &amp;#34;b * 0xDEADBEEF&amp;#34; + &amp;#34;\n&amp;#34; + &amp;#34;\x41&amp;#34;*1000 + &amp;#34;\n&amp;#34;&amp;#39; &amp;gt; input # $ perl -e for perl # start debugging with GDB # -q (quiet mode): no text at startup $ gdb executable1 -q (gdb) run &amp;lt; input After this you can manually debug in GDB.</description></item><item><title>Amazon S3 and CSS</title><link>https://parsiya.net/blog/2014-04-22-amazon-s3-and-css/</link><pubDate>Tue, 22 Apr 2014 14:03:32 +0000</pubDate><guid>https://parsiya.net/blog/2014-04-22-amazon-s3-and-css/</guid><description>After I deployed my blog to Amazon S3, I realized that there was no CSS applied to the pages. In Octopress, the look and feel of website is managed by stylesheets/screen.css. It was fine in rake preview but not on the S3 bucket. I looked around for a few hours to no avail. There was one other person who had the same issue on [stackoverflow] stackoverflowlink but no answers. Relevant [xkcd] xkcdlink:</description></item><item><title>Now hosted on Amazon S3</title><link>https://parsiya.net/blog/2014-04-20-now-hosted-on-amazon-s3/</link><pubDate>Sun, 20 Apr 2014 13:20:24 +0000</pubDate><guid>https://parsiya.net/blog/2014-04-20-now-hosted-on-amazon-s3/</guid><description>I moved my blog from Bluehost to Amazon S3. I have not used Cloudfront yet, I doubt my blog has any visitors to justify that.
It was really easy to redirect everything to cryptogangsta.com. parsiya.net, www.parsiya.net and www.cryptogangsta.com should all point to cryptogangsta.com.
I have decided (for n-th time) to start updating this blog. Hopefully I will do it this time, I have some ideas to keep this blog running ;).</description></item><item><title>How do I TLS Ciphersuite?</title><link>https://parsiya.net/blog/2013-11-17-how-do-i-tls-ciphersuite/</link><pubDate>Sun, 17 Nov 2013 00:00:00 +0000</pubDate><guid>https://parsiya.net/blog/2013-11-17-how-do-i-tls-ciphersuite/</guid><description>&lt;p>Should we use RC4 or AES-CBC ?
This is a legitimate question. Many have heard of the highly publicized attacks against AES-CBC (CRIME, BEAST etc) and lean towards RC4.
If asked (granted no one asks me), my answer would be: If you can control web servers (not feasible in all situations) and users' browsers
(almost impossible), upgrade to TLS 1.2 and go with AES-GCM. However, not many browsers supported these and to be honest, more users trumps loss
of security in many cases.&lt;/p></description></item><item><title>Microsoft Bluehat Challenges</title><link>https://parsiya.net/blog/2013-09-29-microsoft-bluehat-challenges/</link><pubDate>Sun, 29 Sep 2013 00:00:00 +0000</pubDate><guid>https://parsiya.net/blog/2013-09-29-microsoft-bluehat-challenges/</guid><description>Microsoft has released their Bluehat challenges. You answer the challenge, send it out and if correct they will send the next level (at least that is what they say).
There are three categories: Reverse Engineering, Web and Vulnerabilities.
The first Reverse Engineering challenge was quite easy. But it was level 1 and I do not expect anti-debugging techniques. Let's see about the next level.
Anyway, Enjoy. Linkie.</description></item><item><title>Snow Crash and Malware</title><link>https://parsiya.net/blog/2013-09-23-snow-crash-and-malware/</link><pubDate>Mon, 23 Sep 2013 00:00:00 +0000</pubDate><guid>https://parsiya.net/blog/2013-09-23-snow-crash-and-malware/</guid><description>So I finished &amp;quot;Snow Crash&amp;quot; and it was quite nice. The concept of linguistic malware was interesting and ahead of its time. I noticed that the term &amp;quot;Virus&amp;quot; was used correctly in the book as the malware was not propagating between people (then it would become a worm). Although I suspect it was due to the fact that most people (read almost everyone) calls any malware a &amp;quot;virus&amp;quot;. Nevertheless, it was a very enjoyable read.</description></item><item><title>Update Inc</title><link>https://parsiya.net/blog/2013-09-20-update-inc/</link><pubDate>Fri, 20 Sep 2013 00:00:00 +0000</pubDate><guid>https://parsiya.net/blog/2013-09-20-update-inc/</guid><description>So, I transferred my domain from my last provider, it has not taken effect yet. Also, I need to start populating the website with relevant stuff. Hang on, I will be back soon !</description></item><item><title>MarkDown and Cookie Clicker</title><link>https://parsiya.net/blog/2013-09-15-markdown-and-cookie-clicker/</link><pubDate>Sun, 15 Sep 2013 00:00:00 +0000</pubDate><guid>https://parsiya.net/blog/2013-09-15-markdown-and-cookie-clicker/</guid><description>Markdown looks like an easy-ish language to start (probably not so easy to master of course). Although compared to writing LaTeX source, it is a breeze. During my last year at JHU I started writing the reports and what not directly into LaTeX, I think using MarkDown for blogging and MS Office at work is going to take away my old skills.
On a side note, I am now up to around 500 million cookies per second (CpS) in Cookie Clicker.</description></item><item><title>Hello Octopress</title><link>https://parsiya.net/blog/2013-09-14-hello-octopress/</link><pubDate>Sat, 14 Sep 2013 00:00:00 +0000</pubDate><guid>https://parsiya.net/blog/2013-09-14-hello-octopress/</guid><description>** Octopress is here **
To be honest setting it up took a while (I had this feeling that I should set it up on my host but well let's say I am a n00b and am allowed to make mistakes) :D
Now I have to learn markdown which is probably a good thing, unless I can write blog posts in different formats. Note to self: search to see if we can write blogs in LaTeX.</description></item><item><title>Who is this guy?</title><link>https://parsiya.net/about/</link><pubDate>Tue, 01 Jan 2013 21:40:56 -0500</pubDate><guid>https://parsiya.net/about/</guid><description>I am Parsia, a Senior Security Engineer at Electronic Arts. I work on every product (mostly videogames) and services that we release. Realistic video of me hacking videogames at work.
2013-2019: Senior Security Consultant at Synopsys Software Integrity Group via the 2016 Cigital acquisition.
Major Presentations
DEF CON 26 Main Track: Tineola Taking a Bite Out of Enterprise Blockchain https://www.youtube.com/watch?v=xKYIde5jh_8 I guess I should add DEF CON Speaker to my LinkedIn title (lol).</description></item><item><title>All Posts</title><link>https://parsiya.net/archive/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://parsiya.net/archive/</guid><description/></item><item><title>License</title><link>https://parsiya.net/license/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://parsiya.net/license/</guid><description>I want people to be able to use anything if they want to with attribution and without warranty. I think these licenses are appropriate. Please let me know if there are better licenses that achieve this goal.
Content License Except where otherwise noted, my non-code content on this website is licensed under a Creative Commons BY-NC 4.0 (Creative Commons Attribution-Non Commercial 4.0).
Code License Except where otherwise noted, my code on this website is licensed under MIT:</description></item></channel></rss>