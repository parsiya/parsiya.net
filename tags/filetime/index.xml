<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>Filetime on Hackerman's Hacking Tutorials</title><link>https://parsiya.net/tags/filetime/</link><description>Recent content in Filetime on Hackerman's Hacking Tutorials</description><generator>Hugo</generator><language>en-us</language><lastBuildDate>Thu, 01 Nov 2018 08:05:47 -0400</lastBuildDate><atom:link href="https://parsiya.net/tags/filetime/index.xml" rel="self" type="application/rss+xml"/><item><title>Windows Filetime Timestamps and Byte Wrangling with Go</title><link>https://parsiya.net/blog/2018-11-01-windows-filetime-timestamps-and-byte-wrangling-with-go/</link><pubDate>Thu, 01 Nov 2018 08:05:47 -0400</pubDate><guid>https://parsiya.net/blog/2018-11-01-windows-filetime-timestamps-and-byte-wrangling-with-go/</guid><description>&lt;p&gt;For a side project, I have to parse timestamps in a file. These timestamps are in the Windows Filetime format. This post documents what I have learned about them and how they can be converted to a Golang &lt;a href="https://golang.org/pkg/time/#Time" target="_blank" rel="noreferrer noopener"&gt;time.Time&lt;/a&gt; and then converted to any desirable format after that.&lt;/p&gt;
&lt;p&gt;We will start by looking at endian-ness and use a real-world example to practice our newly acquired knowledge.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;TL;DR: To convert a Windows Filetime to Go's time.Time:&lt;/strong&gt;&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;Read 8 bytes in LittleEndian from the file.&lt;/li&gt;
&lt;li&gt;Create a &lt;code&gt;syscall.Filetime&lt;/code&gt;.
&lt;ul&gt;
&lt;li&gt;Assign the first 4 bytes to &lt;code&gt;LowDateTime&lt;/code&gt; field and the other four to &lt;code&gt;HighDateTime&lt;/code&gt;.&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;Convert the resulting Filetime to nanoseconds with &lt;a href="https://godoc.org/golang.org/x/sys/windows#Filetime.Nanoseconds" target="_blank" rel="noreferrer noopener"&gt;Filetime.Nanoseconds()&lt;/a&gt;.&lt;/li&gt;
&lt;li&gt;Convert the resulting value to &lt;a href="https://golang.org/pkg/time/#Time" target="_blank" rel="noreferrer noopener"&gt;time.Time&lt;/a&gt;.&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;The code is at:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="https://github.com/parsiya/Parsia-Code/tree/master/filetime-bytewrangling" target="_blank" rel="noreferrer noopener"&gt;https://github.com/parsiya/Parsia-Code/tree/master/filetime-bytewrangling&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;</description></item></channel></rss>